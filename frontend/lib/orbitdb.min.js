/*! For license information please see orbitdb.min.js.LICENSE.txt */
var OrbitDB;(()=>{var t={464:(t,e,r)=>{"use strict";const{fromCallback:n}=r(957),i=r(473),{getCallback:o,getOptions:s}=r(520),a=Symbol("promise"),c=Symbol("status"),u=Symbol("operations"),h=Symbol("finishClose"),f=Symbol("closeCallbacks");e.AbstractChainedBatch=class{constructor(t){if("object"!=typeof t||null===t)throw new TypeError("The first argument must be an abstract-level database, received "+(null===t?"null":typeof t));this[u]=[],this[f]=[],this[c]="open",this[h]=this[h].bind(this),this.db=t,this.db.attachResource(this),this.nextTick=t.nextTick}get length(){return this[u].length}put(t,e,r){if("open"!==this[c])throw new i("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const n=this.db._checkKey(t)||this.db._checkValue(e);if(n)throw n;const o=r&&null!=r.sublevel?r.sublevel:this.db,s=r,a=o.keyEncoding(r&&r.keyEncoding),h=o.valueEncoding(r&&r.valueEncoding),f=a.format;r={...r,keyEncoding:f,valueEncoding:h.format},o!==this.db&&(r.sublevel=null);const l=o.prefixKey(a.encode(t),f),d=h.encode(e);return this._put(l,d,r),this[u].push({...s,type:"put",key:t,value:e}),this}_put(t,e,r){}del(t,e){if("open"!==this[c])throw new i("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const r=this.db._checkKey(t);if(r)throw r;const n=e&&null!=e.sublevel?e.sublevel:this.db,o=e,s=n.keyEncoding(e&&e.keyEncoding),a=s.format;return e={...e,keyEncoding:a},n!==this.db&&(e.sublevel=null),this._del(n.prefixKey(s.encode(t),a),e),this[u].push({...o,type:"del",key:t}),this}_del(t,e){}clear(){if("open"!==this[c])throw new i("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[u]=[],this}_clear(){}write(t,e){return e=o(t,e),e=n(e,a),t=s(t),"open"!==this[c]?this.nextTick(e,new i("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):0===this.length?this.close(e):(this[c]="writing",this._write(t,(t=>{this[c]="closing",this[f].push((()=>e(t))),t||this.db.emit("batch",this[u]),this._close(this[h])}))),e[a]}_write(t,e){}close(t){return t=n(t,a),"closing"===this[c]?this[f].push(t):"closed"===this[c]?this.nextTick(t):(this[f].push(t),"writing"!==this[c]&&(this[c]="closing",this._close(this[h]))),t[a]}_close(t){this.nextTick(t)}[h](){this[c]="closed",this.db.detachResource(this);const t=this[f];this[f]=[];for(const e of t)e()}}},961:(t,e,r)=>{"use strict";const{fromCallback:n}=r(957),i=r(473),{getOptions:o,getCallback:s}=r(520),a=Symbol("promise"),c=Symbol("callback"),u=Symbol("working"),h=Symbol("handleOne"),f=Symbol("handleMany"),l=Symbol("autoClose"),d=Symbol("finishWork"),y=Symbol("returnMany"),p=Symbol("closing"),w=Symbol("handleClose"),g=Symbol("closed"),b=Symbol("closeCallbacks"),m=Symbol("keyEncoding"),v=Symbol("valueEncoding"),E=Symbol("abortOnClose"),x=Symbol("legacy"),A=Symbol("keys"),S=Symbol("values"),I=Symbol("limit"),k=Symbol("count"),B=Object.freeze({}),T=()=>{};let _=!1;class C{constructor(t,e,r){if("object"!=typeof t||null===t)throw new TypeError("The first argument must be an abstract-level database, received "+(null===t?"null":typeof t));if("object"!=typeof e||null===e)throw new TypeError("The second argument must be an options object");this[g]=!1,this[b]=[],this[u]=!1,this[p]=!1,this[l]=!1,this[c]=null,this[h]=this[h].bind(this),this[f]=this[f].bind(this),this[w]=this[w].bind(this),this[m]=e[m],this[v]=e[v],this[x]=r,this[I]=Number.isInteger(e.limit)&&e.limit>=0?e.limit:1/0,this[k]=0,this[E]=!!e.abortOnClose,this.db=t,this.db.attachResource(this),this.nextTick=t.nextTick}get count(){return this[k]}get limit(){return this[I]}next(t){let e;if(void 0===t)e=new Promise(((e,r)=>{t=(t,n,i)=>{t?r(t):this[x]?void 0===n&&void 0===i?e():e([n,i]):e(n)}}));else if("function"!=typeof t)throw new TypeError("Callback must be a function");return this[p]?this.nextTick(t,new i("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[u]?this.nextTick(t,new i("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[u]=!0,this[c]=t,this[k]>=this[I]?this.nextTick(this[h],null):this._next(this[h])),e}_next(t){this.nextTick(t)}nextv(t,e,r){return r=s(e,r),r=n(r,a),e=o(e,B),Number.isInteger(t)?(this[p]?this.nextTick(r,new i("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[u]?this.nextTick(r,new i("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(t<1&&(t=1),this[I]<1/0&&(t=Math.min(t,this[I]-this[k])),this[u]=!0,this[c]=r,t<=0?this.nextTick(this[f],null,[]):this._nextv(t,e,this[f])),r[a]):(this.nextTick(r,new TypeError("The first argument 'size' must be an integer")),r[a])}_nextv(t,e,r){const n=[],i=(e,o,s)=>e?r(e):(this[x]?void 0===o&&void 0===s:void 0===o)?r(null,n):(n.push(this[x]?[o,s]:o),void(n.length===t?r(null,n):this._next(i)));this._next(i)}all(t,e){return e=s(t,e),e=n(e,a),t=o(t,B),this[p]?this.nextTick(e,new i("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[u]?this.nextTick(e,new i("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[u]=!0,this[c]=e,this[l]=!0,this[k]>=this[I]?this.nextTick(this[f],null,[]):this._all(t,this[f])),e[a]}_all(t,e){let r=this[k];const n=[],i=()=>{const t=this[I]<1/0?Math.min(1e3,this[I]-r):1e3;t<=0?this.nextTick(e,null,n):this._nextv(t,B,o)},o=(t,o)=>{t?e(t):0===o.length?e(null,n):(n.push.apply(n,o),r+=o.length,i())};i()}[d](){const t=this[c];return this[E]&&null===t?T:(this[u]=!1,this[c]=null,this[p]&&this._close(this[w]),t)}[y](t,e,r){this[l]?this.close(t.bind(null,e,r)):t(e,r)}seek(t,e){if(e=o(e,B),this[p]);else{if(this[u])throw new i("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const r=this.db.keyEncoding(e.keyEncoding||this[m]),n=r.format;e.keyEncoding!==n&&(e={...e,keyEncoding:n});const i=this.db.prefixKey(r.encode(t),n);this._seek(i,e)}}}_seek(t,e){throw new i("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(t){return t=n(t,a),this[g]?this.nextTick(t):this[p]?this[b].push(t):(this[p]=!0,this[b].push(t),this[u]?this[E]&&this[d]()(new i("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this._close(this[w])),t[a]}_close(t){this.nextTick(t)}[w](){this[g]=!0,this.db.detachResource(this);const t=this[b];this[b]=[];for(const e of t)e()}async*[Symbol.asyncIterator](){try{let t;for(;void 0!==(t=await this.next());)yield t}finally{this[g]||await this.close()}}}class L extends C{constructor(t,e){super(t,e,!0),this[A]=!1!==e.keys,this[S]=!1!==e.values}[h](t,e,r){const n=this[d]();if(t)return n(t);try{e=this[A]&&void 0!==e?this[m].decode(e):void 0,r=this[S]&&void 0!==r?this[v].decode(r):void 0}catch(t){return n(new U("entry",t))}void 0===e&&void 0===r||this[k]++,n(null,e,r)}[f](t,e){const r=this[d]();if(t)return this[y](r,t);try{for(const t of e){const e=t[0],r=t[1];t[0]=this[A]&&void 0!==e?this[m].decode(e):void 0,t[1]=this[S]&&void 0!==r?this[v].decode(r):void 0}}catch(t){return this[y](r,new U("entries",t))}this[k]+=e.length,this[y](r,null,e)}end(t){return _||"undefined"==typeof console||(_=!0,console.warn(new i("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(t)}}class U extends i{constructor(t,e){super(`Iterator could not decode ${t}`,{code:"LEVEL_DECODE_ERROR",cause:e})}}for(const t of["_ended property","_nexting property","_end method"])Object.defineProperty(L.prototype,t.split(" ")[0],{get(){throw new i(`The ${t} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new i(`The ${t} has been removed`,{code:"LEVEL_LEGACY"})}});L.keyEncoding=m,L.valueEncoding=v,e.AbstractIterator=L,e.AbstractKeyIterator=class extends C{constructor(t,e){super(t,e,!1)}[h](t,e){const r=this[d]();if(t)return r(t);try{e=void 0!==e?this[m].decode(e):void 0}catch(t){return r(new U("key",t))}void 0!==e&&this[k]++,r(null,e)}[f](t,e){const r=this[d]();if(t)return this[y](r,t);try{for(let t=0;t<e.length;t++){const r=e[t];e[t]=void 0!==r?this[m].decode(r):void 0}}catch(t){return this[y](r,new U("keys",t))}this[k]+=e.length,this[y](r,null,e)}},e.AbstractValueIterator=class extends C{constructor(t,e){super(t,e,!1)}[h](t,e){const r=this[d]();if(t)return r(t);try{e=void 0!==e?this[v].decode(e):void 0}catch(t){return r(new U("value",t))}void 0!==e&&this[k]++,r(null,e)}[f](t,e){const r=this[d]();if(t)return this[y](r,t);try{for(let t=0;t<e.length;t++){const r=e[t];e[t]=void 0!==r?this[v].decode(r):void 0}}catch(t){return this[y](r,new U("values",t))}this[k]+=e.length,this[y](r,null,e)}}},71:(t,e,r)=>{"use strict";const{supports:n}=r(675),{Transcoder:i}=r(499),{EventEmitter:o}=r(187),{fromCallback:s}=r(957),a=r(473),{AbstractIterator:c}=r(961),{DefaultKeyIterator:u,DefaultValueIterator:h}=r(429),{DeferredIterator:f,DeferredKeyIterator:l,DeferredValueIterator:d}=r(593),{DefaultChainedBatch:y}=r(765),{getCallback:p,getOptions:w}=r(520),g=r(56),b=Symbol("promise"),m=Symbol("landed"),v=Symbol("resources"),E=Symbol("closeResources"),x=Symbol("operations"),A=Symbol("undefer"),S=Symbol("deferOpen"),I=Symbol("options"),k=Symbol("status"),B=Symbol("defaultOptions"),T=Symbol("transcoder"),_=Symbol("keyEncoding"),C=Symbol("valueEncoding"),L=()=>{};class U extends o{constructor(t,e){if(super(),"object"!=typeof t||null===t)throw new TypeError("The first argument 'manifest' must be an object");e=w(e);const{keyEncoding:r,valueEncoding:o,passive:s,...a}=e;this[v]=new Set,this[x]=[],this[S]=!0,this[I]=a,this[k]="opening",this.supports=n(t,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:!1!==t.snapshots,permanence:!1!==t.permanence,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:t.encodings||{},events:Object.assign({},t.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[T]=new i(P(this)),this[_]=this[T].encoding(r||"utf8"),this[C]=this[T].encoding(o||"utf8");for(const t of this[T].encodings())this.supports.encodings[t.commonName]||(this.supports.encodings[t.commonName]=!0);this[B]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[_].commonName,valueEncoding:this[C].commonName}),key:Object.freeze({keyEncoding:this[_].commonName})},this.nextTick((()=>{this[S]&&this.open({passive:!1},L)}))}get status(){return this[k]}keyEncoding(t){return this[T].encoding(null!=t?t:this[_])}valueEncoding(t){return this[T].encoding(null!=t?t:this[C])}open(t,e){e=p(t,e),e=s(e,b),(t={...this[I],...w(t)}).createIfMissing=!1!==t.createIfMissing,t.errorIfExists=!!t.errorIfExists;const r=t=>{"closing"===this[k]||"opening"===this[k]?this.once(m,t?()=>r(t):r):"open"!==this[k]?e(new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:t})):e()};return t.passive?"opening"===this[k]?this.once(m,r):this.nextTick(r):"closed"===this[k]||this[S]?(this[S]=!1,this[k]="opening",this.emit("opening"),this._open(t,(t=>{if(t)return this[k]="closed",this[E]((()=>{this.emit(m),r(t)})),void this[A]();this[k]="open",this[A](),this.emit(m),"open"===this[k]&&this.emit("open"),"open"===this[k]&&this.emit("ready"),r()}))):"open"===this[k]?this.nextTick(r):this.once(m,(()=>this.open(t,e))),e[b]}_open(t,e){this.nextTick(e)}close(t){t=s(t,b);const e=r=>{"opening"===this[k]||"closing"===this[k]?this.once(m,r?e(r):e):"closed"!==this[k]?t(new a("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:r})):t()};if("open"===this[k]){this[k]="closing",this.emit("closing");const t=t=>{this[k]="open",this[A](),this.emit(m),e(t)};this[E]((()=>{this._close((r=>{if(r)return t(r);this[k]="closed",this[A](),this.emit(m),"closed"===this[k]&&this.emit("closed"),e()}))}))}else"closed"===this[k]?this.nextTick(e):this.once(m,(()=>this.close(t)));return t[b]}[E](t){if(0===this[v].size)return this.nextTick(t);let e=this[v].size,r=!0;const n=()=>{0==--e&&(r?this.nextTick(t):t())};for(const t of this[v])t.close(n);r=!1,this[v].clear()}_close(t){this.nextTick(t)}get(t,e,r){if(r=p(e,r),r=s(r,b),e=w(e,this[B].entry),"opening"===this[k])return this.defer((()=>this.get(t,e,r))),r[b];if(N(this,r))return r[b];const n=this._checkKey(t);if(n)return this.nextTick(r,n),r[b];const i=this.keyEncoding(e.keyEncoding),o=this.valueEncoding(e.valueEncoding),c=i.format,u=o.format;return e.keyEncoding===c&&e.valueEncoding===u||(e=Object.assign({},e,{keyEncoding:c,valueEncoding:u})),this._get(this.prefixKey(i.encode(t),c),e,((t,e)=>{if(t)return("LEVEL_NOT_FOUND"===t.code||t.notFound||/NotFound/i.test(t))&&(t.code||(t.code="LEVEL_NOT_FOUND"),t.notFound||(t.notFound=!0),t.status||(t.status=404)),r(t);try{e=o.decode(e)}catch(t){return r(new a("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:t}))}r(null,e)})),r[b]}_get(t,e,r){this.nextTick(r,new Error("NotFound"))}getMany(t,e,r){if(r=p(e,r),r=s(r,b),e=w(e,this[B].entry),"opening"===this[k])return this.defer((()=>this.getMany(t,e,r))),r[b];if(N(this,r))return r[b];if(!Array.isArray(t))return this.nextTick(r,new TypeError("The first argument 'keys' must be an array")),r[b];if(0===t.length)return this.nextTick(r,null,[]),r[b];const n=this.keyEncoding(e.keyEncoding),i=this.valueEncoding(e.valueEncoding),o=n.format,c=i.format;e.keyEncoding===o&&e.valueEncoding===c||(e=Object.assign({},e,{keyEncoding:o,valueEncoding:c}));const u=new Array(t.length);for(let e=0;e<t.length;e++){const i=t[e],s=this._checkKey(i);if(s)return this.nextTick(r,s),r[b];u[e]=this.prefixKey(n.encode(i),o)}return this._getMany(u,e,((t,e)=>{if(t)return r(t);try{for(let t=0;t<e.length;t++)void 0!==e[t]&&(e[t]=i.decode(e[t]))}catch(t){return r(new a(`Could not decode one or more of ${e.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:t}))}r(null,e)})),r[b]}_getMany(t,e,r){this.nextTick(r,null,new Array(t.length).fill(void 0))}put(t,e,r,n){if(n=p(r,n),n=s(n,b),r=w(r,this[B].entry),"opening"===this[k])return this.defer((()=>this.put(t,e,r,n))),n[b];if(N(this,n))return n[b];const i=this._checkKey(t)||this._checkValue(e);if(i)return this.nextTick(n,i),n[b];const o=this.keyEncoding(r.keyEncoding),a=this.valueEncoding(r.valueEncoding),c=o.format,u=a.format;r.keyEncoding===c&&r.valueEncoding===u||(r=Object.assign({},r,{keyEncoding:c,valueEncoding:u}));const h=this.prefixKey(o.encode(t),c),f=a.encode(e);return this._put(h,f,r,(r=>{if(r)return n(r);this.emit("put",t,e),n()})),n[b]}_put(t,e,r,n){this.nextTick(n)}del(t,e,r){if(r=p(e,r),r=s(r,b),e=w(e,this[B].key),"opening"===this[k])return this.defer((()=>this.del(t,e,r))),r[b];if(N(this,r))return r[b];const n=this._checkKey(t);if(n)return this.nextTick(r,n),r[b];const i=this.keyEncoding(e.keyEncoding),o=i.format;return e.keyEncoding!==o&&(e=Object.assign({},e,{keyEncoding:o})),this._del(this.prefixKey(i.encode(t),o),e,(e=>{if(e)return r(e);this.emit("del",t),r()})),r[b]}_del(t,e,r){this.nextTick(r)}batch(t,e,r){if(!arguments.length){if("opening"===this[k])return new y(this);if("open"!==this[k])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(r="function"==typeof t?t:p(e,r),r=s(r,b),e=w(e,this[B].empty),"opening"===this[k])return this.defer((()=>this.batch(t,e,r))),r[b];if(N(this,r))return r[b];if(!Array.isArray(t))return this.nextTick(r,new TypeError("The first argument 'operations' must be an array")),r[b];if(0===t.length)return this.nextTick(r),r[b];const n=new Array(t.length),{keyEncoding:i,valueEncoding:o,...c}=e;for(let e=0;e<t.length;e++){if("object"!=typeof t[e]||null===t[e])return this.nextTick(r,new TypeError("A batch operation must be an object")),r[b];const s=Object.assign({},t[e]);if("put"!==s.type&&"del"!==s.type)return this.nextTick(r,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),r[b];const a=this._checkKey(s.key);if(a)return this.nextTick(r,a),r[b];const c=null!=s.sublevel?s.sublevel:this,u=c.keyEncoding(s.keyEncoding||i),h=u.format;if(s.key=c.prefixKey(u.encode(s.key),h),s.keyEncoding=h,"put"===s.type){const t=this._checkValue(s.value);if(t)return this.nextTick(r,t),r[b];const e=c.valueEncoding(s.valueEncoding||o);s.value=e.encode(s.value),s.valueEncoding=e.format}c!==this&&(s.sublevel=null),n[e]=s}return this._batch(n,c,(e=>{if(e)return r(e);this.emit("batch",t),r()})),r[b]}_batch(t,e,r){this.nextTick(r)}sublevel(t,e){return this._sublevel(t,O.defaults(e))}_sublevel(t,e){return new O(this,t,e)}prefixKey(t,e){return t}clear(t,e){if(e=p(t,e),e=s(e,b),t=w(t,this[B].empty),"opening"===this[k])return this.defer((()=>this.clear(t,e))),e[b];if(N(this,e))return e[b];const r=t,n=this.keyEncoding(t.keyEncoding);return(t=g(t,n)).keyEncoding=n.format,0===t.limit?this.nextTick(e):this._clear(t,(t=>{if(t)return e(t);this.emit("clear",r),e()})),e[b]}_clear(t,e){this.nextTick(e)}iterator(t){const e=this.keyEncoding(t&&t.keyEncoding),r=this.valueEncoding(t&&t.valueEncoding);if((t=g(t,e)).keys=!1!==t.keys,t.values=!1!==t.values,t[c.keyEncoding]=e,t[c.valueEncoding]=r,t.keyEncoding=e.format,t.valueEncoding=r.format,"opening"===this[k])return new f(this,t);if("open"!==this[k])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(t)}_iterator(t){return new c(this,t)}keys(t){const e=this.keyEncoding(t&&t.keyEncoding),r=this.valueEncoding(t&&t.valueEncoding);if((t=g(t,e))[c.keyEncoding]=e,t[c.valueEncoding]=r,t.keyEncoding=e.format,t.valueEncoding=r.format,"opening"===this[k])return new l(this,t);if("open"!==this[k])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(t)}_keys(t){return new u(this,t)}values(t){const e=this.keyEncoding(t&&t.keyEncoding),r=this.valueEncoding(t&&t.valueEncoding);if((t=g(t,e))[c.keyEncoding]=e,t[c.valueEncoding]=r,t.keyEncoding=e.format,t.valueEncoding=r.format,"opening"===this[k])return new d(this,t);if("open"!==this[k])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(t)}_values(t){return new h(this,t)}defer(t){if("function"!=typeof t)throw new TypeError("The first argument must be a function");this[x].push(t)}[A](){if(0===this[x].length)return;const t=this[x];this[x]=[];for(const e of t)e()}attachResource(t){if("object"!=typeof t||null===t||"function"!=typeof t.close)throw new TypeError("The first argument must be a resource object");this[v].add(t)}detachResource(t){this[v].delete(t)}_chainedBatch(){return new y(this)}_checkKey(t){if(null==t)return new a("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(t){if(null==t)return new a("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}}U.prototype.nextTick=r(909);const{AbstractSublevel:O}=r(650)({AbstractLevel:U});e.AbstractLevel=U,e.AbstractSublevel=O;const N=function(t,e){return"open"!==t[k]&&(t.nextTick(e,new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0)},P=function(t){return Object.keys(t.supports.encodings).filter((e=>!!t.supports.encodings[e]))}},875:(t,e,r)=>{"use strict";e.AbstractLevel=r(71).AbstractLevel,e.AbstractSublevel=r(71).AbstractSublevel,e.AbstractIterator=r(961).AbstractIterator,e.AbstractKeyIterator=r(961).AbstractKeyIterator,e.AbstractValueIterator=r(961).AbstractValueIterator,e.AbstractChainedBatch=r(464).AbstractChainedBatch},970:(t,e,r)=>{"use strict";const{AbstractIterator:n,AbstractKeyIterator:i,AbstractValueIterator:o}=r(961),s=Symbol("unfix"),a=Symbol("iterator"),c=Symbol("handleOne"),u=Symbol("handleMany"),h=Symbol("callback");class f extends n{constructor(t,e,r,n){super(t,e),this[a]=r,this[s]=n,this[c]=this[c].bind(this),this[u]=this[u].bind(this),this[h]=null}[c](t,e,r){const n=this[h];if(t)return n(t);void 0!==e&&(e=this[s](e)),n(t,e,r)}[u](t,e){const r=this[h];if(t)return r(t);for(const t of e){const e=t[0];void 0!==e&&(t[0]=this[s](e))}r(t,e)}}class l extends i{constructor(t,e,r,n){super(t,e),this[a]=r,this[s]=n,this[c]=this[c].bind(this),this[u]=this[u].bind(this),this[h]=null}[c](t,e){const r=this[h];if(t)return r(t);void 0!==e&&(e=this[s](e)),r(t,e)}[u](t,e){const r=this[h];if(t)return r(t);for(let t=0;t<e.length;t++){const r=e[t];void 0!==r&&(e[t]=this[s](r))}r(t,e)}}class d extends o{constructor(t,e,r){super(t,e),this[a]=r}}for(const t of[f,l])t.prototype._next=function(t){this[h]=t,this[a].next(this[c])},t.prototype._nextv=function(t,e,r){this[h]=r,this[a].nextv(t,e,this[u])},t.prototype._all=function(t,e){this[h]=e,this[a].all(t,this[u])};for(const t of[d])t.prototype._next=function(t){this[a].next(t)},t.prototype._nextv=function(t,e,r){this[a].nextv(t,e,r)},t.prototype._all=function(t,e){this[a].all(t,e)};for(const t of[f,l,d])t.prototype._seek=function(t,e){this[a].seek(t,e)},t.prototype._close=function(t){this[a].close(t)};e.AbstractSublevelIterator=f,e.AbstractSublevelKeyIterator=l,e.AbstractSublevelValueIterator=d},650:(t,e,r)=>{"use strict";const n=r(473),{Buffer:i}=r(764)||{},{AbstractSublevelIterator:o,AbstractSublevelKeyIterator:s,AbstractSublevelValueIterator:a}=r(970),c=Symbol("prefix"),u=Symbol("upperBound"),h=Symbol("prefixRange"),f=Symbol("parent"),l=Symbol("unfix"),d=new TextEncoder,y={separator:"!"};t.exports=function({AbstractLevel:t}){class e extends t{static defaults(t){if("string"==typeof t)throw new n("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(t&&t.open)throw new n("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return null==t?y:t.separator?t:{...t,separator:"!"}}constructor(t,r,i){const{separator:o,manifest:s,...a}=e.defaults(i);r=m(r,o);const h=o.charCodeAt(0)+1,y=t[f]||t;if(!d.encode(r).every((t=>t>h&&t<127)))throw new n(`Prefix must use bytes > ${h} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(p(y,s),a);const w=(t.prefix||"")+o+r+o,v=w.slice(0,-1)+String.fromCharCode(h);this[f]=y,this[c]=new g(w),this[u]=new g(v),this[l]=new b,this.nextTick=y.nextTick}prefixKey(t,e){if("utf8"===e)return this[c].utf8+t;if(0===t.byteLength)return this[c][e];if("view"===e){const e=this[c].view,r=new Uint8Array(e.byteLength+t.byteLength);return r.set(e,0),r.set(t,e.byteLength),r}{const e=this[c].buffer;return i.concat([e,t],e.byteLength+t.byteLength)}}[h](t,e){void 0!==t.gte?t.gte=this.prefixKey(t.gte,e):void 0!==t.gt?t.gt=this.prefixKey(t.gt,e):t.gte=this[c][e],void 0!==t.lte?t.lte=this.prefixKey(t.lte,e):void 0!==t.lt?t.lt=this.prefixKey(t.lt,e):t.lte=this[u][e]}get prefix(){return this[c].utf8}get db(){return this[f]}_open(t,e){this[f].open({passive:!0},e)}_put(t,e,r,n){this[f].put(t,e,r,n)}_get(t,e,r){this[f].get(t,e,r)}_getMany(t,e,r){this[f].getMany(t,e,r)}_del(t,e,r){this[f].del(t,e,r)}_batch(t,e,r){this[f].batch(t,e,r)}_clear(t,e){this[h](t,t.keyEncoding),this[f].clear(t,e)}_iterator(t){this[h](t,t.keyEncoding);const e=this[f].iterator(t),r=this[l].get(this[c].utf8.length,t.keyEncoding);return new o(this,t,e,r)}_keys(t){this[h](t,t.keyEncoding);const e=this[f].keys(t),r=this[l].get(this[c].utf8.length,t.keyEncoding);return new s(this,t,e,r)}_values(t){this[h](t,t.keyEncoding);const e=this[f].values(t);return new a(this,t,e)}}return{AbstractSublevel:e}};const p=function(t,e){return{...t.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...e,encodings:{utf8:w(t,"utf8"),buffer:w(t,"buffer"),view:w(t,"view")}}},w=function(t,e){return!!t.supports.encodings[e]&&t.keyEncoding(e).name===e};class g{constructor(t){this.utf8=t,this.view=d.encode(t),this.buffer=i?i.from(this.view.buffer,0,this.view.byteLength):{}}}class b{constructor(){this.cache=new Map}get(t,e){let r=this.cache.get(e);return void 0===r&&(r="view"===e?function(t,e){return e.subarray(t)}.bind(null,t):function(t,e){return e.slice(t)}.bind(null,t),this.cache.set(e,r)),r}}const m=function(t,e){let r=0,n=t.length;for(;r<n&&t[r]===e;)r++;for(;n>r&&t[n-1]===e;)n--;return t.slice(r,n)}},520:(t,e)=>{"use strict";e.getCallback=function(t,e){return"function"==typeof t?t:e},e.getOptions=function(t,e){return"object"==typeof t&&null!==t?t:void 0!==e?e:{}}},765:(t,e,r)=>{"use strict";const{AbstractChainedBatch:n}=r(464),i=r(473),o=Symbol("encoded");e.DefaultChainedBatch=class extends n{constructor(t){super(t),this[o]=[]}_put(t,e,r){this[o].push({...r,type:"put",key:t,value:e})}_del(t,e){this[o].push({...e,type:"del",key:t})}_clear(){this[o]=[]}_write(t,e){"opening"===this.db.status?this.db.defer((()=>this._write(t,e))):"open"===this.db.status?0===this[o].length?this.nextTick(e):this.db._batch(this[o],t,e):this.nextTick(e,new i("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}}},429:(t,e,r)=>{"use strict";const{AbstractKeyIterator:n,AbstractValueIterator:i}=r(961),o=Symbol("iterator"),s=Symbol("callback"),a=Symbol("handleOne"),c=Symbol("handleMany");class u extends n{constructor(t,e){super(t,e),this[o]=t.iterator({...e,keys:!0,values:!1}),this[a]=this[a].bind(this),this[c]=this[c].bind(this)}}class h extends i{constructor(t,e){super(t,e),this[o]=t.iterator({...e,keys:!1,values:!0}),this[a]=this[a].bind(this),this[c]=this[c].bind(this)}}for(const t of[u,h]){const e=t===u,r=e?t=>t[0]:t=>t[1];t.prototype._next=function(t){this[s]=t,this[o].next(this[a])},t.prototype[a]=function(t,r,n){const i=this[s];t?i(t):i(null,e?r:n)},t.prototype._nextv=function(t,e,r){this[s]=r,this[o].nextv(t,e,this[c])},t.prototype._all=function(t,e){this[s]=e,this[o].all(t,this[c])},t.prototype[c]=function(t,e){const n=this[s];t?n(t):n(null,e.map(r))},t.prototype._seek=function(t,e){this[o].seek(t,e)},t.prototype._close=function(t){this[o].close(t)}}e.DefaultKeyIterator=u,e.DefaultValueIterator=h},593:(t,e,r)=>{"use strict";const{AbstractIterator:n,AbstractKeyIterator:i,AbstractValueIterator:o}=r(961),s=r(473),a=Symbol("nut"),c=Symbol("undefer"),u=Symbol("factory");class h extends n{constructor(t,e){super(t,e),this[a]=null,this[u]=()=>t.iterator(e),this.db.defer((()=>this[c]()))}}class f extends i{constructor(t,e){super(t,e),this[a]=null,this[u]=()=>t.keys(e),this.db.defer((()=>this[c]()))}}class l extends o{constructor(t,e){super(t,e),this[a]=null,this[u]=()=>t.values(e),this.db.defer((()=>this[c]()))}}for(const t of[h,f,l])t.prototype[c]=function(){"open"===this.db.status&&(this[a]=this[u]())},t.prototype._next=function(t){null!==this[a]?this[a].next(t):"opening"===this.db.status?this.db.defer((()=>this._next(t))):this.nextTick(t,new s("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._nextv=function(t,e,r){null!==this[a]?this[a].nextv(t,e,r):"opening"===this.db.status?this.db.defer((()=>this._nextv(t,e,r))):this.nextTick(r,new s("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._all=function(t,e){null!==this[a]?this[a].all(e):"opening"===this.db.status?this.db.defer((()=>this._all(t,e))):this.nextTick(e,new s("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._seek=function(t,e){null!==this[a]?this[a]._seek(t,e):"opening"===this.db.status&&this.db.defer((()=>this._seek(t,e)))},t.prototype._close=function(t){null!==this[a]?this[a].close(t):"opening"===this.db.status?this.db.defer((()=>this._close(t))):this.nextTick(t)};e.DeferredIterator=h,e.DeferredKeyIterator=f,e.DeferredValueIterator=l},909:(t,e,r)=>{"use strict";const n=r(375);t.exports=function(t,...e){0===e.length?n(t):n((()=>t(...e)))}},56:(t,e,r)=>{"use strict";const n=r(473),i=Object.prototype.hasOwnProperty,o=new Set(["lt","lte","gt","gte"]);t.exports=function(t,e){const r={};for(const s in t)if(i.call(t,s)&&"keyEncoding"!==s&&"valueEncoding"!==s){if("start"===s||"end"===s)throw new n(`The legacy range option '${s}' has been removed`,{code:"LEVEL_LEGACY"});if("encoding"===s)throw new n("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});o.has(s)?r[s]=e.encode(t[s]):r[s]=t[s]}return r.reverse=!!r.reverse,r.limit=Number.isInteger(r.limit)&&r.limit>=0?r.limit:-1,r}},742:(t,e)=>{"use strict";e.byteLength=function(t){var e=a(t),r=e[0],n=e[1];return 3*(r+n)/4-n},e.toByteArray=function(t){var e,r,o=a(t),s=o[0],c=o[1],u=new i(function(t,e,r){return 3*(e+r)/4-r}(0,s,c)),h=0,f=c>0?s-4:s;for(r=0;r<f;r+=4)e=n[t.charCodeAt(r)]<<18|n[t.charCodeAt(r+1)]<<12|n[t.charCodeAt(r+2)]<<6|n[t.charCodeAt(r+3)],u[h++]=e>>16&255,u[h++]=e>>8&255,u[h++]=255&e;return 2===c&&(e=n[t.charCodeAt(r)]<<2|n[t.charCodeAt(r+1)]>>4,u[h++]=255&e),1===c&&(e=n[t.charCodeAt(r)]<<10|n[t.charCodeAt(r+1)]<<4|n[t.charCodeAt(r+2)]>>2,u[h++]=e>>8&255,u[h++]=255&e),u},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],s=16383,a=0,u=n-i;a<u;a+=s)o.push(c(t,a,a+s>u?u:a+s));return 1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),o.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=o[s],n[o.charCodeAt(s)]=s;function a(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function c(t,e,n){for(var i,o,s=[],a=e;a<n;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},708:(t,e,r)=>{"use strict";const{AbstractLevel:n}=r(875),i=r(473),o=r(967),{fromCallback:s}=r(957),{Iterator:a}=r(212),c=r(687),u=r(968),h=r(217),f="level-js-",l=Symbol("idb"),d=Symbol("namePrefix"),y=Symbol("location"),p=Symbol("version"),w=Symbol("store"),g=Symbol("onComplete"),b=Symbol("promise");class m extends n{constructor(t,e,r){if("function"==typeof e||"function"==typeof r)throw new i("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:n,version:o,...s}=e||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},s),"string"!=typeof t)throw new Error("constructor requires a location string argument");this[y]=t,this[d]=null==n?f:n,this[p]=parseInt(o||1,10),this[l]=null}get location(){return this[y]}get namePrefix(){return this[d]}get version(){return this[p]}get db(){return this[l]}get type(){return"browser-level"}_open(t,e){const r=indexedDB.open(this[d]+this[y],this[p]);r.onerror=function(){e(r.error||new Error("unknown error"))},r.onsuccess=()=>{this[l]=r.result,e()},r.onupgradeneeded=t=>{const e=t.target.result;e.objectStoreNames.contains(this[y])||e.createObjectStore(this[y])}}[w](t){return this[l].transaction([this[y]],t).objectStore(this[y])}[g](t,e){const r=t.transaction;r.onabort=function(){e(r.error||new Error("aborted by user"))},r.oncomplete=function(){e(null,t.result)}}_get(t,e,r){const n=this[w]("readonly");let o;try{o=n.get(t)}catch(t){return this.nextTick(r,t)}this[g](o,(function(t,e){return t?r(t):void 0===e?r(new i("Entry not found",{code:"LEVEL_NOT_FOUND"})):void r(null,c(e))}))}_getMany(t,e,r){const n=this[w]("readonly"),i=t.map((t=>e=>{let r;try{r=n.get(t)}catch(t){return e(t)}r.onsuccess=()=>{const t=r.result;e(null,void 0===t?t:c(t))},r.onerror=t=>{t.stopPropagation(),e(r.error)}}));o(i,16,r)}_del(t,e,r){const n=this[w]("readwrite");let i;try{i=n.delete(t)}catch(t){return this.nextTick(r,t)}this[g](i,r)}_put(t,e,r,n){const i=this[w]("readwrite");let o;try{o=i.put(e,t)}catch(t){return this.nextTick(n,t)}this[g](o,n)}_iterator(t){return new a(this,this[y],t)}_batch(t,e,r){const n=this[w]("readwrite"),i=n.transaction;let o,s=0;i.onabort=function(){r(o||i.error||new Error("aborted by user"))},i.oncomplete=function(){r()},function e(){const r=t[s++],a=r.key;let c;try{c="del"===r.type?n.delete(a):n.put(r.value,a)}catch(t){return o=t,void i.abort()}s<t.length?c.onsuccess=e:"function"==typeof i.commit&&i.commit()}()}_clear(t,e){let r,n;try{r=h(t)}catch(t){return this.nextTick(e)}if(t.limit>=0)return u(this,this[y],r,t,e);try{const t=this[w]("readwrite");n=r?t.delete(r):t.clear()}catch(t){return this.nextTick(e,t)}this[g](n,e)}_close(t){this[l].close(),this.nextTick(t)}}m.destroy=function(t,e,r){"function"==typeof e&&(r=e,e=f),r=s(r,b);const n=indexedDB.deleteDatabase(e+t);return n.onsuccess=function(){r()},n.onerror=function(t){r(t)},r[b]},e.BrowserLevel=m},212:(t,e,r)=>{"use strict";const{AbstractIterator:n}=r(875),i=r(217),o=r(687),s=Symbol("cache"),a=Symbol("finished"),c=Symbol("options"),u=Symbol("currentOptions"),h=Symbol("position"),f=Symbol("location"),l=Symbol("first"),d={};function y(t){"function"==typeof t.commit&&t.commit()}e.Iterator=class extends n{constructor(t,e,r){super(t,r),this[s]=[],this[a]=0===this.limit,this[c]=r,this[u]={...r},this[h]=void 0,this[f]=e,this[l]=!0}_nextv(t,e,r){if(this[l]=!1,this[a])return this.nextTick(r,null,[]);if(this[s].length>0)return t=Math.min(t,this[s].length),this.nextTick(r,null,this[s].splice(0,t));let n;void 0!==this[h]&&(this[c].reverse?(this[u].lt=this[h],this[u].lte=void 0):(this[u].gt=this[h],this[u].gte=void 0));try{n=i(this[u])}catch(t){return this[a]=!0,this.nextTick(r,null,[])}const d=this.db.db.transaction([this[f]],"readonly"),p=d.objectStore(this[f]),w=[];if(this[c].reverse)p[!this[c].values&&p.openKeyCursor?"openKeyCursor":"openCursor"](n,"prev").onsuccess=e=>{const r=e.target.result;if(r){const{key:e,value:n}=r;this[h]=e,w.push([this[c].keys&&void 0!==e?o(e):void 0,this[c].values&&void 0!==n?o(n):void 0]),w.length<t?r.continue():y(d)}else this[a]=!0};else{let e,r;const i=()=>{if(void 0===e||void 0===r)return;const n=Math.max(e.length,r.length);0===n||t===1/0?this[a]=!0:this[h]=e[n-1],w.length=n;for(let t=0;t<n;t++){const n=e[t],i=r[t];w[t]=[this[c].keys&&void 0!==n?o(n):void 0,this[c].values&&void 0!==i?o(i):void 0]}y(d)};this[c].keys||t<1/0?p.getAllKeys(n,t<1/0?t:void 0).onsuccess=t=>{e=t.target.result,i()}:(e=[],this.nextTick(i)),this[c].values?p.getAll(n,t<1/0?t:void 0).onsuccess=t=>{r=t.target.result,i()}:(r=[],this.nextTick(i))}d.onabort=()=>{r(d.error||new Error("aborted by user")),r=null},d.oncomplete=()=>{r(null,w),r=null}}_next(t){if(this[s].length>0){const[e,r]=this[s].shift();this.nextTick(t,null,e,r)}else if(this[a])this.nextTick(t);else{let e=Math.min(100,this.limit-this.count);this[l]&&(this[l]=!1,e=1),this._nextv(e,d,((e,r)=>{if(e)return t(e);this[s]=r,this._next(t)}))}}_all(t,e){this[l]=!1;const r=this[s].splice(0,this[s].length),n=this.limit-this.count-r.length;if(n<=0)return this.nextTick(e,null,r);this._nextv(n,d,((t,n)=>{if(t)return e(t);r.length>0&&(n=r.concat(n)),e(null,n)}))}_seek(t,e){let r;this[l]=!0,this[s]=[],this[a]=!1,this[h]=void 0,this[u]={...this[c]};try{r=i(this[c])}catch(t){return void(this[a]=!0)}null===r||r.includes(t)?this[c].reverse?this[u].lte=t:this[u].gte=t:this[a]=!0}}},968:t=>{"use strict";t.exports=function(t,e,r,n,i){if(0===n.limit)return t.nextTick(i);const o=t.db.transaction([e],"readwrite"),s=o.objectStore(e);let a=0;o.oncomplete=function(){i()},o.onabort=function(){i(o.error||new Error("aborted by user"))};const c=s.openKeyCursor?"openKeyCursor":"openCursor",u=n.reverse?"prev":"next";s[c](r,u).onsuccess=function(t){const e=t.target.result;e&&(s.delete(e.key).onsuccess=function(){(n.limit<=0||++a<n.limit)&&e.continue()})}}},687:t=>{"use strict";const e=new TextEncoder;t.exports=function(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):e.encode(t)}},217:t=>{"use strict";t.exports=function(t){const e=void 0!==t.gte?t.gte:void 0!==t.gt?t.gt:void 0,r=void 0!==t.lte?t.lte:void 0!==t.lt?t.lt:void 0,n=void 0===t.gte,i=void 0===t.lte;return void 0!==e&&void 0!==r?IDBKeyRange.bound(e,r,n,i):void 0!==e?IDBKeyRange.lowerBound(e,n):void 0!==r?IDBKeyRange.upperBound(r,i):null}},764:(t,e,r)=>{"use strict";const n=r(742),i=r(645),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=c,e.SlowBuffer=function(t){return+t!=t&&(t=0),c.alloc(+t)},e.INSPECT_MAX_BYTES=50;const s=2147483647;function a(t){if(t>s)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,c.prototype),e}function c(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return f(t)}return u(t,e,r)}function u(t,e,r){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!c.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const r=0|p(t,e);let n=a(r);const i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(Y(t,Uint8Array)){const e=new Uint8Array(t);return d(e.buffer,e.byteOffset,e.byteLength)}return l(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Y(t,ArrayBuffer)||t&&Y(t.buffer,ArrayBuffer))return d(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(Y(t,SharedArrayBuffer)||t&&Y(t.buffer,SharedArrayBuffer)))return d(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return c.from(n,e,r);const i=function(t){if(c.isBuffer(t)){const e=0|y(t.length),r=a(e);return 0===r.length||t.copy(r,0,0,e),r}return void 0!==t.length?"number"!=typeof t.length||W(t.length)?a(0):l(t):"Buffer"===t.type&&Array.isArray(t.data)?l(t.data):void 0}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return c.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function f(t){return h(t),a(t<0?0:0|y(t))}function l(t){const e=t.length<0?0:0|y(t.length),r=a(e);for(let n=0;n<e;n+=1)r[n]=255&t[n];return r}function d(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,c.prototype),n}function y(t){if(t>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|t}function p(t,e){if(c.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Y(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return H(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(t).length;default:if(i)return n?-1:H(t).length;e=(""+e).toLowerCase(),i=!0}}function w(t,e,r){let n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return C(this,e,r);case"utf8":case"utf-8":return k(this,e,r);case"ascii":return T(this,e,r);case"latin1":case"binary":return _(this,e,r);case"base64":return I(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function g(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function b(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),W(r=+r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=c.from(e,n)),c.isBuffer(e))return 0===e.length?-1:m(t,e,r,n,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):m(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function m(t,e,r,n,i){let o,s=1,a=t.length,c=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,r/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){let n=-1;for(o=r;o<a;o++)if(u(t,o)===u(e,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===c)return n*s}else-1!==n&&(o-=o-n),n=-1}else for(r+c>a&&(r=a-c),o=r;o>=0;o--){let r=!0;for(let n=0;n<c;n++)if(u(t,o+n)!==u(e,n)){r=!1;break}if(r)return o}return-1}function v(t,e,r,n){r=Number(r)||0;const i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;const o=e.length;let s;for(n>o/2&&(n=o/2),s=0;s<n;++s){const n=parseInt(e.substr(2*s,2),16);if(W(n))return s;t[r+s]=n}return s}function E(t,e,r,n){return Z(H(e,t.length-r),t,r,n)}function x(t,e,r,n){return Z(function(t){const e=[];for(let r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function A(t,e,r,n){return Z(G(e),t,r,n)}function S(t,e,r,n){return Z(function(t,e){let r,n,i;const o=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(e,t.length-r),t,r,n)}function I(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function k(t,e,r){r=Math.min(t.length,r);const n=[];let i=e;for(;i<r;){const e=t[i];let o=null,s=e>239?4:e>223?3:e>191?2:1;if(i+s<=r){let r,n,a,c;switch(s){case 1:e<128&&(o=e);break;case 2:r=t[i+1],128==(192&r)&&(c=(31&e)<<6|63&r,c>127&&(o=c));break;case 3:r=t[i+1],n=t[i+2],128==(192&r)&&128==(192&n)&&(c=(15&e)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:r=t[i+1],n=t[i+2],a=t[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=s}return function(t){const e=t.length;if(e<=B)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=B));return r}(n)}e.kMaxLength=s,c.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(t,e,r){return u(t,e,r)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(t,e,r){return function(t,e,r){return h(t),t<=0?a(t):void 0!==e?"string"==typeof r?a(t).fill(e,r):a(t).fill(e):a(t)}(t,e,r)},c.allocUnsafe=function(t){return f(t)},c.allocUnsafeSlow=function(t){return f(t)},c.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==c.prototype},c.compare=function(t,e){if(Y(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),Y(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let r=t.length,n=e.length;for(let i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);let r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;const n=c.allocUnsafe(e);let i=0;for(r=0;r<t.length;++r){let e=t[r];if(Y(e,Uint8Array))i+e.length>n.length?(c.isBuffer(e)||(e=c.from(e)),e.copy(n,i)):Uint8Array.prototype.set.call(n,e,i);else{if(!c.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,i)}i+=e.length}return n},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)g(this,e,e+1);return this},c.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},c.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},c.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?k(this,0,t):w.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){let t="";const r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},o&&(c.prototype[o]=c.prototype.inspect),c.prototype.compare=function(t,e,r,n,i){if(Y(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;let o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(e>>>=0);const a=Math.min(o,s),u=this.slice(n,i),h=t.slice(e,r);for(let t=0;t<a;++t)if(u[t]!==h[t]){o=u[t],s=h[t];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},c.prototype.indexOf=function(t,e,r){return b(this,t,e,r,!0)},c.prototype.lastIndexOf=function(t,e,r){return b(this,t,e,r,!1)},c.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return v(this,t,e,r);case"utf8":case"utf-8":return E(this,t,e,r);case"ascii":case"latin1":case"binary":return x(this,t,e,r);case"base64":return A(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const B=4096;function T(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function _(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function C(t,e,r){const n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=e;n<r;++n)i+=J[t[n]];return i}function L(t,e,r){const n=t.slice(e,r);let i="";for(let t=0;t<n.length-1;t+=2)i+=String.fromCharCode(n[t]+256*n[t+1]);return i}function U(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,r,n,i,o){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function N(t,e,r,n,i){$(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s,r}function P(t,e,r,n,i){$(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r+7]=o,o>>=8,t[r+6]=o,o>>=8,t[r+5]=o,o>>=8,t[r+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=s,s>>=8,t[r+2]=s,s>>=8,t[r+1]=s,s>>=8,t[r]=s,r+8}function D(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function R(t,e,r,n,o){return e=+e,r>>>=0,o||D(t,0,r,4),i.write(t,e,r,n,23,4),r+4}function j(t,e,r,n,o){return e=+e,r>>>=0,o||D(t,0,r,8),i.write(t,e,r,n,52,8),r+8}c.prototype.slice=function(t,e){const r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);const n=this.subarray(t,e);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUintLE=c.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);let n=this[t],i=1,o=0;for(;++o<e&&(i*=256);)n+=this[t+o]*i;return n},c.prototype.readUintBE=c.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);let n=this[t+--e],i=1;for(;e>0&&(i*=256);)n+=this[t+--e]*i;return n},c.prototype.readUint8=c.prototype.readUInt8=function(t,e){return t>>>=0,e||U(t,1,this.length),this[t]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(t,e){return t>>>=0,e||U(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(t,e){return t>>>=0,e||U(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(t,e){return t>>>=0,e||U(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(t,e){return t>>>=0,e||U(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readBigUInt64LE=Q((function(t){K(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||F(t,this.length-8);const n=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,i=this[++t]+256*this[++t]+65536*this[++t]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),c.prototype.readBigUInt64BE=Q((function(t){K(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||F(t,this.length-8);const n=e*2**24+65536*this[++t]+256*this[++t]+this[++t],i=this[++t]*2**24+65536*this[++t]+256*this[++t]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),c.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);let n=this[t],i=1,o=0;for(;++o<e&&(i*=256);)n+=this[t+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},c.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);let n=e,i=1,o=this[t+--n];for(;n>0&&(i*=256);)o+=this[t+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},c.prototype.readInt8=function(t,e){return t>>>=0,e||U(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){t>>>=0,e||U(t,2,this.length);const r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(t,e){t>>>=0,e||U(t,2,this.length);const r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(t,e){return t>>>=0,e||U(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return t>>>=0,e||U(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readBigInt64LE=Q((function(t){K(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||F(t,this.length-8);const n=this[t+4]+256*this[t+5]+65536*this[t+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),c.prototype.readBigInt64BE=Q((function(t){K(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||F(t,this.length-8);const n=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(n)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+r)})),c.prototype.readFloatLE=function(t,e){return t>>>=0,e||U(t,4,this.length),i.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return t>>>=0,e||U(t,4,this.length),i.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return t>>>=0,e||U(t,8,this.length),i.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return t>>>=0,e||U(t,8,this.length),i.read(this,t,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||O(this,t,e,r,Math.pow(2,8*r)-1,0);let i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||O(this,t,e,r,Math.pow(2,8*r)-1,0);let i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},c.prototype.writeUint8=c.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,1,255,0),this[e]=255&t,e+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeBigUInt64LE=Q((function(t,e=0){return N(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=Q((function(t,e=0){return P(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);O(this,t,e,r,n-1,-n)}let i=0,o=1,s=0;for(this[e]=255&t;++i<r&&(o*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+r},c.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);O(this,t,e,r,n-1,-n)}let i=r-1,o=1,s=0;for(this[e+i]=255&t;--i>=0&&(o*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+r},c.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},c.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeBigInt64LE=Q((function(t,e=0){return N(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=Q((function(t,e=0){return P(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(t,e,r){return R(this,t,e,!0,r)},c.prototype.writeFloatBE=function(t,e,r){return R(this,t,e,!1,r)},c.prototype.writeDoubleLE=function(t,e,r){return j(this,t,e,!0,r)},c.prototype.writeDoubleBE=function(t,e,r){return j(this,t,e,!1,r)},c.prototype.copy=function(t,e,r,n){if(!c.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);const i=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),i},c.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){const e=t.charCodeAt(0);("utf8"===n&&e<128||"latin1"===n)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;let i;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{const o=c.isBuffer(t)?t:c.from(t,n),s=o.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<r-e;++i)this[i+e]=o[i%s]}return this};const V={};function M(t,e,r){V[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function z(t){let e="",r=t.length;const n="-"===t[0]?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function $(t,e,r,n,i,o){if(t>r||t<e){const n="bigint"==typeof e?"n":"";let i;throw i=o>3?0===e||e===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(o+1)}${n}`:`>= -(2${n} ** ${8*(o+1)-1}${n}) and < 2 ** ${8*(o+1)-1}${n}`:`>= ${e}${n} and <= ${r}${n}`,new V.ERR_OUT_OF_RANGE("value",i,t)}!function(t,e,r){K(e,"offset"),void 0!==t[e]&&void 0!==t[e+r]||F(e,t.length-(r+1))}(n,i,o)}function K(t,e){if("number"!=typeof t)throw new V.ERR_INVALID_ARG_TYPE(e,"number",t)}function F(t,e,r){if(Math.floor(t)!==t)throw K(t,r),new V.ERR_OUT_OF_RANGE(r||"offset","an integer",t);if(e<0)throw new V.ERR_BUFFER_OUT_OF_BOUNDS;throw new V.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}M("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),M("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),M("ERR_OUT_OF_RANGE",(function(t,e,r){let n=`The value of "${t}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=z(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=z(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n}),RangeError);const q=/[^+/0-9A-Za-z-_]/g;function H(t,e){let r;e=e||1/0;const n=t.length;let i=null;const o=[];for(let s=0;s<n;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function G(t){return n.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(q,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Z(t,e,r,n){let i;for(i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function Y(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function W(t){return t!=t}const J=function(){const t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)e[n+i]=t[r]+t[i]}return e}();function Q(t){return"undefined"==typeof BigInt?X:t}function X(){throw new Error("BigInt not supported")}},957:(t,e,r)=>{"use strict";var n=r(886);e.fromCallback=function(t,e){if(void 0===t){var r=new Promise((function(e,r){t=function(t,n){t?r(t):e(n)}}));t[void 0!==e?e:"promise"]=r}else if("function"!=typeof t)throw new TypeError("Callback must be a function");return t},e.fromPromise=function(t,e){if(void 0===e)return t;t.then((function(t){n((()=>e(null,t)))})).catch((function(t){n((()=>e(t)))}))}},886:t=>{t.exports="function"==typeof queueMicrotask?queueMicrotask:t=>Promise.resolve().then(t)},729:t=>{"use strict";var e=Object.prototype.hasOwnProperty,r="~";function n(){}function i(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function o(t,e,n,o,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new i(n,o||t,s),c=r?r+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],a]:t._events[c].push(a):(t._events[c]=a,t._eventsCount++),t}function s(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var t,n,i=[];if(0===this._eventsCount)return i;for(n in t=this._events)e.call(t,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},a.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s},a.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},a.prototype.emit=function(t,e,n,i,o,s){var a=r?r+t:t;if(!this._events[a])return!1;var c,u,h=this._events[a],f=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),f){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,n),!0;case 4:return h.fn.call(h.context,e,n,i),!0;case 5:return h.fn.call(h.context,e,n,i,o),!0;case 6:return h.fn.call(h.context,e,n,i,o,s),!0}for(u=1,c=new Array(f-1);u<f;u++)c[u-1]=arguments[u];h.fn.apply(h.context,c)}else{var l,d=h.length;for(u=0;u<d;u++)switch(h[u].once&&this.removeListener(t,h[u].fn,void 0,!0),f){case 1:h[u].fn.call(h[u].context);break;case 2:h[u].fn.call(h[u].context,e);break;case 3:h[u].fn.call(h[u].context,e,n);break;case 4:h[u].fn.call(h[u].context,e,n,i);break;default:if(!c)for(l=1,c=new Array(f-1);l<f;l++)c[l-1]=arguments[l];h[u].fn.apply(h[u].context,c)}}return!0},a.prototype.on=function(t,e,r){return o(this,t,e,r,!1)},a.prototype.once=function(t,e,r){return o(this,t,e,r,!0)},a.prototype.removeListener=function(t,e,n,i){var o=r?r+t:t;if(!this._events[o])return this;if(!e)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==e||i&&!a.once||n&&a.context!==n||s(this,o);else{for(var c=0,u=[],h=a.length;c<h;c++)(a[c].fn!==e||i&&!a[c].once||n&&a[c].context!==n)&&u.push(a[c]);u.length?this._events[o]=1===u.length?u[0]:u:s(this,o)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&s(this,e)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a},187:t=>{"use strict";var e,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};e=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var i=Number.isNaN||function(t){return t!=t};function o(){o.init.call(this)}t.exports=o,t.exports.once=function(t,e){return new Promise((function(r,n){function i(r){t.removeListener(e,o),n(r)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",i),r([].slice.call(arguments))}p(t,e,o,{once:!0}),"error"!==e&&function(t,e,r){"function"==typeof t.on&&p(t,"error",e,{once:!0})}(t,i)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function c(t){return void 0===t._maxListeners?o.defaultMaxListeners:t._maxListeners}function u(t,e,r,n){var i,o,s,u;if(a(r),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),s=o[e]),void 0===s)s=o[e]=r,++t._eventsCount;else if("function"==typeof s?s=o[e]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=c(t))>0&&s.length>i&&!s.warned){s.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=t,h.type=e,h.count=s.length,u=h,console&&console.warn&&console.warn(u)}return t}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=h.bind(n);return i.listener=r,n.wrapFn=i,i}function l(t,e,r){var n=t._events;if(void 0===n)return[];var i=n[e];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(i):y(i,i.length)}function d(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function y(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function p(t,e,r,n){if("function"==typeof t.on)n.once?t.once(e,r):t.on(e,r);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function i(o){n.once&&t.removeEventListener(e,i),r(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");s=t}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var i="error"===t,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[t];if(void 0===c)return!1;if("function"==typeof c)n(c,this,e);else{var u=c.length,h=y(c,u);for(r=0;r<u;++r)n(h[r],this,e)}return!0},o.prototype.addListener=function(t,e){return u(this,t,e,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(t,e){return u(this,t,e,!0)},o.prototype.once=function(t,e){return a(e),this.on(t,f(this,t,e)),this},o.prototype.prependOnceListener=function(t,e){return a(e),this.prependListener(t,f(this,t,e)),this},o.prototype.removeListener=function(t,e){var r,n,i,o,s;if(a(e),void 0===(n=this._events))return this;if(void 0===(r=n[t]))return this;if(r===e||r.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===e||r[o].listener===e){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(r,i),1===r.length&&(n[t]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",t,s||e)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(t){var e,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},o.prototype.listeners=function(t){return l(this,t,!0)},o.prototype.rawListeners=function(t){return l(this,t,!1)},o.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):d.call(t,e)},o.prototype.listenerCount=d,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},645:(t,e)=>{e.read=function(t,e,r,n,i){var o,s,a=8*i-n-1,c=(1<<a)-1,u=c>>1,h=-7,f=r?i-1:0,l=r?-1:1,d=t[e+f];for(f+=l,o=d&(1<<-h)-1,d>>=-h,h+=a;h>0;o=256*o+t[e+f],f+=l,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=n;h>0;s=256*s+t[e+f],f+=l,h-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,n),o-=u}return(d?-1:1)*s*Math.pow(2,o-n)},e.write=function(t,e,r,n,i,o){var s,a,c,u=8*o-i-1,h=(1<<u)-1,f=h>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,y=n?1:-1,p=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+f>=1?l/c:l*Math.pow(2,1-f))*c>=2&&(s++,c/=2),s+f>=h?(a=0,s=h):s+f>=1?(a=(e*c-1)*Math.pow(2,i),s+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;t[r+d]=255&a,d+=y,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[r+d]=255&s,d+=y,s/=256,u-=8);t[r+d-y]|=128*p}},717:t=>{"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}}},675:(t,e)=>{"use strict";e.supports=function(...t){const e=t.reduce(((t,e)=>Object.assign(t,e)),{});return Object.assign(e,{snapshots:e.snapshots||!1,permanence:e.permanence||!1,seek:e.seek||!1,clear:e.clear||!1,getMany:e.getMany||!1,keyIterator:e.keyIterator||!1,valueIterator:e.valueIterator||!1,iteratorNextv:e.iteratorNextv||!1,iteratorAll:e.iteratorAll||!1,status:e.status||!1,createIfMissing:e.createIfMissing||!1,errorIfExists:e.errorIfExists||!1,deferredOpen:e.deferredOpen||!1,promises:e.promises||!1,streams:e.streams||!1,encodings:Object.assign({},e.encodings),events:Object.assign({},e.events),additionalMethods:Object.assign({},e.additionalMethods)})}},499:(t,e,r)=>{"use strict";const n=r(473),i=r(2),{Encoding:o}=r(266),{BufferFormat:s,ViewFormat:a,UTF8Format:c}=r(376),u=Symbol("formats"),h=Symbol("encodings"),f=new Set(["buffer","view","utf8"]);e.Transcoder=class{constructor(t){if(!Array.isArray(t))throw new TypeError("The first argument 'formats' must be an array");if(!t.every((t=>f.has(t))))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'");this[h]=new Map,this[u]=new Set(t);for(const t in i)try{this.encoding(t)}catch(t){if("LEVEL_ENCODING_NOT_SUPPORTED"!==t.code)throw t}}encodings(){return Array.from(new Set(this[h].values()))}encoding(t){let e=this[h].get(t);if(void 0===e){if("string"==typeof t&&""!==t){if(e=d[t],!e)throw new n(`Encoding '${t}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if("object"!=typeof t||null===t)throw new TypeError("First argument 'encoding' must be a string or object");e=function(t){if(t instanceof o)return t;const e="type"in t&&"string"==typeof t.type?t.type:void 0,r=t.name||e||"anonymous-"+y++;switch(function(t){return"format"in t&&void 0!==t.format?t.format:"buffer"in t&&"boolean"==typeof t.buffer?t.buffer?"buffer":"utf8":"code"in t&&Number.isInteger(t.code)?"view":"buffer"}(t)){case"view":return new a({...t,name:r});case"utf8":return new c({...t,name:r});case"buffer":return new s({...t,name:r});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}(t)}const{name:r,format:i}=e;if(!this[u].has(i))if(this[u].has("view"))e=e.createViewTranscoder();else if(this[u].has("buffer"))e=e.createBufferTranscoder();else{if(!this[u].has("utf8"))throw new n(`Encoding '${r}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});e=e.createUTF8Transcoder()}for(const n of[t,r,e.name,e.commonName])this[h].set(n,e)}return e}};const l={binary:i.buffer,"utf-8":i.utf8},d={...i,...l};let y=0},266:(t,e,r)=>{"use strict";const n=r(473),i=new Set(["buffer","view","utf8"]);e.Encoding=class{constructor(t){if(this.encode=t.encode||this.encode,this.decode=t.decode||this.decode,this.name=t.name||this.name,this.format=t.format||this.format,"function"!=typeof this.encode)throw new TypeError("The 'encode' property must be a function");if("function"!=typeof this.decode)throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),"string"!=typeof this.name||""===this.name)throw new TypeError("The 'name' property must be a string");if("string"!=typeof this.format||!i.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");t.createViewTranscoder&&(this.createViewTranscoder=t.createViewTranscoder),t.createBufferTranscoder&&(this.createBufferTranscoder=t.createBufferTranscoder),t.createUTF8Transcoder&&(this.createUTF8Transcoder=t.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new n(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}}},2:(t,e,r)=>{"use strict";const{Buffer:n}=r(764)||{Buffer:{isBuffer:()=>!1}},{textEncoder:i,textDecoder:o}=r(850)(),{BufferFormat:s,ViewFormat:a,UTF8Format:c}=r(376),u=t=>t;e.utf8=new c({encode:function(t){return n.isBuffer(t)?t.toString("utf8"):ArrayBuffer.isView(t)?o.decode(t):String(t)},decode:u,name:"utf8",createViewTranscoder(){return new a({encode:function(t){return ArrayBuffer.isView(t)?t:i.encode(t)},decode:function(t){return o.decode(t)},name:`${this.name}+view`})},createBufferTranscoder(){return new s({encode:function(t){return n.isBuffer(t)?t:ArrayBuffer.isView(t)?n.from(t.buffer,t.byteOffset,t.byteLength):n.from(String(t),"utf8")},decode:function(t){return t.toString("utf8")},name:`${this.name}+buffer`})}}),e.json=new c({encode:JSON.stringify,decode:JSON.parse,name:"json"}),e.buffer=new s({encode:function(t){return n.isBuffer(t)?t:ArrayBuffer.isView(t)?n.from(t.buffer,t.byteOffset,t.byteLength):n.from(String(t),"utf8")},decode:u,name:"buffer",createViewTranscoder(){return new a({encode:function(t){return ArrayBuffer.isView(t)?t:n.from(String(t),"utf8")},decode:function(t){return n.from(t.buffer,t.byteOffset,t.byteLength)},name:`${this.name}+view`})}}),e.view=new a({encode:function(t){return ArrayBuffer.isView(t)?t:i.encode(t)},decode:u,name:"view",createBufferTranscoder(){return new s({encode:function(t){return n.isBuffer(t)?t:ArrayBuffer.isView(t)?n.from(t.buffer,t.byteOffset,t.byteLength):n.from(String(t),"utf8")},decode:u,name:`${this.name}+buffer`})}}),e.hex=new s({encode:function(t){return n.isBuffer(t)?t:n.from(String(t),"hex")},decode:function(t){return t.toString("hex")},name:"hex"}),e.base64=new s({encode:function(t){return n.isBuffer(t)?t:n.from(String(t),"base64")},decode:function(t){return t.toString("base64")},name:"base64"})},376:(t,e,r)=>{"use strict";const{Buffer:n}=r(764)||{},{Encoding:i}=r(266),o=r(850);class s extends i{constructor(t){super({...t,format:"buffer"})}createViewTranscoder(){return new a({encode:this.encode,decode:t=>this.decode(n.from(t.buffer,t.byteOffset,t.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}}class a extends i{constructor(t){super({...t,format:"view"})}createBufferTranscoder(){return new s({encode:t=>{const e=this.encode(t);return n.from(e.buffer,e.byteOffset,e.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}}e.BufferFormat=s,e.ViewFormat=a,e.UTF8Format=class extends i{constructor(t){super({...t,format:"utf8"})}createBufferTranscoder(){return new s({encode:t=>n.from(this.encode(t),"utf8"),decode:t=>this.decode(t.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:t,textDecoder:e}=o();return new a({encode:e=>t.encode(this.encode(e)),decode:t=>this.decode(e.decode(t)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}}},850:t=>{"use strict";let e=null;t.exports=function(){return null===e&&(e={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),e}},301:(t,e,r)=>{e.Level=r(708).BrowserLevel},117:(t,e,r)=>{var n=r(187),i=r(717);function o(t){if(!(this instanceof o))return new o(t);"number"==typeof t&&(t={max:t}),t||(t={}),n.EventEmitter.call(this),this.cache={},this.head=this.tail=null,this.length=0,this.max=t.max||1e3,this.maxAge=t.maxAge||0}t.exports=o,i(o,n.EventEmitter),Object.defineProperty(o.prototype,"keys",{get:function(){return Object.keys(this.cache)}}),o.prototype.clear=function(){this.cache={},this.head=this.tail=null,this.length=0},o.prototype.remove=function(t){if("string"!=typeof t&&(t=""+t),this.cache.hasOwnProperty(t)){var e=this.cache[t];return delete this.cache[t],this._unlink(t,e.prev,e.next),e.value}},o.prototype._unlink=function(t,e,r){this.length--,0===this.length?this.head=this.tail=null:this.head===t?(this.head=e,this.cache[this.head].next=null):this.tail===t?(this.tail=r,this.cache[this.tail].prev=null):(this.cache[e].next=r,this.cache[r].prev=e)},o.prototype.peek=function(t){if(this.cache.hasOwnProperty(t)){var e=this.cache[t];if(this._checkAge(t,e))return e.value}},o.prototype.set=function(t,e){var r;if("string"!=typeof t&&(t=""+t),this.cache.hasOwnProperty(t)){if((r=this.cache[t]).value=e,this.maxAge&&(r.modified=Date.now()),t===this.head)return e;this._unlink(t,r.prev,r.next)}else r={value:e,modified:0,next:null,prev:null},this.maxAge&&(r.modified=Date.now()),this.cache[t]=r,this.length===this.max&&this.evict();return this.length++,r.next=null,r.prev=this.head,this.head&&(this.cache[this.head].next=t),this.head=t,this.tail||(this.tail=t),e},o.prototype._checkAge=function(t,e){return!(this.maxAge&&Date.now()-e.modified>this.maxAge&&(this.remove(t),this.emit("evict",{key:t,value:e.value}),1))},o.prototype.get=function(t){if("string"!=typeof t&&(t=""+t),this.cache.hasOwnProperty(t)){var e=this.cache[t];if(this._checkAge(t,e))return this.head!==t&&(t===this.tail?(this.tail=e.next,this.cache[this.tail].prev=null):this.cache[e.prev].next=e.next,this.cache[e.next].prev=e.prev,this.cache[this.head].next=t,e.prev=this.head,e.next=null,this.head=t),e.value}},o.prototype.evict=function(){if(this.tail){var t=this.tail,e=this.remove(this.tail);this.emit("evict",{key:t,value:e})}}},473:t=>{"use strict";t.exports=class extends Error{constructor(t,e){super(t||""),"object"==typeof e&&null!==e&&(e.code&&(this.code=String(e.code)),e.expected&&(this.expected=!0),e.transient&&(this.transient=!0),e.cause&&(this.cause=e.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}},375:(t,e,r)=>{let n;t.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:r.g):t=>(n||(n=Promise.resolve())).then(t).catch((t=>setTimeout((()=>{throw t}),0)))},916:(t,e,r)=>{"use strict";const n=r(807);class i{constructor(t,e,r){const i=this;this._started=n(),this._rescheduled=0,this._scheduled=e,this._args=r,this._triggered=!1,this._timerWrapper=()=>{i._rescheduled>0?(i._scheduled=i._rescheduled-(n()-i._started),i._schedule(i._scheduled)):(i._triggered=!0,t.apply(null,i._args))},this._timer=setTimeout(this._timerWrapper,e)}reschedule(t){t||(t=this._scheduled);const e=n();e+t-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(t)):this._triggered?this._schedule(t):(this._started=e,this._rescheduled=t)}_schedule(t){this._triggered=!1,this._started=n(),this._rescheduled=0,this._scheduled=t,this._timer=setTimeout(this._timerWrapper,t)}clear(){clearTimeout(this._timer)}}t.exports=function(){if("function"!=typeof arguments[0])throw new Error("callback needed");if("number"!=typeof arguments[1])throw new Error("timeout needed");let t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new i(arguments[0],arguments[1],t)}},807:t=>{"use strict";t.exports=function(){return Date.now()}},967:(t,e,r)=>{t.exports=function(t,e,r){if("number"!=typeof e)throw new Error("second argument must be a Number");let i,o,s,a,c,u,h=!0;function f(t){function e(){r&&r(t,i),r=null}h?n(e):e()}function l(e,r,n){if(i[e]=n,r&&(c=!0),0==--s||r)f(r);else if(!c&&u<o){let e;a?(e=a[u],u+=1,t[e]((function(t,r){l(e,t,r)}))):(e=u,u+=1,t[e]((function(t,r){l(e,t,r)})))}}Array.isArray(t)?(i=[],s=o=t.length):(a=Object.keys(t),i={},s=o=a.length),u=e,s?a?a.some((function(r,n){return t[r]((function(t,e){l(r,t,e)})),n===e-1})):t.some((function(t,r){return t((function(t,e){l(r,t,e)})),r===e-1})):f(null),h=!1};const n=r(375)},715:(t,e,r)=>{"use strict";const{AbortController:n}=globalThis,i=r(916);class o extends n{constructor(t){super(),this._ms=t,this._timer=i((()=>this.abort()),t),Object.setPrototypeOf(this,o.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=i((()=>this.abort()),this._ms)}}t.exports={TimeoutController:o}}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,r),o.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{"use strict";r.r(n),r.d(n,{ComposedStorage:()=>In,Database:()=>Un,DefaultAccessController:()=>An,Documents:()=>Dn,Entry:()=>fn,Events:()=>Vn,IPFSAccessController:()=>sf,IPFSBlockStorage:()=>kn,Identities:()=>Hh,KeyStore:()=>Uh,KeyValue:()=>$n,KeyValueIndexed:()=>qn,LRUStorage:()=>Cn,LevelStorage:()=>Tn,Log:()=>Sn,MemoryStorage:()=>pn,OrbitDBAccessController:()=>uf,PublicKeyIdentityProvider:()=>zh,createOrbitDB:()=>df,isIdentity:()=>jh,isValidAddress:()=>Gh,parseAddress:()=>Zh,useAccessController:()=>ff,useDatabaseType:()=>Gn,useIdentityProvider:()=>Fh});var t={};r.r(t),r.d(t,{code:()=>en,decode:()=>nn,decodeOptions:()=>Xr,encode:()=>rn,encodeOptions:()=>Jr,name:()=>tn,toByteView:()=>Yr});var e={};r.r(e),r.d(e,{base10:()=>mi});var i={};r.r(i),r.d(i,{base16:()=>vi,base16upper:()=>Ei});var o={};r.r(o),r.d(o,{base2:()=>xi});var s={};r.r(s),r.d(s,{base256emoji:()=>ki});var a={};r.r(a),r.d(a,{base32:()=>Bi,base32hex:()=>Li,base32hexpad:()=>Oi,base32hexpadupper:()=>Ni,base32hexupper:()=>Ui,base32pad:()=>_i,base32padupper:()=>Ci,base32upper:()=>Ti,base32z:()=>Pi});var c={};r.r(c),r.d(c,{base36:()=>Di,base36upper:()=>Ri});var u={};r.r(u),r.d(u,{base58btc:()=>ji,base58flickr:()=>Vi});var h={};r.r(h),r.d(h,{base64:()=>Mi,base64pad:()=>zi,base64url:()=>$i,base64urlpad:()=>Ki});var f={};r.r(f),r.d(f,{base8:()=>Fi});var l={};r.r(l),r.d(l,{identity:()=>qi});var d={};r.r(d),r.d(d,{code:()=>Yi,decode:()=>Ji,encode:()=>Wi,name:()=>Zi});var y={};r.r(y),r.d(y,{code:()=>Xi,decode:()=>eo,encode:()=>to,name:()=>Qi});var p={};r.r(p),r.d(p,{identity:()=>Ao});var w={};r.r(w),r.d(w,{sha256:()=>Bo,sha512:()=>To});var g={};r.r(g),r.d(g,{Fy:()=>ja,uw:()=>xa,gk:()=>Ea,Dd:()=>Va,dQ:()=>Ma,ci:()=>Sa,bytesToNumberBE:()=>Ca,ty:()=>La,eV:()=>Pa,n$:()=>Ka,ql:()=>Na,hexToBytes:()=>_a,Z2:()=>Ra,_t:()=>va,H9:()=>Ha,tL:()=>Ua,S5:()=>Oa,uz:()=>Ia,FF:()=>qa});var b=r(187),m=r(729);class v extends Error{constructor(t){super(t),this.name="TimeoutError"}}class E extends Error{constructor(t){super(),this.name="AbortError",this.message=t}}const x=t=>void 0===globalThis.DOMException?new E(t):new DOMException(t),A=t=>{const e=void 0===t.reason?x("This operation was aborted."):t.reason;return e instanceof Error?e:x(e)};class S{#t=[];enqueue(t,e){const r={priority:(e={priority:0,...e}).priority,run:t};if(this.size&&this.#t[this.size-1].priority>=e.priority)return void this.#t.push(r);const n=function(t,e,r){let n=0,i=t.length;for(;i>0;){const r=Math.trunc(i/2);let s=n+r;o=t[s],e.priority-o.priority<=0?(n=++s,i-=r+1):i=r}var o;return n}(this.#t,r);this.#t.splice(n,0,r)}dequeue(){const t=this.#t.shift();return t?.run}filter(t){return this.#t.filter((e=>e.priority===t.priority)).map((t=>t.run))}get size(){return this.#t.length}}class I extends m{#e;#r;#n=0;#i;#o;#s=0;#a;#c;#t;#u;#h=0;#f;#l;#d;timeout;constructor(t){if(super(),!("number"==typeof(t={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:S,...t}).intervalCap&&t.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${t.intervalCap?.toString()??""}\` (${typeof t.intervalCap})`);if(void 0===t.interval||!(Number.isFinite(t.interval)&&t.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${t.interval?.toString()??""}\` (${typeof t.interval})`);this.#e=t.carryoverConcurrencyCount,this.#r=t.intervalCap===Number.POSITIVE_INFINITY||0===t.interval,this.#i=t.intervalCap,this.#o=t.interval,this.#t=new t.queueClass,this.#u=t.queueClass,this.concurrency=t.concurrency,this.timeout=t.timeout,this.#d=!0===t.throwOnTimeout,this.#l=!1===t.autoStart}get#y(){return this.#r||this.#n<this.#i}get#p(){return this.#h<this.#f}#w(){this.#h--,this.#g(),this.emit("next")}#b(){this.#m(),this.#v(),this.#c=void 0}get#E(){const t=Date.now();if(void 0===this.#a){const e=this.#s-t;if(!(e<0))return void 0===this.#c&&(this.#c=setTimeout((()=>{this.#b()}),e)),!0;this.#n=this.#e?this.#h:0}return!1}#g(){if(0===this.#t.size)return this.#a&&clearInterval(this.#a),this.#a=void 0,this.emit("empty"),0===this.#h&&this.emit("idle"),!1;if(!this.#l){const t=!this.#E;if(this.#y&&this.#p){const e=this.#t.dequeue();return!!e&&(this.emit("active"),e(),t&&this.#v(),!0)}}return!1}#v(){this.#r||void 0!==this.#a||(this.#a=setInterval((()=>{this.#m()}),this.#o),this.#s=Date.now()+this.#o)}#m(){0===this.#n&&0===this.#h&&this.#a&&(clearInterval(this.#a),this.#a=void 0),this.#n=this.#e?this.#h:0,this.#x()}#x(){for(;this.#g(););}get concurrency(){return this.#f}set concurrency(t){if(!("number"==typeof t&&t>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${t}\` (${typeof t})`);this.#f=t,this.#x()}async#A(t){return new Promise(((e,r)=>{t.addEventListener("abort",(()=>{r(t.reason)}),{once:!0})}))}async add(t,e={}){return e={timeout:this.timeout,throwOnTimeout:this.#d,...e},new Promise(((r,n)=>{this.#t.enqueue((async()=>{this.#h++,this.#n++;try{e.signal?.throwIfAborted();let n=t({signal:e.signal});e.timeout&&(n=function(t,e){const{milliseconds:r,fallback:n,message:i,customTimers:o={setTimeout,clearTimeout}}=e;let s,a;const c=new Promise(((c,u)=>{if("number"!=typeof r||1!==Math.sign(r))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(e.signal){const{signal:t}=e;t.aborted&&u(A(t)),a=()=>{u(A(t))},t.addEventListener("abort",a,{once:!0})}if(r===Number.POSITIVE_INFINITY)return void t.then(c,u);const h=new v;s=o.setTimeout.call(void 0,(()=>{if(n)try{c(n())}catch(t){u(t)}else"function"==typeof t.cancel&&t.cancel(),!1===i?c():i instanceof Error?u(i):(h.message=i??`Promise timed out after ${r} milliseconds`,u(h))}),r),(async()=>{try{c(await t)}catch(t){u(t)}})()})).finally((()=>{c.clear(),a&&e.signal&&e.signal.removeEventListener("abort",a)}));return c.clear=()=>{o.clearTimeout.call(void 0,s),s=void 0},c}(Promise.resolve(n),{milliseconds:e.timeout})),e.signal&&(n=Promise.race([n,this.#A(e.signal)]));const i=await n;r(i),this.emit("completed",i)}catch(t){if(t instanceof v&&!e.throwOnTimeout)return void r();n(t),this.emit("error",t)}finally{this.#w()}}),e),this.emit("add"),this.#g()}))}async addAll(t,e){return Promise.all(t.map((async t=>this.add(t,e))))}start(){return this.#l?(this.#l=!1,this.#x(),this):this}pause(){this.#l=!0}clear(){this.#t=new this.#u}async onEmpty(){0!==this.#t.size&&await this.#S("empty")}async onSizeLessThan(t){this.#t.size<t||await this.#S("next",(()=>this.#t.size<t))}async onIdle(){0===this.#h&&0===this.#t.size||await this.#S("idle")}async#S(t,e){return new Promise((r=>{const n=()=>{e&&!e()||(this.off(t,n),r())};this.on(t,n)}))}get size(){return this.#t.size}sizeBy(t){return this.#t.filter(t).length}get pending(){return this.#h}get isPaused(){return this.#l}}function k(){const t={};return t.promise=new Promise(((e,r)=>{t.resolve=e,t.reject=r})),t}class B{buffer;mask;top;btm;next;constructor(t){if(!(t>0)||0!=(t-1&t))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(t),this.mask=t-1,this.top=0,this.btm=0,this.next=null}push(t){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=t,this.top=this.top+1&this.mask,!0)}shift(){const t=this.buffer[this.btm];if(void 0!==t)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,t}isEmpty(){return void 0===this.buffer[this.btm]}}class T{size;hwm;head;tail;constructor(t={}){this.hwm=t.splitLimit??16,this.head=new B(this.hwm),this.tail=this.head,this.size=0}calculateSize(t){return null!=t?.byteLength?t.byteLength:1}push(t){if(null!=t?.value&&(this.size+=this.calculateSize(t.value)),!this.head.push(t)){const e=this.head;this.head=e.next=new B(2*this.head.buffer.length),this.head.push(t)}}shift(){let t=this.tail.shift();if(void 0===t&&null!=this.tail.next){const e=this.tail.next;this.tail.next=null,this.tail=e,t=this.tail.shift()}return null!=t?.value&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}}class _ extends Error{type;code;constructor(t,e){super(t??"The operation was aborted"),this.type="aborted",this.code=e??"ABORT_ERR"}}function C(t={}){return function(t,e){let r,n,i,o=(e=e??{}).onEnd,s=new T,a=k();const c=t=>null!=n?n(t):(s.push(t),r),u=t=>{if(i)return r;if(!0!==e?.objectMode&&null==t?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:t})},h=t=>i?r:(i=!0,null!=t?(t=>(s=new T,null!=n?n({error:t}):(s.push({error:t}),r)))(t):c({done:!0}));if(r={[Symbol.asyncIterator](){return this},next:async()=>{try{return s.isEmpty()?i?{done:!0}:await new Promise(((e,i)=>{n=o=>{n=null,s.push(o);try{e(t(s))}catch(t){i(t)}return r}})):t(s)}finally{s.isEmpty()&&queueMicrotask((()=>{a.resolve(),a=k()}))}},return:()=>(s=new T,h(),{done:!0}),throw:t=>(h(t),{done:!0}),push:u,end:h,get readableLength(){return s.size},onEmpty:async t=>{const e=t?.signal;if(e?.throwIfAborted(),s.isEmpty())return;let r,n;null!=e&&(r=new Promise(((t,r)=>{n=()=>{r(new _)},e.addEventListener("abort",n)})));try{await Promise.race([a.promise,r])}finally{null!=n&&null!=e&&e?.removeEventListener("abort",n)}}},null==o)return r;const f=r;return r={[Symbol.asyncIterator](){return this},next:()=>f.next(),throw:t=>(f.throw(t),null!=o&&(o(t),o=void 0),{done:!0}),return:()=>(f.return(),null!=o&&(o(),o=void 0),{done:!0}),push:u,end:t=>(f.end(t),null!=o&&(o(t),o=void 0),r),get readableLength(){return f.readableLength},onEmpty:t=>f.onEmpty(t)},r}((t=>{const e=t.shift();if(null==e)return{done:!0};if(null!=e.error)throw e.error;return{done:!0===e.done,value:e.value}}),t)}function L(t,...e){if(null==t)throw new Error("Empty pipeline");if(P(t)){const e=t;t=()=>e.source}else if(N(t)||O(t)){const e=t;t=()=>e}const r=[t,...e];if(r.length>1&&P(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let t=1;t<r.length-1;t++)P(r[t])&&(r[t]=D(r[t]));return U(...r)}const U=(...t)=>{let e;for(;t.length>0;)e=t.shift()(e);return e},O=t=>null!=t?.[Symbol.asyncIterator],N=t=>null!=t?.[Symbol.iterator],P=t=>null!=t&&null!=t.sink&&null!=t.source,D=t=>e=>{const r=t.sink(e);if(null!=r?.then){const e=C({objectMode:!0});let n;r.then((()=>{e.end()}),(t=>{e.end(t)}));const i=t.source;if(O(i))n=async function*(){yield*i,e.end()};else{if(!N(i))throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");n=function*(){yield*i,e.end()}}return function(...t){const e=[];for(const r of t)null==r[Symbol.asyncIterator]&&e.push(r);return e.length===t.length?function*(){for(const t of e)yield*t}():async function*(){const e=C({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(t.map((async t=>{for await(const r of t)e.push(r)}))),e.end()}catch(t){e.end(t)}})),yield*e}()}(e,n())}return t.source};var R=r(715);const j=(...t)=>t.join("/").replace(/((?<=\/)\/+)|(^\.\/)|((?<=\/)\.\/)/g,"")||".",V=j;var M=r(117);const z=(t,e)=>({id:t,time:e=e||0}),$=(new Uint8Array(0),t=>{if(t instanceof Uint8Array&&"Uint8Array"===t.constructor.name)return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")});const K=function(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function f(t){if("string"!=typeof t)throw new TypeError("Expected String");if(0===t.length)return new Uint8Array;var e=0;if(" "!==t[e]){for(var n=0,i=0;t[e]===c;)n++,e++;for(var o=(t.length-e)*u+1>>>0,s=new Uint8Array(o);t[e];){var h=r[t.charCodeAt(e)];if(255===h)return;for(var f=0,l=o-1;(0!==h||f<i)&&-1!==l;l--,f++)h+=a*s[l]>>>0,s[l]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");i=f,e++}if(" "!==t[e]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var y=new Uint8Array(n+(o-d)),p=n;d!==o;)y[p++]=s[d++];return y}}}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,n=0,i=0,o=e.length;i!==o&&0===e[i];)i++,r++;for(var s=(o-i)*h+1>>>0,u=new Uint8Array(s);i!==o;){for(var f=e[i],l=0,d=s-1;(0!==f||l<n)&&-1!==d;d--,l++)f+=256*u[d]>>>0,u[d]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=l,i++}for(var y=s-n;y!==s&&0===u[y];)y++;for(var p=c.repeat(r);y<s;++y)p+=t.charAt(u[y]);return p},decodeUnsafe:f,decode:function(t){var r=f(t);if(r)return r;throw new Error(`Non-${e} character`)}}};class F{constructor(t,e,r){this.name=t,this.prefix=e,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class q{constructor(t,e,r){if(this.name=t,this.prefix=e,void 0===e.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=r}decode(t){if("string"==typeof t){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(t){return G(this,t)}}class H{constructor(t){this.decoders=t}or(t){return G(this,t)}decode(t){const e=t[0],r=this.decoders[e];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const G=(t,e)=>new H({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Z{constructor(t,e,r,n){this.name=t,this.prefix=e,this.baseEncode=r,this.baseDecode=n,this.encoder=new F(t,e,r),this.decoder=new q(t,e,n)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Y=({name:t,prefix:e,encode:r,decode:n})=>new Z(t,e,r,n),W=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=K(r,e);return Y({prefix:t,name:e,encode:n,decode:t=>$(i(t))})},J=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Y({prefix:e,name:t,encode:t=>((t,e,r)=>{const n="="===e[e.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<t.length;++n)for(a=a<<8|t[n],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o})(t,n,r),decode:e=>((t,e,r,n)=>{const i={};for(let t=0;t<e.length;++t)i[e[t]]=t;let o=t.length;for(;"="===t[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,u=0;for(let e=0;e<o;++e){const o=i[t[e]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,n,r,t)}),Q=J({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),X=(J({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),J({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),J({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),J({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),J({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),J({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),J({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),J({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),W({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}));W({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var tt=128,et=-128,rt=Math.pow(2,31),nt=128,it=127,ot=Math.pow(2,7),st=Math.pow(2,14),at=Math.pow(2,21),ct=Math.pow(2,28),ut=Math.pow(2,35),ht=Math.pow(2,42),ft=Math.pow(2,49),lt=Math.pow(2,56),dt=Math.pow(2,63);const yt={encode:function t(e,r,n){r=r||[];for(var i=n=n||0;e>=rt;)r[n++]=255&e|tt,e/=128;for(;e&et;)r[n++]=255&e|tt,e>>>=7;return r[n]=0|e,t.bytes=n-i+1,r},decode:function t(e,r){var n,i=0,o=0,s=r=r||0,a=e.length;do{if(s>=a)throw t.bytes=0,new RangeError("Could not decode varint");n=e[s++],i+=o<28?(n&it)<<o:(n&it)*Math.pow(2,o),o+=7}while(n>=nt);return t.bytes=s-r,i},encodingLength:function(t){return t<ot?1:t<st?2:t<at?3:t<ct?4:t<ut?5:t<ht?6:t<ft?7:t<lt?8:t<dt?9:10}},pt=(t,e=0)=>[yt.decode(t,e),yt.decode.bytes],wt=(t,e,r=0)=>(yt.encode(t,e,r),e),gt=t=>yt.encodingLength(t),bt=(t,e)=>{const r=e.byteLength,n=gt(t),i=n+gt(r),o=new Uint8Array(i+r);return wt(t,o,0),wt(r,o,n),o.set(e,i),new mt(t,r,e,o)};class mt{constructor(t,e,r,n){this.code=t,this.size=e,this.digest=r,this.bytes=n}}const vt=(t,e)=>{const{bytes:r,version:n}=t;return 0===n?It(r,xt(t),e||X.encoder):kt(r,xt(t),e||Q.encoder)},Et=new WeakMap,xt=t=>{const e=Et.get(t);if(null==e){const e=new Map;return Et.set(t,e),e}return e};class At{constructor(t,e,r,n){this.code=e,this.version=t,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:e}=this;if(t!==Bt)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==Tt)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return At.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:e}=this.multihash,r=bt(t,e);return At.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return At.equals(this,t)}static equals(t,e){const r=e;return r&&t.code===r.code&&t.version===r.version&&((t,e)=>{if(t===e)return!0;{const r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&((t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0})(t.bytes,r.bytes)}})(t.multihash,r.multihash)}toString(t){return vt(this,t)}toJSON(){return{"/":vt(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(null==t)return null;const e=t;if(e instanceof At)return e;if(null!=e["/"]&&e["/"]===e.bytes||e.asCID===e){const{version:t,code:r,multihash:n,bytes:i}=e;return new At(t,r,n,i||_t(t,r,n.bytes))}if(!0===e[Ct]){const{version:t,multihash:r,code:n}=e,i=(t=>{const e=$(t),[r,n]=pt(e),[i,o]=pt(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new mt(r,i,s,e)})(r);return At.create(t,n,i)}return null}static create(t,e,r){if("number"!=typeof e)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:if(e!==Bt)throw new Error(`Version 0 CID must use dag-pb (code: ${Bt}) block encoding`);return new At(t,e,r,r.bytes);case 1:{const n=_t(t,e,r.bytes);return new At(t,e,r,n)}default:throw new Error("Invalid version")}}static createV0(t){return At.create(0,Bt,t)}static createV1(t,e){return At.create(1,t,e)}static decode(t){const[e,r]=At.decodeFirst(t);if(r.length)throw new Error("Incorrect length");return e}static decodeFirst(t){const e=At.inspectBytes(t),r=e.size-e.multihashSize,n=$(t.subarray(r,r+e.multihashSize));if(n.byteLength!==e.multihashSize)throw new Error("Incorrect length");const i=n.subarray(e.multihashSize-e.digestSize),o=new mt(e.multihashCode,e.digestSize,i,n);return[0===e.version?At.createV0(o):At.createV1(e.codec,o),t.subarray(e.size)]}static inspectBytes(t){let e=0;const r=()=>{const[r,n]=pt(t.subarray(e));return e+=n,r};let n=r(),i=Bt;if(18===n?(n=0,e=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const o=e,s=r(),a=r(),c=e+a;return{version:n,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(t,e){const[r,n]=St(t,e),i=At.decode(n);if(0===i.version&&"Q"!==t[0])throw Error("Version 0 CID string must not include multibase prefix");return xt(i).set(r,t),i}}const St=(t,e)=>{switch(t[0]){case"Q":{const r=e||X;return[X.prefix,r.decode(`${X.prefix}${t}`)]}case X.prefix:{const r=e||X;return[X.prefix,r.decode(t)]}case Q.prefix:{const r=e||Q;return[Q.prefix,r.decode(t)]}default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}},It=(t,e,r)=>{const{prefix:n}=r;if(n!==X.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=e.get(n);if(null==i){const i=r.encode(t).slice(1);return e.set(n,i),i}return i},kt=(t,e,r)=>{const{prefix:n}=r,i=e.get(n);if(null==i){const i=r.encode(t);return e.set(n,i),i}return i},Bt=112,Tt=18,_t=(t,e,r)=>{const n=gt(t),i=n+gt(e),o=new Uint8Array(i+r.byteLength);return wt(t,o,0),wt(e,o,n),o.set(r,i),o},Ct=Symbol.for("@ipld/js-cid/CID"),Lt=({name:t,code:e,encode:r})=>new Ut(t,e,r);class Ut{constructor(t,e,r){this.name=t,this.code=e,this.encode=r}digest(t){if(t instanceof Uint8Array){const e=this.encode(t);return e instanceof Uint8Array?bt(this.code,e):e.then((t=>bt(this.code,t)))}throw Error("Unknown type, must be binary type")}}function Ot({enumerable:t=!0,configurable:e=!1}={}){return{enumerable:t,configurable:e,writable:!1}}function*Nt(t,e){if(null!=e&&"object"==typeof e)if(Array.isArray(e))for(const[r,n]of e.entries()){const e=[...t,r],i=At.asCID(n);i?yield[e.join("/"),i]:"object"==typeof n&&(yield*Pt(n,e))}else{const r=At.asCID(e);r?yield[t.join("/"),r]:yield*Pt(e,t)}}function*Pt(t,e){if(null==t||t instanceof Uint8Array)return;const r=At.asCID(t);r&&(yield[e.join("/"),r]);for(const[r,n]of Object.entries(t)){const t=[...e,r];yield*Nt(t,n)}}function*Dt(t,e){if(Array.isArray(e))for(const[r,n]of e.entries()){const e=[...t,r];yield e.join("/"),"object"!=typeof n||At.asCID(n)||(yield*Rt(n,e))}else yield*Rt(e,t)}function*Rt(t,e){if(null!=t&&"object"==typeof t)for(const[r,n]of Object.entries(t)){const t=[...e,r];yield t.join("/"),null==n||n instanceof Uint8Array||"object"!=typeof n||At.asCID(n)||(yield*Dt(t,n))}}class jt{constructor({cid:t,bytes:e,value:r}){if(!t||!e||void 0===r)throw new Error("Missing required argument");this.cid=t,this.bytes=e,this.value=r,this.asBlock=this,Object.defineProperties(this,{cid:Ot(),bytes:Ot(),value:Ot(),asBlock:Ot()})}links(){return Pt(this.value,[])}tree(){return Rt(this.value,[])}get(t="/"){return function(t,e){let r=t;for(const[t,n]of e.entries()){if(r=r[n],null==r)throw new Error(`Object has no property at ${e.slice(0,t+1).map((t=>`[${JSON.stringify(t)}]`)).join("")}`);const i=At.asCID(r);if(i)return{value:i,remaining:e.slice(t+1).join("/")}}return{value:r}}(this.value,t.split("/").filter(Boolean))}}async function Vt({value:t,codec:e,hasher:r}){if(void 0===t)throw new Error('Missing required argument "value"');if(!e||!r)throw new Error("Missing required argument: codec or hasher");const n=e.encode(t),i=await r.digest(n),o=At.create(1,e.code,i);return new jt({value:t,bytes:n,cid:o})}async function Mt({bytes:t,codec:e,hasher:r}){if(!t)throw new Error('Missing required argument "bytes"');if(!e||!r)throw new Error("Missing required argument: codec or hasher");const n=e.decode(t),i=await r.digest(t),o=At.create(1,e.code,i);return new jt({value:n,bytes:t,cid:o})}const zt=["string","number","bigint","symbol"],$t=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];class Kt{constructor(t,e,r){this.major=t,this.majorEncoded=t<<5,this.name=e,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}}Kt.uint=new Kt(0,"uint",!0),Kt.negint=new Kt(1,"negint",!0),Kt.bytes=new Kt(2,"bytes",!0),Kt.string=new Kt(3,"string",!0),Kt.array=new Kt(4,"array",!1),Kt.map=new Kt(5,"map",!1),Kt.tag=new Kt(6,"tag",!1),Kt.float=new Kt(7,"float",!0),Kt.false=new Kt(7,"false",!0),Kt.true=new Kt(7,"true",!0),Kt.null=new Kt(7,"null",!0),Kt.undefined=new Kt(7,"undefined",!0),Kt.break=new Kt(7,"break",!0);class Ft{constructor(t,e,r){this.type=t,this.value=e,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const qt=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"==typeof globalThis.Buffer.isBuffer,Ht=new TextDecoder,Gt=new TextEncoder;function Zt(t){return qt&&globalThis.Buffer.isBuffer(t)}function Yt(t){return t instanceof Uint8Array?Zt(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t:Uint8Array.from(t)}const Wt=qt?(t,e,r)=>r-e>64?globalThis.Buffer.from(t.subarray(e,r)).toString("utf8"):ne(t,e,r):(t,e,r)=>r-e>64?Ht.decode(t.subarray(e,r)):ne(t,e,r),Jt=qt?t=>t.length>64?globalThis.Buffer.from(t):re(t):t=>t.length>64?Gt.encode(t):re(t),Qt=t=>Uint8Array.from(t),Xt=qt?(t,e,r)=>Zt(t)?new Uint8Array(t.subarray(e,r)):t.slice(e,r):(t,e,r)=>t.slice(e,r),te=qt?(t,e)=>(t=t.map((t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t))),Yt(globalThis.Buffer.concat(t,e))):(t,e)=>{const r=new Uint8Array(e);let n=0;for(let e of t)n+e.length>r.length&&(e=e.subarray(0,r.length-n)),r.set(e,n),n+=e.length;return r},ee=qt?t=>globalThis.Buffer.allocUnsafe(t):t=>new Uint8Array(t);function re(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=63&i|128):55296==(64512&i)&&n+1<t.length&&56320==(64512&t.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++n)),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=63&i|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=63&i|128)}return e}function ne(t,e,r){const n=[];for(;e<r;){const i=t[e];let o=null,s=i>239?4:i>223?3:i>191?2:1;if(e+s<=r){let r,n,a,c;switch(s){case 1:i<128&&(o=i);break;case 2:r=t[e+1],128==(192&r)&&(c=(31&i)<<6|63&r,c>127&&(o=c));break;case 3:r=t[e+1],n=t[e+2],128==(192&r)&&128==(192&n)&&(c=(15&i)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:r=t[e+1],n=t[e+2],a=t[e+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&i)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),e+=s}return function(t){const e=t.length;if(e<=ie)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=ie));return r}(n)}const ie=4096;class oe{constructor(t=256){this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let e=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){const r=e.length-(this.maxCursor-this.cursor)-1;e.set(t,r)}else{if(e){const t=e.length-(this.maxCursor-this.cursor)-1;t<e.length&&(this.chunks[this.chunks.length-1]=e.subarray(0,t),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(e=ee(this.chunkSize),this.chunks.push(e),this.maxCursor+=e.length,null===this._initReuseChunk&&(this._initReuseChunk=e),e.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(t=!1){let e;if(1===this.chunks.length){const r=this.chunks[0];t&&this.cursor>r.length/2?(e=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):e=Xt(r,0,this.cursor)}else e=te(this.chunks,this.cursor);return t&&this.reset(),e}}const se="CBOR decode error:",ae="CBOR encode error:",ce=[];function ue(t,e,r){if(t.length-e<r)throw new Error(`${se} not enough data for type`)}ce[23]=1,ce[24]=2,ce[25]=3,ce[26]=5,ce[27]=9;const he=[24,256,65536,4294967296,BigInt("18446744073709551616")];function fe(t,e,r){ue(t,e,1);const n=t[e];if(!0===r.strict&&n<he[0])throw new Error(`${se} integer encoded in more bytes than necessary (strict decode)`);return n}function le(t,e,r){ue(t,e,2);const n=t[e]<<8|t[e+1];if(!0===r.strict&&n<he[1])throw new Error(`${se} integer encoded in more bytes than necessary (strict decode)`);return n}function de(t,e,r){ue(t,e,4);const n=16777216*t[e]+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];if(!0===r.strict&&n<he[2])throw new Error(`${se} integer encoded in more bytes than necessary (strict decode)`);return n}function ye(t,e,r){ue(t,e,8);const n=16777216*t[e]+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3],i=16777216*t[e+4]+(t[e+5]<<16)+(t[e+6]<<8)+t[e+7],o=(BigInt(n)<<BigInt(32))+BigInt(i);if(!0===r.strict&&o<he[3])throw new Error(`${se} integer encoded in more bytes than necessary (strict decode)`);if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(!0===r.allowBigInt)return o;throw new Error(`${se} integers outside of the safe integer range are not supported`)}function pe(t,e){return we(t,0,e.value)}function we(t,e,r){if(r<he[0]){const n=Number(r);t.push([e|n])}else if(r<he[1]){const n=Number(r);t.push([24|e,n])}else if(r<he[2]){const n=Number(r);t.push([25|e,n>>>8,255&n])}else if(r<he[3]){const n=Number(r);t.push([26|e,n>>>24&255,n>>>16&255,n>>>8&255,255&n])}else{const n=BigInt(r);if(!(n<he[4]))throw new Error(`${se} encountered BigInt larger than allowable range`);{const r=[27|e,0,0,0,0,0,0,0];let i=Number(n&BigInt(4294967295)),o=Number(n>>BigInt(32)&BigInt(4294967295));r[8]=255&i,i>>=8,r[7]=255&i,i>>=8,r[6]=255&i,i>>=8,r[5]=255&i,r[4]=255&o,o>>=8,r[3]=255&o,o>>=8,r[2]=255&o,o>>=8,r[1]=255&o,t.push(r)}}}pe.encodedSize=function(t){return we.encodedSize(t.value)},we.encodedSize=function(t){return t<he[0]?1:t<he[1]?2:t<he[2]?3:t<he[3]?5:9},pe.compareTokens=function(t,e){return t.value<e.value?-1:t.value>e.value?1:0};const ge=BigInt(-1),be=BigInt(1);function me(t,e){const r=e.value,n="bigint"==typeof r?r*ge-be:-1*r-1;we(t,e.type.majorEncoded,n)}function ve(t,e,r,n){ue(t,e,r+n);const i=Xt(t,e+r,e+r+n);return new Ft(Kt.bytes,i,r+n)}function Ee(t,e,r,n){return ve(t,e,1,r)}function xe(t){return void 0===t.encodedBytes&&(t.encodedBytes=t.type===Kt.string?Jt(t.value):t.value),t.encodedBytes}function Ae(t,e){const r=xe(e);we(t,e.type.majorEncoded,r.length),t.push(r)}function Se(t,e,r,n,i){const o=r+n;ue(t,e,o);const s=new Ft(Kt.string,Wt(t,e+r,e+o),o);return!0===i.retainStringBytes&&(s.byteValue=Xt(t,e+r,e+o)),s}function Ie(t,e,r,n){return Se(t,e,1,r,n)}me.encodedSize=function(t){const e=t.value,r="bigint"==typeof e?e*ge-be:-1*e-1;return r<he[0]?1:r<he[1]?2:r<he[2]?3:r<he[3]?5:9},me.compareTokens=function(t,e){return t.value<e.value?1:t.value>e.value?-1:0},Ae.encodedSize=function(t){const e=xe(t);return we.encodedSize(e.length)+e.length},Ae.compareTokens=function(t,e){return r=xe(t),n=xe(e),r.length<n.length?-1:r.length>n.length?1:function(t,e){if(Zt(t)&&Zt(e))return t.compare(e);for(let r=0;r<t.length;r++)if(t[r]!==e[r])return t[r]<e[r]?-1:1;return 0}(r,n);var r,n};const ke=Ae;function Be(t,e,r,n){return new Ft(Kt.array,n,r)}function Te(t,e,r,n){return Be(0,0,1,r)}function _e(t,e){we(t,Kt.array.majorEncoded,e.value)}function Ce(t,e,r,n){return new Ft(Kt.map,n,r)}function Le(t,e,r,n){return Ce(0,0,1,r)}function Ue(t,e){we(t,Kt.map.majorEncoded,e.value)}function Oe(t,e,r,n){return new Ft(Kt.tag,r,1)}function Ne(t,e){we(t,Kt.tag.majorEncoded,e.value)}_e.compareTokens=pe.compareTokens,_e.encodedSize=function(t){return we.encodedSize(t.value)},Ue.compareTokens=pe.compareTokens,Ue.encodedSize=function(t){return we.encodedSize(t.value)},Ne.compareTokens=pe.compareTokens,Ne.encodedSize=function(t){return we.encodedSize(t.value)};function Pe(t,e,r){if(r){if(!1===r.allowNaN&&Number.isNaN(t))throw new Error(`${se} NaN values are not supported`);if(!1===r.allowInfinity&&(t===1/0||t===-1/0))throw new Error(`${se} Infinity values are not supported`)}return new Ft(Kt.float,t,e)}function De(t,e,r){const n=e.value;if(!1===n)t.push([20|Kt.float.majorEncoded]);else if(!0===n)t.push([21|Kt.float.majorEncoded]);else if(null===n)t.push([22|Kt.float.majorEncoded]);else if(void 0===n)t.push([23|Kt.float.majorEncoded]);else{let e,o=!1;r&&!0===r.float64||(Me(n),e=ze(Ve,1),n===e||Number.isNaN(n)?(Ve[0]=249,t.push(Ve.slice(0,3)),o=!0):($e(n),e=Ke(Ve,1),n===e&&(Ve[0]=250,t.push(Ve.slice(0,5)),o=!0))),o||(i=n,je.setFloat64(0,i,!1),e=Fe(Ve,1),Ve[0]=251,t.push(Ve.slice(0,9)))}var i}De.encodedSize=function(t,e){const r=t.value;if(!1===r||!0===r||null==r)return 1;if(!e||!0!==e.float64){Me(r);let t=ze(Ve,1);if(r===t||Number.isNaN(r))return 3;if($e(r),t=Ke(Ve,1),r===t)return 5}return 9};const Re=new ArrayBuffer(9),je=new DataView(Re,1),Ve=new Uint8Array(Re,0);function Me(t){if(t===1/0)je.setUint16(0,31744,!1);else if(t===-1/0)je.setUint16(0,64512,!1);else if(Number.isNaN(t))je.setUint16(0,32256,!1);else{je.setFloat32(0,t);const e=je.getUint32(0),r=(2139095040&e)>>23,n=8388607&e;if(255===r)je.setUint16(0,31744,!1);else if(0===r)je.setUint16(0,(2147483648&t)>>16|n>>13,!1);else{const t=r-127;t<-24?je.setUint16(0,0):t<-14?je.setUint16(0,(2147483648&e)>>16|1<<24+t,!1):je.setUint16(0,(2147483648&e)>>16|t+15<<10|n>>13,!1)}}}function ze(t,e){if(t.length-e<2)throw new Error(`${se} not enough data for float16`);const r=(t[e]<<8)+t[e+1];if(31744===r)return 1/0;if(64512===r)return-1/0;if(32256===r)return NaN;const n=r>>10&31,i=1023&r;let o;return o=0===n?i*2**-24:31!==n?(i+1024)*2**(n-25):0===i?1/0:NaN,32768&r?-o:o}function $e(t){je.setFloat32(0,t,!1)}function Ke(t,e){if(t.length-e<4)throw new Error(`${se} not enough data for float32`);const r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,4).getFloat32(0,!1)}function Fe(t,e){if(t.length-e<8)throw new Error(`${se} not enough data for float64`);const r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,8).getFloat64(0,!1)}function qe(t,e,r){throw new Error(`${se} encountered invalid minor (${r}) for major ${t[e]>>>5}`)}function He(t){return()=>{throw new Error(`${se} ${t}`)}}De.compareTokens=pe.compareTokens;const Ge=[];for(let t=0;t<=23;t++)Ge[t]=qe;Ge[24]=function(t,e,r,n){return new Ft(Kt.uint,fe(t,e+1,n),2)},Ge[25]=function(t,e,r,n){return new Ft(Kt.uint,le(t,e+1,n),3)},Ge[26]=function(t,e,r,n){return new Ft(Kt.uint,de(t,e+1,n),5)},Ge[27]=function(t,e,r,n){return new Ft(Kt.uint,ye(t,e+1,n),9)},Ge[28]=qe,Ge[29]=qe,Ge[30]=qe,Ge[31]=qe;for(let t=32;t<=55;t++)Ge[t]=qe;Ge[56]=function(t,e,r,n){return new Ft(Kt.negint,-1-fe(t,e+1,n),2)},Ge[57]=function(t,e,r,n){return new Ft(Kt.negint,-1-le(t,e+1,n),3)},Ge[58]=function(t,e,r,n){return new Ft(Kt.negint,-1-de(t,e+1,n),5)},Ge[59]=function(t,e,r,n){const i=ye(t,e+1,n);if("bigint"!=typeof i){const t=-1-i;if(t>=Number.MIN_SAFE_INTEGER)return new Ft(Kt.negint,t,9)}if(!0!==n.allowBigInt)throw new Error(`${se} integers outside of the safe integer range are not supported`);return new Ft(Kt.negint,ge-BigInt(i),9)},Ge[60]=qe,Ge[61]=qe,Ge[62]=qe,Ge[63]=qe;for(let t=64;t<=87;t++)Ge[t]=Ee;Ge[88]=function(t,e,r,n){return ve(t,e,2,fe(t,e+1,n))},Ge[89]=function(t,e,r,n){return ve(t,e,3,le(t,e+1,n))},Ge[90]=function(t,e,r,n){return ve(t,e,5,de(t,e+1,n))},Ge[91]=function(t,e,r,n){const i=ye(t,e+1,n);if("bigint"==typeof i)throw new Error(`${se} 64-bit integer bytes lengths not supported`);return ve(t,e,9,i)},Ge[92]=qe,Ge[93]=qe,Ge[94]=qe,Ge[95]=He("indefinite length bytes/strings are not supported");for(let t=96;t<=119;t++)Ge[t]=Ie;Ge[120]=function(t,e,r,n){return Se(t,e,2,fe(t,e+1,n),n)},Ge[121]=function(t,e,r,n){return Se(t,e,3,le(t,e+1,n),n)},Ge[122]=function(t,e,r,n){return Se(t,e,5,de(t,e+1,n),n)},Ge[123]=function(t,e,r,n){const i=ye(t,e+1,n);if("bigint"==typeof i)throw new Error(`${se} 64-bit integer string lengths not supported`);return Se(t,e,9,i,n)},Ge[124]=qe,Ge[125]=qe,Ge[126]=qe,Ge[127]=He("indefinite length bytes/strings are not supported");for(let t=128;t<=151;t++)Ge[t]=Te;Ge[152]=function(t,e,r,n){return Be(0,0,2,fe(t,e+1,n))},Ge[153]=function(t,e,r,n){return Be(0,0,3,le(t,e+1,n))},Ge[154]=function(t,e,r,n){return Be(0,0,5,de(t,e+1,n))},Ge[155]=function(t,e,r,n){const i=ye(t,e+1,n);if("bigint"==typeof i)throw new Error(`${se} 64-bit integer array lengths not supported`);return Be(0,0,9,i)},Ge[156]=qe,Ge[157]=qe,Ge[158]=qe,Ge[159]=function(t,e,r,n){if(!1===n.allowIndefinite)throw new Error(`${se} indefinite length items not allowed`);return Be(0,0,1,1/0)};for(let t=160;t<=183;t++)Ge[t]=Le;Ge[184]=function(t,e,r,n){return Ce(0,0,2,fe(t,e+1,n))},Ge[185]=function(t,e,r,n){return Ce(0,0,3,le(t,e+1,n))},Ge[186]=function(t,e,r,n){return Ce(0,0,5,de(t,e+1,n))},Ge[187]=function(t,e,r,n){const i=ye(t,e+1,n);if("bigint"==typeof i)throw new Error(`${se} 64-bit integer map lengths not supported`);return Ce(0,0,9,i)},Ge[188]=qe,Ge[189]=qe,Ge[190]=qe,Ge[191]=function(t,e,r,n){if(!1===n.allowIndefinite)throw new Error(`${se} indefinite length items not allowed`);return Ce(0,0,1,1/0)};for(let t=192;t<=215;t++)Ge[t]=Oe;Ge[216]=function(t,e,r,n){return new Ft(Kt.tag,fe(t,e+1,n),2)},Ge[217]=function(t,e,r,n){return new Ft(Kt.tag,le(t,e+1,n),3)},Ge[218]=function(t,e,r,n){return new Ft(Kt.tag,de(t,e+1,n),5)},Ge[219]=function(t,e,r,n){return new Ft(Kt.tag,ye(t,e+1,n),9)},Ge[220]=qe,Ge[221]=qe,Ge[222]=qe,Ge[223]=qe;for(let t=224;t<=243;t++)Ge[t]=He("simple values are not supported");Ge[244]=qe,Ge[245]=qe,Ge[246]=qe,Ge[247]=function(t,e,r,n){if(!1===n.allowUndefined)throw new Error(`${se} undefined values are not supported`);return!0===n.coerceUndefinedToNull?new Ft(Kt.null,null,1):new Ft(Kt.undefined,void 0,1)},Ge[248]=He("simple values are not supported"),Ge[249]=function(t,e,r,n){return Pe(ze(t,e+1),3,n)},Ge[250]=function(t,e,r,n){return Pe(Ke(t,e+1),5,n)},Ge[251]=function(t,e,r,n){return Pe(Fe(t,e+1),9,n)},Ge[252]=qe,Ge[253]=qe,Ge[254]=qe,Ge[255]=function(t,e,r,n){if(!1===n.allowIndefinite)throw new Error(`${se} indefinite length items not allowed`);return new Ft(Kt.break,void 0,1)};const Ze=[];for(let t=0;t<24;t++)Ze[t]=new Ft(Kt.uint,t,1);for(let t=-1;t>=-24;t--)Ze[31-t]=new Ft(Kt.negint,t,1);Ze[64]=new Ft(Kt.bytes,new Uint8Array(0),1),Ze[96]=new Ft(Kt.string,"",1),Ze[128]=new Ft(Kt.array,0,1),Ze[160]=new Ft(Kt.map,0,1),Ze[244]=new Ft(Kt.false,!1,1),Ze[245]=new Ft(Kt.true,!0,1),Ze[246]=new Ft(Kt.null,null,1);const Ye={float64:!1,mapSorter:function(t,e){const r=Array.isArray(t[0])?t[0][0]:t[0],n=Array.isArray(e[0])?e[0][0]:e[0];if(r.type!==n.type)return r.type.compare(n.type);const i=r.type.major,o=We[i].compareTokens(r,n);return 0===o&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),o},quickEncodeToken:function(t){switch(t.type){case Kt.false:return Qt([244]);case Kt.true:return Qt([245]);case Kt.null:return Qt([246]);case Kt.bytes:return t.value.length?void 0:Qt([64]);case Kt.string:return""===t.value?Qt([96]):void 0;case Kt.array:return 0===t.value?Qt([128]):void 0;case Kt.map:return 0===t.value?Qt([160]):void 0;case Kt.uint:return t.value<24?Qt([Number(t.value)]):void 0;case Kt.negint:if(t.value>=-24)return Qt([31-Number(t.value)])}}},We=function(){const t=[];return t[Kt.uint.major]=pe,t[Kt.negint.major]=me,t[Kt.bytes.major]=Ae,t[Kt.string.major]=ke,t[Kt.array.major]=_e,t[Kt.map.major]=Ue,t[Kt.tag.major]=Ne,t[Kt.float.major]=De,t}(),Je=new oe;class Qe{constructor(t,e){this.obj=t,this.parent=e}includes(t){let e=this;do{if(e.obj===t)return!0}while(e=e.parent);return!1}static createCheck(t,e){if(t&&t.includes(e))throw new Error(`${ae} object contains circular references`);return new Qe(e,t)}}const Xe={null:new Ft(Kt.null,null),undefined:new Ft(Kt.undefined,void 0),true:new Ft(Kt.true,!0),false:new Ft(Kt.false,!1),emptyArray:new Ft(Kt.array,0),emptyMap:new Ft(Kt.map,0)},tr={number:(t,e,r,n)=>Number.isInteger(t)&&Number.isSafeInteger(t)?new Ft(t>=0?Kt.uint:Kt.negint,t):new Ft(Kt.float,t),bigint:(t,e,r,n)=>t>=BigInt(0)?new Ft(Kt.uint,t):new Ft(Kt.negint,t),Uint8Array:(t,e,r,n)=>new Ft(Kt.bytes,t),string:(t,e,r,n)=>new Ft(Kt.string,t),boolean:(t,e,r,n)=>t?Xe.true:Xe.false,null:(t,e,r,n)=>Xe.null,undefined:(t,e,r,n)=>Xe.undefined,ArrayBuffer:(t,e,r,n)=>new Ft(Kt.bytes,new Uint8Array(t)),DataView:(t,e,r,n)=>new Ft(Kt.bytes,new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),Array(t,e,r,n){if(!t.length)return!0===r.addBreakTokens?[Xe.emptyArray,new Ft(Kt.break)]:Xe.emptyArray;n=Qe.createCheck(n,t);const i=[];let o=0;for(const e of t)i[o++]=er(e,r,n);return r.addBreakTokens?[new Ft(Kt.array,t.length),i,new Ft(Kt.break)]:[new Ft(Kt.array,t.length),i]},Object(t,e,r,n){const i="Object"!==e,o=i?t.keys():Object.keys(t),s=i?t.size:o.length;if(!s)return!0===r.addBreakTokens?[Xe.emptyMap,new Ft(Kt.break)]:Xe.emptyMap;n=Qe.createCheck(n,t);const a=[];let c=0;for(const e of o)a[c++]=[er(e,r,n),er(i?t.get(e):t[e],r,n)];return function(t,e){e.mapSorter&&t.sort(e.mapSorter)}(a,r),r.addBreakTokens?[new Ft(Kt.map,s),a,new Ft(Kt.break)]:[new Ft(Kt.map,s),a]}};tr.Map=tr.Object,tr.Buffer=tr.Uint8Array;for(const t of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))tr[`${t}Array`]=tr.DataView;function er(t,e={},r){const n=function(t){if(null===t)return"null";if(void 0===t)return"undefined";if(!0===t||!1===t)return"boolean";const e=typeof t;if(zt.includes(e))return e;if("function"===e)return"Function";if(Array.isArray(t))return"Array";if(function(t){return t&&t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer.call(null,t)}(t))return"Buffer";return function(t){const e=Object.prototype.toString.call(t).slice(8,-1);if($t.includes(e))return e}(t)||"Object"}(t),i=e&&e.typeEncoders&&e.typeEncoders[n]||tr[n];if("function"==typeof i){const o=i(t,n,e,r);if(null!=o)return o}const o=tr[n];if(!o)throw new Error(`${ae} unsupported type: ${n}`);return o(t,n,e,r)}function rr(t,e,r,n){if(Array.isArray(e))for(const i of e)rr(t,i,r,n);else r[e.type.major](t,e,n)}function nr(t,e,r){const n=er(t,r);if(!Array.isArray(n)&&r.quickEncodeToken){const t=r.quickEncodeToken(n);if(t)return t;const i=e[n.type.major];if(i.encodedSize){const t=i.encodedSize(n,r),e=new oe(t);if(i(e,n,r),1!==e.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return Yt(e.chunks[0])}}return Je.reset(),rr(Je,n,e,r),Je.toBytes(!0)}const ir={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class or{constructor(t,e={}){this._pos=0,this.data=t,this.options=e}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const t=this.data[this._pos];let e=Ze[t];if(void 0===e){const r=Ge[t];if(!r)throw new Error(`${se} no decoder for major type ${t>>>5} (byte 0x${t.toString(16).padStart(2,"0")})`);const n=31&t;e=r(this.data,this._pos,n,this.options)}return this._pos+=e.encodedLength,e}}const sr=Symbol.for("DONE"),ar=Symbol.for("BREAK");function cr(t,e){if(t.done())return sr;const r=t.next();if(r.type===Kt.break)return ar;if(r.type.terminal)return r.value;if(r.type===Kt.array)return function(t,e,r){const n=[];for(let i=0;i<t.value;i++){const o=cr(e,r);if(o===ar){if(t.value===1/0)break;throw new Error(`${se} got unexpected break to lengthed array`)}if(o===sr)throw new Error(`${se} found array but not enough entries (got ${i}, expected ${t.value})`);n[i]=o}return n}(r,t,e);if(r.type===Kt.map)return function(t,e,r){const n=!0===r.useMaps,i=n?void 0:{},o=n?new Map:void 0;for(let s=0;s<t.value;s++){const a=cr(e,r);if(a===ar){if(t.value===1/0)break;throw new Error(`${se} got unexpected break to lengthed map`)}if(a===sr)throw new Error(`${se} found map but not enough entries (got ${s} [no key], expected ${t.value})`);if(!0!==n&&"string"!=typeof a)throw new Error(`${se} non-string keys not supported (got ${typeof a})`);if(!0===r.rejectDuplicateMapKeys&&(n&&o.has(a)||!n&&a in i))throw new Error(`${se} found repeat map key "${a}"`);const c=cr(e,r);if(c===sr)throw new Error(`${se} found map but not enough entries (got ${s} [no value], expected ${t.value})`);n?o.set(a,c):i[a]=c}return n?o:i}(r,t,e);if(r.type===Kt.tag){if(e.tags&&"function"==typeof e.tags[r.value]){const n=cr(t,e);return e.tags[r.value](n)}throw new Error(`${se} tag not supported (${r.value})`)}throw new Error("unsupported")}function ur(t,e){const[r,n]=function(t,e){if(!(t instanceof Uint8Array))throw new Error(`${se} data to decode must be a Uint8Array`);const r=(e=Object.assign({},ir,e)).tokenizer||new or(t,e),n=cr(r,e);if(n===sr)throw new Error(`${se} did not find any content to decode`);if(n===ar)throw new Error(`${se} got unexpected break`);return[n,t.subarray(r.pos())]}(t,e);if(n.length>0)throw new Error(`${se} too many terminals, data makes no sense`);return r}function hr(t){if(t instanceof Uint8Array&&"Uint8Array"===t.constructor.name)return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}new Uint8Array(0);const fr=function(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function f(t){if("string"!=typeof t)throw new TypeError("Expected String");if(0===t.length)return new Uint8Array;var e=0;if(" "!==t[e]){for(var n=0,i=0;t[e]===c;)n++,e++;for(var o=(t.length-e)*u+1>>>0,s=new Uint8Array(o);t[e];){var h=r[t.charCodeAt(e)];if(255===h)return;for(var f=0,l=o-1;(0!==h||f<i)&&-1!==l;l--,f++)h+=a*s[l]>>>0,s[l]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");i=f,e++}if(" "!==t[e]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var y=new Uint8Array(n+(o-d)),p=n;d!==o;)y[p++]=s[d++];return y}}}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,n=0,i=0,o=e.length;i!==o&&0===e[i];)i++,r++;for(var s=(o-i)*h+1>>>0,u=new Uint8Array(s);i!==o;){for(var f=e[i],l=0,d=s-1;(0!==f||l<n)&&-1!==d;d--,l++)f+=256*u[d]>>>0,u[d]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=l,i++}for(var y=s-n;y!==s&&0===u[y];)y++;for(var p=c.repeat(r);y<s;++y)p+=t.charAt(u[y]);return p},decodeUnsafe:f,decode:function(t){var r=f(t);if(r)return r;throw new Error(`Non-${e} character`)}}};class lr{name;prefix;baseEncode;constructor(t,e,r){this.name=t,this.prefix=e,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class dr{name;prefix;baseDecode;prefixCodePoint;constructor(t,e,r){if(this.name=t,this.prefix=e,void 0===e.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=r}decode(t){if("string"==typeof t){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(t){return pr(this,t)}}class yr{decoders;constructor(t){this.decoders=t}or(t){return pr(this,t)}decode(t){const e=t[0],r=this.decoders[e];if(null!=r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function pr(t,e){return new yr({...t.decoders??{[t.prefix]:t},...e.decoders??{[e.prefix]:e}})}class wr{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,e,r,n){this.name=t,this.prefix=e,this.baseEncode=r,this.baseDecode=n,this.encoder=new lr(t,e,r),this.decoder=new dr(t,e,n)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}function gr({name:t,prefix:e,encode:r,decode:n}){return new wr(t,e,r,n)}function br({name:t,prefix:e,alphabet:r}){const{encode:n,decode:i}=fr(r,t);return gr({prefix:e,name:t,encode:n,decode:t=>hr(i(t))})}function mr({name:t,prefix:e,bitsPerChar:r,alphabet:n}){return gr({prefix:e,name:t,encode:t=>function(t,e,r){const n="="===e[e.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<t.length;++n)for(a=a<<8|t[n],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(0!==s&&(o+=e[i&a<<r-s]),n)for(;0!=(o.length*r&7);)o+="=";return o}(t,n,r),decode:e=>function(t,e,r,n){const i={};for(let t=0;t<e.length;++t)i[e[t]]=t;let o=t.length;for(;"="===t[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,u=0;for(let e=0;e<o;++e){const o=i[t[e]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=r||0!=(255&c<<8-a))throw new SyntaxError("Unexpected end of data");return s}(e,n,r,t)})}const vr=mr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Er=(mr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),mr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),mr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),mr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),mr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),mr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),mr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),mr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),br({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}));br({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var xr=128,Ar=-128,Sr=Math.pow(2,31),Ir=128,kr=127,Br=Math.pow(2,7),Tr=Math.pow(2,14),_r=Math.pow(2,21),Cr=Math.pow(2,28),Lr=Math.pow(2,35),Ur=Math.pow(2,42),Or=Math.pow(2,49),Nr=Math.pow(2,56),Pr=Math.pow(2,63);const Dr={encode:function t(e,r,n){r=r||[];for(var i=n=n||0;e>=Sr;)r[n++]=255&e|xr,e/=128;for(;e&Ar;)r[n++]=255&e|xr,e>>>=7;return r[n]=0|e,t.bytes=n-i+1,r},decode:function t(e,r){var n,i=0,o=0,s=r=r||0,a=e.length;do{if(s>=a)throw t.bytes=0,new RangeError("Could not decode varint");n=e[s++],i+=o<28?(n&kr)<<o:(n&kr)*Math.pow(2,o),o+=7}while(n>=Ir);return t.bytes=s-r,i},encodingLength:function(t){return t<Br?1:t<Tr?2:t<_r?3:t<Cr?4:t<Lr?5:t<Ur?6:t<Or?7:t<Nr?8:t<Pr?9:10}};function Rr(t,e=0){return[Dr.decode(t,e),Dr.decode.bytes]}function jr(t,e,r=0){return Dr.encode(t,e,r),e}function Vr(t){return Dr.encodingLength(t)}class Mr{code;size;digest;bytes;constructor(t,e,r,n){this.code=t,this.size=e,this.digest=r,this.bytes=n}}function zr(t,e){const{bytes:r,version:n}=t;return 0===n?function(t,e,r){const{prefix:n}=r;if(n!==Er.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=e.get(n);if(null==i){const i=r.encode(t).slice(1);return e.set(n,i),i}return i}(r,Kr(t),e??Er.encoder):function(t,e,r){const{prefix:n}=r,i=e.get(n);if(null==i){const i=r.encode(t);return e.set(n,i),i}return i}(r,Kr(t),e??vr.encoder)}const $r=new WeakMap;function Kr(t){const e=$r.get(t);if(null==e){const e=new Map;return $r.set(t,e),e}return e}class Fr{code;version;multihash;bytes;"/";constructor(t,e,r,n){this.code=e,this.version=t,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:e}=this;if(t!==qr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==Hr)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Fr.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:e}=this.multihash,r=function(t,e){const r=e.byteLength,n=Vr(t),i=n+Vr(r),o=new Uint8Array(i+r);return jr(t,o,0),jr(r,o,n),o.set(e,i),new Mr(t,r,e,o)}(t,e);return Fr.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return Fr.equals(this,t)}static equals(t,e){const r=e;return null!=r&&t.code===r.code&&t.version===r.version&&function(t,e){if(t===e)return!0;{const r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&function(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}(t.bytes,r.bytes)}}(t.multihash,r.multihash)}toString(t){return zr(this,t)}toJSON(){return{"/":zr(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(null==t)return null;const e=t;if(e instanceof Fr)return e;if(null!=e["/"]&&e["/"]===e.bytes||e.asCID===e){const{version:t,code:r,multihash:n,bytes:i}=e;return new Fr(t,r,n,i??Gr(t,r,n.bytes))}if(!0===e[Zr]){const{version:t,multihash:r,code:n}=e,i=function(t){const e=hr(t),[r,n]=Rr(e),[i,o]=Rr(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Mr(r,i,s,e)}(r);return Fr.create(t,n,i)}return null}static create(t,e,r){if("number"!=typeof e)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:if(e!==qr)throw new Error(`Version 0 CID must use dag-pb (code: ${qr}) block encoding`);return new Fr(t,e,r,r.bytes);case 1:{const n=Gr(t,e,r.bytes);return new Fr(t,e,r,n)}default:throw new Error("Invalid version")}}static createV0(t){return Fr.create(0,qr,t)}static createV1(t,e){return Fr.create(1,t,e)}static decode(t){const[e,r]=Fr.decodeFirst(t);if(0!==r.length)throw new Error("Incorrect length");return e}static decodeFirst(t){const e=Fr.inspectBytes(t),r=e.size-e.multihashSize,n=hr(t.subarray(r,r+e.multihashSize));if(n.byteLength!==e.multihashSize)throw new Error("Incorrect length");const i=n.subarray(e.multihashSize-e.digestSize),o=new Mr(e.multihashCode,e.digestSize,i,n);return[0===e.version?Fr.createV0(o):Fr.createV1(e.codec,o),t.subarray(e.size)]}static inspectBytes(t){let e=0;const r=()=>{const[r,n]=Rr(t.subarray(e));return e+=n,r};let n=r(),i=qr;if(18===n?(n=0,e=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const o=e,s=r(),a=r(),c=e+a;return{version:n,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(t,e){const[r,n]=function(t,e){switch(t[0]){case"Q":{const r=e??Er;return[Er.prefix,r.decode(`${Er.prefix}${t}`)]}case Er.prefix:{const r=e??Er;return[Er.prefix,r.decode(t)]}case vr.prefix:{const r=e??vr;return[vr.prefix,r.decode(t)]}default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}(t,e),i=Fr.decode(n);if(0===i.version&&"Q"!==t[0])throw Error("Version 0 CID string must not include multibase prefix");return Kr(i).set(r,t),i}}const qr=112,Hr=18;function Gr(t,e,r){const n=Vr(t),i=n+Vr(e),o=new Uint8Array(i+r.byteLength);return jr(t,o,0),jr(e,o,n),o.set(r,i),o}const Zr=Symbol.for("@ipld/js-cid/CID");function Yr(t){return t instanceof ArrayBuffer?new Uint8Array(t,0,t.byteLength):t}const Wr={float64:!0,typeEncoders:{Object:function(t){if(t.asCID!==t&&t["/"]!==t.bytes)return null;const e=Fr.asCID(t);if(!e)return null;const r=new Uint8Array(e.bytes.byteLength+1);return r.set(e.bytes,1),[new Ft(Kt.tag,42),new Ft(Kt.bytes,r)]},undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}},Jr={...Wr,typeEncoders:{...Wr.typeEncoders}},Qr={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};Qr.tags[42]=function(t){if(0!==t[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return Fr.decode(t.subarray(1))};const Xr={...Qr,tags:Qr.tags.slice()},tn="dag-cbor",en=113,rn=t=>{return e=t,r=Wr,r=Object.assign({},Ye,r),nr(e,We,r);var e,r},nn=t=>ur(Yr(t),Qr),on=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),sn=Lt({name:"sha2-256",code:18,encode:on("SHA-256")}),an=(Lt({name:"sha2-512",code:19,encode:on("SHA-512")}),t),cn=sn,un=X,hn=t=>t&&void 0!==t.id&&void 0!==t.next&&void 0!==t.payload&&void 0!==t.v&&void 0!==t.clock&&void 0!==t.refs,fn={create:async(t,e,r,n,i=null,o=[],s=[])=>{if(null==t)throw new Error("Identity is required, cannot create entry");if(null==e)throw new Error("Entry requires an id");if(null==r)throw new Error("Entry requires a payload");if(null==o||!Array.isArray(o))throw new Error("'next' argument is not an array");let a;if(i=i||z(t.publicKey),n){const{bytes:t}=await Vt({value:r,codec:an,hasher:cn});a=await n(t)}const c={id:e,payload:a||r,next:o,refs:s,clock:i,v:2},{bytes:u}=await Vt({value:c,codec:an,hasher:cn}),h=await t.sign(t,u);return c.key=t.publicKey,c.identity=t.hash,c.sig=h,c.payload=r,n&&(c._payload=a),c},verify:async(t,e)=>{if(!t)throw new Error("Identities is required, cannot verify entry");if(!hn(e))throw new Error("Invalid Log entry");if(!e.key)throw new Error("Entry doesn't have a key");if(!e.sig)throw new Error("Entry doesn't have a signature");const r=Object.assign({},e),n={id:r.id,payload:r._payload||r.payload,next:r.next,refs:r.refs,clock:r.clock,v:r.v},{bytes:i}=await Vt({value:n,codec:an,hasher:cn});return t.verify(e.sig,e.key,i)},decode:async(t,e,r)=>{let n;if(e)try{const r=await Mt({bytes:t,codec:an,hasher:cn});t=await e(r.value),n=r.cid}catch(t){throw new Error("Could not decrypt entry")}const i=await Mt({bytes:t,codec:an,hasher:cn}),o=i.value;if(r)try{const t=await r(o.payload),{value:e}=await Mt({bytes:t,codec:an,hasher:cn});o._payload=o.payload,o.payload=e}catch(t){throw new Error("Could not decrypt payload")}n=n||i.cid;const s=n.toString(un);return{...o,hash:s}},encode:async(t,e,r)=>{const n=Object.assign({},t);r&&(n.payload=n._payload),delete n._payload,delete n.hash;let{cid:i,bytes:o}=await Vt({value:n,codec:an,hasher:cn});if(e){o=await e(o);const t=await Vt({value:o,codec:an,hasher:cn});i=t.cid,o=t.bytes}return{hash:i.toString(un),bytes:o}},isEntry:hn,isEqual:(t,e)=>t&&e&&t.hash&&t.hash===e.hash};function ln(t,e,r){const n=((t,e)=>{const r=t.time-e.time;return 0===r&&t.id!==e.id?t.id<e.id?-1:1:r})(t.clock,e.clock);return 0===n?r(t,e):n}function dn(t,e,r){return t.clock.id===e.clock.id?r(t,e):t.clock.id<e.clock.id?-1:1}const yn={SortByClocks:ln,SortByClockId:dn,LastWriteWins:function(t,e){const r=(t,e)=>t,n=(t,e)=>dn(t,e,r);return((t,e)=>ln(t,e,n))(t,e)},NoZeroes:function(t){const e=`Your log's tiebreaker function, ${t.name}, has returned zero and therefore cannot be`;return(r,n)=>{const i=t(r,n);if(0===i)throw Error(e);return i}}},pn=async()=>{let t={};const e=async(e,r)=>{t[e]=r};return{put:e,del:async e=>{delete t[e]},get:async e=>t[e],iterator:async function*(){for await(const[e,r]of Object.entries(t))yield[e,r]},merge:async t=>{if(t)for await(const[r,n]of t.iterator())e(r,n)},clear:async()=>{t={}},close:async()=>{}}},wn=pn,gn=t=>{t=new Set(t);const e={};for(const r of t)for(const t of r.next)e[t]=r.hash;const r=[];for(const n of t)e[n.hash]||r.push(n);return r},bn=pn,mn=async({logHeads:t,entryStorage:e,headsStorage:r,indexStorage:n,encryption:i})=>{const o=i?.replication?.encrypt,s=i?.replication?.decrypt,a=i?.data?.encrypt,c=i?.data?.decrypt,u=e||await bn(),h=n||await bn();r=r||await bn();const f=await(async({storage:t,heads:e,decryptPayloadFn:r,decryptEntryFn:n})=>{t=t||await wn();const i=new TextEncoder,o=new TextDecoder,s=async e=>{const r=(e=gn(e)).map((t=>({hash:t.hash,next:t.next}))),n=i.encode(JSON.stringify(r));await t.put("heads",n)},a=async function*(){const e=await t.get("heads"),r=e?JSON.parse(o.decode(e)):[];for(const t of r)yield t},c=async()=>{const t=[];for await(const e of a())t.push(e);return t};return e&&await s(e),{put:s,set:s,add:async t=>{const e=await c();if(e.find((e=>fn.isEqual(e,t))))return;const r=gn([...e,t]);return await s(r),r},remove:async t=>{const e=(await c()).filter((e=>e.hash!==t));await s(e)},iterator:a,all:c,clear:async()=>{await t.clear()},close:async()=>{await t.close()}}})({storage:r,heads:t,decryptPayloadFn:c,decryptEntryFn:s}),l=async t=>{const e=await u.get(t);if(e)return await fn.decode(e,s,c)};return{get:l,getBytes:async t=>u.get(t),has:async t=>null!=await h.get(t),heads:async()=>{const t=[];for(const{hash:e}of await f.all()){const r=await l(e);t.push(r)}return t},setHead:async t=>{const{hash:e,bytes:r}=await fn.encode(t,o,a);return await u.put(e,r),await h.put(e,!0),await f.set([{hash:e,next:t.next}]),e},addHead:async t=>(await f.add(t),t.hash),removeHeads:async t=>{for(const e of t)await f.remove(e)},addVerified:async t=>{for(const e of t)await h.put(e,!0),u.persist&&await u.persist(e)},storage:u,clear:async()=>{await h.clear(),await f.clear(),await u.clear()},close:async()=>{await h.close(),await f.close(),await u.close()}}},{LastWriteWins:vn,NoZeroes:En}=yn,xn=(t,e)=>Math.max(t,e.clock.time),An=async()=>({canAppend:async t=>!0}),Sn=async(t,{logId:e,logHeads:r,access:n,entryStorage:i,headsStorage:o,indexStorage:s,sortFn:a,encryption:c}={})=>{if(null==t)throw new Error("Identity is required");if(null!=r&&!Array.isArray(r))throw new Error("'logHeads' argument must be an array");const u=e||(new Date).getTime().toString();c=c||{};const h=c.data?.encrypt;n=n||await An();const f=await mn({logHeads:r,entryStorage:i,indexStorage:s,headsStorage:o,encryption:c});a=En(a||vn);const l=new I({concurrency:1}),d=new I({concurrency:1}),y=async()=>{const e=Math.max(0,(await p()).reduce(xn,0));return z(t.publicKey,e)},p=async()=>(await f.heads()).sort(a).reverse(),w=async()=>{const t=[];for await(const e of v())t.unshift(e);return t},g=async t=>{if(!t)throw new Error("hash is required");return f.get(t)},b=async t=>f.has(t),m=async e=>d.add((async()=>{if(await b(e.hash))return!1;const r=async e=>{if(e.id!==u)throw new Error(`Entry's id (${e.id}) doesn't match the log's id (${u}).`);if(!await n.canAppend(e))throw new Error(`Could not append entry:\nKey "${e.identity}" is not allowed to write to the log`);if(!await fn.verify(t,e))throw new Error(`Could not validate signature for entry "${e.hash}"`)};await r(e);const i=(await p()).map((t=>t.hash)),o=new Set([e.hash]),s=new Set([...e.next,...e.refs]),a=new Set,c=async()=>{const t=Array.from(s.values()).filter(b).map(g),e=await Promise.all(t);for(const t of e){s.delete(t.hash),await r(t),o.add(t.hash);for(const e of[...t.next,...t.refs])await b(e)||o.has(e)?i.includes(e)&&a.add(e):s.add(e)}s.size>0&&await c()};return await c(),await f.addVerified(o.values()),await f.removeHeads(a.values()),await f.addHead(e),!0})),v=async function*(t,e){e=e||(()=>!1);let r=(t=t||await p()).sort(a);const n={};let i=[];const o={},s=t=>!(n[t]||o[t]);let c;for(;r.length>0;)if(r=r.sort(a),c=r.pop(),c){const{hash:t,next:a}=c;if(!n[t]){if(yield c,!0===await e(c))break;n[t]=!0,o[t]=!0,i=[...i,...a].filter(s);const u=t=>{if(!n[t]&&!o[t])return o[t]=!0,g(t)},h=await Promise.all(i.map(u));i=h.filter((t=>null!=t)).reduce(((t,e)=>Array.from(new Set([...t,...e.next]))),[]).filter(s),r=[...h,...r]}}};return{id:u,clock:y,heads:p,values:w,all:w,get:g,has:b,append:async(e,r={referencesCount:0})=>l.add((async()=>{const i=await p(),o=i.map((t=>t.hash)),s=await(async(t,e=0)=>{let r=[];const n=async t=>r.length>=e&&-1!==e;for await(const{hash:e}of v(t,n))r.push(e);return r=r.slice(t.length+1,e),r})(i,r.referencesCount+i.length),a=await fn.create(t,u,e,h,(t=>z(t.id,++t.time))(await y()),o,s);if(!await n.canAppend(a))throw new Error(`Could not append entry:\nKey "${t.hash}" is not allowed to write to the log`);const c=await f.setHead(a);return{...a,hash:c}})),join:async t=>{if(!t)throw new Error("Log instance not defined");if(!(e=t)||void 0===e.id||void 0===e.clock||void 0===e.heads||void 0===e.values||void 0===e.access||void 0===e.identity||void 0===e.storage)throw new Error("Given argument is not an instance of Log");var e;await f.storage.merge(t.storage);const r=await t.heads();for(const t of r)await m(t)},joinEntry:m,traverse:v,iterator:async function*({amount:t=-1,gt:e,gte:r,lt:n,lte:i}={}){if(0===t)return;if("string"==typeof i&&(i=[await g(i)]),"string"==typeof n){const t=await g(n);n=await Promise.all(t.next.map((t=>g(t))))}if(null!=n&&!Array.isArray(n))throw new Error("lt must be a string or an array of Entries");if(null!=i&&!Array.isArray(i))throw new Error("lte must be a string or an array of Entries");const o=(n||i||await p()).filter((t=>null!=t)),s=e||r?await g(e||r):null,a=s||-1===t?-1:t;let c=0;const u=s&&-1!==t&&!n&&!i,h=u?new M(t+2):null;let f=0;const l=v(o,(async t=>(c++,!!t&&(c>=a&&-1!==a||!(!s||!fn.isEqual(t,s))))));for await(const t of l){const r=n&&fn.isEqual(t,o),i=e&&fn.isEqual(t,s);r||i||(u?h.set(f++,t.hash):yield t)}if(u){const e=h.keys.length,r=e>t?e-t:0,n=h.keys.slice(r,e);for(const t of n){const e=h.get(t),r=await g(e);yield r}}},clear:async()=>{await l.clear(),await d.clear(),await f.clear()},close:async()=>{await l.onIdle(),await d.onIdle(),await f.close()},access:n,identity:t,storage:f.storage,encryption:c}},In=async(t,e)=>({put:async(r,n)=>{await t.put(r,n),await e.put(r,n)},get:async r=>{let n=await t.get(r);return n||(n=await e.get(r),n&&await t.put(r,n)),n},del:async r=>{await t.del(r),await e.del(r)},persist:async r=>{t.persist&&await t.persist(r),e.persist&&await e.persist(r)},iterator:async function*({amount:r,reverse:n}={}){const i=[],o={amount:r||-1,reverse:n||!1};for(const r of[t,e])for await(const[t,e]of r.iterator(o))i[t]||(i[t]=!0,yield[t,e])},merge:async r=>{await t.merge(r),await e.merge(r),await r.merge(t),await r.merge(e)},clear:async()=>{await t.clear(),await e.clear()},close:async()=>{await t.close(),await e.close()}}),kn=async({ipfs:t,pin:e,timeout:r}={})=>{if(!t)throw new Error("An instance of ipfs is required.");const n=new Set,i=async r=>{const n=At.parse(r,X);e&&!await t.pins.isPinned(n)&&await function(t){if(null!=t[Symbol.asyncIterator])return(async()=>{for await(const e of t);})();for(const e of t);}(t.pins.add(n))};return{put:async(e,n)=>{const o=At.parse(e,X),{signal:s}=new R.TimeoutController(r||3e4);await t.blockstore.put(o,n,{signal:s}),await i(e)},del:async t=>{},get:async e=>{const i=At.parse(e,X),o=new R.TimeoutController(r||3e4);n.add(o);const s=await t.blockstore.get(i,{signal:o.signal});if(n.delete(o),s)return s},persist:i,iterator:async function*(){},merge:async t=>{},clear:async()=>{},close:async()=>{for(const t in n)t.abort();n.clear()}}};var Bn=r(301);const Tn=async({path:t,valueEncoding:e}={})=>{t=t||"./level",e=e||"view";const r=new Bn.Level(t,{valueEncoding:e,passive:!0});return await r.open(),{put:async(t,e)=>{await r.put(t,e)},del:async t=>{await r.del(t)},get:async t=>{try{const e=await r.get(t);if(e)return e}catch(t){}},iterator:async function*({amount:t,reverse:e}={}){const n={limit:t||-1,reverse:e||!1};for await(const[t,e]of r.iterator(n))yield[t,e]},merge:async t=>{},clear:async()=>{await r.clear()},close:async()=>{await r.close()}}},_n=1e6,Cn=async({size:t}={})=>{let e=new M(t||_n);return{put:async(t,r)=>{e.set(t,r)},del:async t=>{e.remove(t)},get:async t=>e.get(t),iterator:async function*(){for await(const t of e.keys){const r=e.get(t);yield[t,r]}},merge:async t=>{if(t)for await(const[r,n]of t.iterator())e.set(r,n)},clear:async()=>{e=new M(t||_n)},close:async()=>{}}},Ln=1e3,Un=async({ipfs:t,identity:e,address:r,name:n,access:i,directory:o,meta:s,headsStorage:a,entryStorage:c,indexStorage:u,referencesCount:h,syncAutomatically:f,onUpdate:l,encryption:d})=>{o=V(o||"./orbitdb",`./${r}/`),s=s||{},h=Number(h)>-1?h:16,c=c||await In(await Cn({size:Ln}),await kn({ipfs:t,pin:!0})),a=a||await In(await Cn({size:Ln}),await Tn({path:V(o,"/log/_heads/")})),u=u||await In(await Cn({size:Ln}),await Tn({path:V(o,"/log/_index/")})),d=d||{};const y=await Sn(e,{logId:r,access:i,entryStorage:c,headsStorage:a,indexStorage:u,encryption:d}),p=new b.EventEmitter,w=new I({concurrency:1}),g=await(async({ipfs:t,log:e,events:r,onSynced:n,start:i,timeout:o})=>{if(!t)throw new Error("An instance of ipfs is required.");if(!e)throw new Error("An instance of log is required.");const s=t.libp2p,a=t.libp2p.services.pubsub,c=e.id,u=V("/orbitdb/heads/",c),h=new I({concurrency:1}),f=new Set;r=r||new b.EventEmitter,o??=3e4;let l=!1;const d=t=>async function*(){const t=await e.heads();for await(const{hash:r}of t){const t=await e.storage.get(r);yield t}}(),y=t=>async i=>{for await(const t of i){const r=t.subarray();if(r&&n){const t=await fn.decode(r,e.encryption.replication?.decrypt,e.encryption.data?.decrypt);await n(t)}}l&&await(async t=>{const n=await e.heads();r.emit("join",t,n)})(t)},p=async({connection:t,stream:e})=>{const n=String(t.remotePeer);try{f.add(n),await L(e,y(n),d,e)}catch(t){f.delete(n),r.emit("error",t)}},w=async t=>{h.add((async()=>{const{peerId:e,subscriptions:n}=t.detail,i=String(e),a=n.find((t=>t.topic===c));if(a)if(a.subscribe){if(f.has(i))return;const t=new R.TimeoutController(o),{signal:n}=t;try{f.add(i);const t=await s.dialProtocol(e,u,{signal:n});await L(d,t,y(i))}catch(t){f.delete(i),"UnsupportedProtocolError"===t.name||r.emit("error",t)}finally{t&&t.clear()}}else f.delete(i),r.emit("leave",i)}))},g=async t=>{const{topic:i,data:o}=t.detail;i===c&&h.add((async()=>{try{if(o&&n){const t=await fn.decode(o,e.encryption.replication?.decrypt,e.encryption.data?.decrypt);await n(t)}}catch(t){r.emit("error",t)}}))},m=async t=>{f.delete(t.detail.toString())},v=async()=>{l||(a.addEventListener("subscription-change",w),a.addEventListener("message",g),await a.subscribe(c),await s.handle(u,p),s.addEventListener("peer:disconnect",m),l=!0)};return!1!==i&&await v(),{add:async t=>{if(l&&t&&t.hash){const r=await e.storage.get(t.hash);await a.publish(c,r)}},stop:async()=>{l&&(l=!1,await h.clear(),a.removeEventListener("subscription-change",w),a.removeEventListener("message",g),await s.unhandle(u),await a.unsubscribe(c),s.removeEventListener("peer:disconnect",m),f.clear())},start:v,events:r,peers:f}})({ipfs:t,log:y,events:p,onSynced:async t=>{await w.add((async()=>{try{t&&await y.joinEntry(t)&&(l&&await l(y,t),p.emit("update",t))}catch(t){console.error(t)}}))},start:f});return{address:r,name:n,identity:e,meta:s,close:async()=>{await g.stop(),await w.onIdle(),await y.close(),i&&i.close&&await i.close(),p.emit("close")},drop:async()=>{await w.clear(),await y.clear(),i&&i.drop&&await i.drop(),p.emit("drop")},addOperation:async t=>await w.add((async()=>{const e=await y.append(t,{referencesCount:h});return await g.add(e),l&&await l(y,e),p.emit("update",e),e.hash})),log:y,sync:g,peers:g.peers,events:p,access:i}},On="documents",Nn={indexBy:"_id"},Pn=({indexBy:t}=Nn)=>async({ipfs:e,identity:r,address:n,name:i,access:o,directory:s,meta:a,headsStorage:c,entryStorage:u,indexStorage:h,referencesCount:f,syncAutomatically:l,onUpdate:d,encrypt:y})=>{const p=await Un({ipfs:e,identity:r,address:n,name:i,access:o,directory:s,meta:a,headsStorage:c,entryStorage:u,indexStorage:h,referencesCount:f,syncAutomatically:l,encrypt:y}),{addOperation:w,log:g}=p,b=async t=>{for await(const e of m())if(t===e.key)return e},m=async function*({amount:t}={}){const e={};let r=0;for await(const n of g.iterator()){const{op:i,key:o,value:s}=n.payload;if("PUT"!==i||e[o])"DEL"!==i||e[o]||(e[o]=!0);else{e[o]=!0,r++;const t=n.hash;yield{hash:t,key:o,value:s}}if(r>=t)break}};return{...p,type:On,put:async e=>{const r=e[t];if(!r)throw new Error(`The provided document doesn't contain field '${t}'`);return w({op:"PUT",key:r,value:e})},del:async t=>{if(!await b(t))throw new Error(`No document with key '${t}' in the database`);return w({op:"DEL",key:t,value:null})},get:b,iterator:m,query:async t=>{const e=[];for await(const r of m())t(r.value)&&e.push(r.value);return e},indexBy:t,all:async()=>{const t=[];for await(const e of m())t.unshift(e);return t}}};Pn.type=On;const Dn=Pn,Rn="events",jn=()=>async({ipfs:t,identity:e,address:r,name:n,access:i,directory:o,meta:s,headsStorage:a,entryStorage:c,indexStorage:u,referencesCount:h,syncAutomatically:f,onUpdate:l,encryption:d})=>{const y=await Un({ipfs:t,identity:e,address:r,name:n,access:i,directory:o,meta:s,headsStorage:a,entryStorage:c,indexStorage:u,referencesCount:h,syncAutomatically:f,onUpdate:l,encryption:d}),{addOperation:p,log:w}=y,g=async function*({gt:t,gte:e,lt:r,lte:n,amount:i}={}){const o=w.iterator({gt:t,gte:e,lt:r,lte:n,amount:i});for await(const t of o){const e=t.hash,r=t.payload.value;yield{hash:e,value:r}}};return{...y,type:Rn,add:async t=>p({op:"ADD",key:null,value:t}),get:async t=>(await w.get(t)).payload.value,iterator:g,all:async()=>{const t=[];for await(const e of g())t.unshift(e);return t}}};jn.type=Rn;const Vn=jn,Mn="keyvalue",zn=()=>async({ipfs:t,identity:e,address:r,name:n,access:i,directory:o,meta:s,headsStorage:a,entryStorage:c,indexStorage:u,referencesCount:h,syncAutomatically:f,onUpdate:l,encryption:d})=>{const y=await Un({ipfs:t,identity:e,address:r,name:n,access:i,directory:o,meta:s,headsStorage:a,entryStorage:c,indexStorage:u,referencesCount:h,syncAutomatically:f,onUpdate:l,encryption:d}),{addOperation:p,log:w}=y,g=async(t,e)=>p({op:"PUT",key:t,value:e}),b=async function*({amount:t}={}){const e={};let r=0;for await(const n of w.traverse()){const{op:i,key:o,value:s}=n.payload;if("PUT"!==i||e[o])"DEL"!==i||e[o]||(e[o]=!0);else{e[o]=!0,r++;const t=n.hash;yield{key:o,value:s,hash:t}}if(r>=t)break}};return{...y,type:Mn,put:g,set:g,del:async t=>p({op:"DEL",key:t,value:null}),get:async t=>{for await(const e of w.traverse()){const{op:r,key:n,value:i}=e.payload;if("PUT"===r&&n===t)return i;if("DEL"===r&&n===t)return}},iterator:b,all:async()=>{const t=[];for await(const e of b())t.unshift(e);return t}}};zn.type=Mn;const $n=zn,Kn="json",Fn=()=>async({ipfs:t,identity:e,address:r,name:n,access:i,directory:o,meta:s,headsStorage:a,entryStorage:c,indexStorage:u,referencesCount:h,syncAutomatically:f,onUpdate:l,encryption:d})=>{o=V(o||"./orbitdb",`./${r}/_index/`);const y=await(({directory:t}={})=>async()=>{const e=await Tn({path:t,valueEncoding:Kn}),r=await Tn({path:V(t,"/_indexedEntries/"),valueEncoding:Kn});return{get:e.get,iterator:e.iterator,update:async(t,n)=>{const i=new Set,o=new Set,s=n.hash,a=async t=>!0===await r.get(t),c=async t=>!await a(t),u=async t=>{for await(const e of t.next)await c(e)&&o.add(e);return await a(s)&&0===o.size};for await(const n of t.traverse(null,u)){const{hash:t,payload:s}=n;if(await c(t)){const{op:a,key:c}=s;"PUT"!==a||i.has(c)?"DEL"!==a||i.has(c)||(i.add(c),await e.del(c),await r.put(t,!0)):(i.add(c),await e.put(c,n),await r.put(t,!0)),o.delete(t)}}},close:async()=>{await e.close(),await r.close()},drop:async()=>{await e.clear(),await r.clear()}}})({directory:o})(),p=await $n()({ipfs:t,identity:e,address:r,name:n,access:i,directory:o,meta:s,headsStorage:a,entryStorage:c,indexStorage:u,referencesCount:h,syncAutomatically:f,onUpdate:y.update,encryption:d});return{...p,get:async t=>{const e=await y.get(t);if(e)return e.payload.value},iterator:async function*({amount:t}={}){const e=y.iterator({amount:t,reverse:!0});for await(const t of e){const e=t[1],{key:r,value:n}=e.payload,i=e.hash;yield{key:r,value:n,hash:i}}},close:async()=>{await p.close(),await y.close()},drop:async()=>{await p.drop(),await y.drop()}}};Fn.type="keyvalue";const qn=Fn,Hn={},Gn=t=>{if(!t.type)throw new Error("Database type does not contain required field 'type'.");Hn[t.type]=t};Gn(Vn),Gn(Dn),Gn($n);class Zn extends Error{static name="InvalidParametersError";constructor(t="Invalid parameters"){super(t),this.name="InvalidParametersError"}}class Yn extends Error{static name="InvalidPublicKeyError";constructor(t="Invalid public key"){super(t),this.name="InvalidPublicKeyError"}}class Wn extends Error{static name="InvalidPrivateKeyError";constructor(t="Invalid private key"){super(t),this.name="InvalidPrivateKeyError"}}class Jn extends Error{static name="UnsupportedKeyTypeError";constructor(t="Unsupported key type"){super(t),this.name="UnsupportedKeyTypeError"}}const Qn="1.2.840.10045.3.1.7",Xn="1.3.132.0.34",ti="1.3.132.0.35";function ei(t=0){return new Uint8Array(t)}function ri(t=0){return new Uint8Array(t)}function ni(t,e){null==e&&(e=t.reduce(((t,e)=>t+e.length),0));const r=ri(e);let n=0;for(const e of t)r.set(e,n),n+=e.length;return r}function ii(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}const oi=Symbol.for("@achingbrain/uint8arraylist");function si(t,e){if(null==e||e<0)throw new RangeError("index is out of bounds");let r=0;for(const n of t){const t=r+n.byteLength;if(e<t)return{buf:n,index:e-r};r=t}throw new RangeError("index is out of bounds")}function ai(t){return Boolean(t?.[oi])}class ci{bufs;length;[oi]=!0;constructor(...t){this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let e=0;for(const r of t)if(r instanceof Uint8Array)e+=r.byteLength,this.bufs.push(r);else{if(!ai(r))throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");e+=r.byteLength,this.bufs.push(...r.bufs)}this.length+=e}prepend(...t){this.prependAll(t)}prependAll(t){let e=0;for(const r of t.reverse())if(r instanceof Uint8Array)e+=r.byteLength,this.bufs.unshift(r);else{if(!ai(r))throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");e+=r.byteLength,this.bufs.unshift(...r.bufs)}this.length+=e}get(t){const e=si(this.bufs,t);return e.buf[e.index]}set(t,e){const r=si(this.bufs,t);r.buf[r.index]=e}write(t,e=0){if(t instanceof Uint8Array)for(let r=0;r<t.length;r++)this.set(e+r,t[r]);else{if(!ai(t))throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList");for(let r=0;r<t.length;r++)this.set(e+r,t.get(r))}}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength)return this.bufs=[],void(this.length=0);for(;this.bufs.length>0;){if(!(t>=this.bufs[0].byteLength)){this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift()}}}slice(t,e){const{bufs:r,length:n}=this._subList(t,e);return ni(r,n)}subarray(t,e){const{bufs:r,length:n}=this._subList(t,e);return 1===r.length?r[0]:ni(r,n)}sublist(t,e){const{bufs:r,length:n}=this._subList(t,e),i=new ci;return i.length=n,i.bufs=[...r],i}_subList(t,e){if(t=t??0,e=e??this.length,t<0&&(t=this.length+t),e<0&&(e=this.length+e),t<0||e>this.length)throw new RangeError("index is out of bounds");if(t===e)return{bufs:[],length:0};if(0===t&&e===this.length)return{bufs:this.bufs,length:this.length};const r=[];let n=0;for(let i=0;i<this.bufs.length;i++){const o=this.bufs[i],s=n,a=s+o.byteLength;if(n=a,t>=a)continue;const c=t>=s&&t<a,u=e>s&&e<=a;if(c&&u){if(t===s&&e===a){r.push(o);break}const n=t-s;r.push(o.subarray(n,n+(e-t)));break}if(c){if(0===t){r.push(o);continue}r.push(o.subarray(t-s))}else{if(u){if(e===a){r.push(o);break}r.push(o.subarray(0,e-s));break}r.push(o)}}return{bufs:r,length:e-t}}indexOf(t,e=0){if(!(ai(t)||t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');const r=t instanceof Uint8Array?t:t.subarray();if(e=Number(e??0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),0===t.length)return e>this.length?this.length:e;const n=r.byteLength;if(0===n)throw new TypeError("search must be at least 1 byte long");const i=new Int32Array(256);for(let t=0;t<256;t++)i[t]=-1;for(let t=0;t<n;t++)i[r[t]]=t;const o=i,s=this.byteLength-r.byteLength,a=r.byteLength-1;let c;for(let t=e;t<=s;t+=c){c=0;for(let e=a;e>=0;e--){const n=this.get(t+e);if(r[e]!==n){c=Math.max(1,e-o[n]);break}}if(0===c)return t}return-1}getInt8(t){const e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getInt8(0)}setInt8(t,e){const r=ri(1);new DataView(r.buffer,r.byteOffset,r.byteLength).setInt8(0,e),this.write(r,t)}getInt16(t,e){const r=this.subarray(t,t+2);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt16(0,e)}setInt16(t,e,r){const n=ei(2);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt16(0,e,r),this.write(n,t)}getInt32(t,e){const r=this.subarray(t,t+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt32(0,e)}setInt32(t,e,r){const n=ei(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt32(0,e,r),this.write(n,t)}getBigInt64(t,e){const r=this.subarray(t,t+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getBigInt64(0,e)}setBigInt64(t,e,r){const n=ei(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setBigInt64(0,e,r),this.write(n,t)}getUint8(t){const e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0)}setUint8(t,e){const r=ri(1);new DataView(r.buffer,r.byteOffset,r.byteLength).setUint8(0,e),this.write(r,t)}getUint16(t,e){const r=this.subarray(t,t+2);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint16(0,e)}setUint16(t,e,r){const n=ei(2);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint16(0,e,r),this.write(n,t)}getUint32(t,e){const r=this.subarray(t,t+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint32(0,e)}setUint32(t,e,r){const n=ei(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(0,e,r),this.write(n,t)}getBigUint64(t,e){const r=this.subarray(t,t+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getBigUint64(0,e)}setBigUint64(t,e,r){const n=ei(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setBigUint64(0,e,r),this.write(n,t)}getFloat32(t,e){const r=this.subarray(t,t+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getFloat32(0,e)}setFloat32(t,e,r){const n=ei(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setFloat32(0,e,r),this.write(n,t)}getFloat64(t,e){const r=this.subarray(t,t+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getFloat64(0,e)}setFloat64(t,e,r){const n=ei(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setFloat64(0,e,r),this.write(n,t)}equals(t){if(null==t)return!1;if(!(t instanceof ci))return!1;if(t.bufs.length!==this.bufs.length)return!1;for(let e=0;e<this.bufs.length;e++)if(!ii(this.bufs[e],t.bufs[e]))return!1;return!0}static fromUint8Arrays(t,e){const r=new ci;return r.bufs=t,null==e&&(e=t.reduce(((t,e)=>t+e.byteLength),0)),r.length=e,r}}function ui(t){if(t instanceof Uint8Array&&"Uint8Array"===t.constructor.name)return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}new Uint8Array(0);const hi=function(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function f(t){if("string"!=typeof t)throw new TypeError("Expected String");if(0===t.length)return new Uint8Array;var e=0;if(" "!==t[e]){for(var n=0,i=0;t[e]===c;)n++,e++;for(var o=(t.length-e)*u+1>>>0,s=new Uint8Array(o);t[e];){var h=r[t.charCodeAt(e)];if(255===h)return;for(var f=0,l=o-1;(0!==h||f<i)&&-1!==l;l--,f++)h+=a*s[l]>>>0,s[l]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");i=f,e++}if(" "!==t[e]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var y=new Uint8Array(n+(o-d)),p=n;d!==o;)y[p++]=s[d++];return y}}}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,n=0,i=0,o=e.length;i!==o&&0===e[i];)i++,r++;for(var s=(o-i)*h+1>>>0,u=new Uint8Array(s);i!==o;){for(var f=e[i],l=0,d=s-1;(0!==f||l<n)&&-1!==d;d--,l++)f+=256*u[d]>>>0,u[d]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=l,i++}for(var y=s-n;y!==s&&0===u[y];)y++;for(var p=c.repeat(r);y<s;++y)p+=t.charAt(u[y]);return p},decodeUnsafe:f,decode:function(t){var r=f(t);if(r)return r;throw new Error(`Non-${e} character`)}}};class fi{name;prefix;baseEncode;constructor(t,e,r){this.name=t,this.prefix=e,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class li{name;prefix;baseDecode;prefixCodePoint;constructor(t,e,r){if(this.name=t,this.prefix=e,void 0===e.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=r}decode(t){if("string"==typeof t){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(t){return yi(this,t)}}class di{decoders;constructor(t){this.decoders=t}or(t){return yi(this,t)}decode(t){const e=t[0],r=this.decoders[e];if(null!=r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function yi(t,e){return new di({...t.decoders??{[t.prefix]:t},...e.decoders??{[e.prefix]:e}})}class pi{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,e,r,n){this.name=t,this.prefix=e,this.baseEncode=r,this.baseDecode=n,this.encoder=new fi(t,e,r),this.decoder=new li(t,e,n)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}function wi({name:t,prefix:e,encode:r,decode:n}){return new pi(t,e,r,n)}function gi({name:t,prefix:e,alphabet:r}){const{encode:n,decode:i}=hi(r,t);return wi({prefix:e,name:t,encode:n,decode:t=>ui(i(t))})}function bi({name:t,prefix:e,bitsPerChar:r,alphabet:n}){return wi({prefix:e,name:t,encode:t=>function(t,e,r){const n="="===e[e.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<t.length;++n)for(a=a<<8|t[n],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(0!==s&&(o+=e[i&a<<r-s]),n)for(;0!=(o.length*r&7);)o+="=";return o}(t,n,r),decode:e=>function(t,e,r,n){const i={};for(let t=0;t<e.length;++t)i[e[t]]=t;let o=t.length;for(;"="===t[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,u=0;for(let e=0;e<o;++e){const o=i[t[e]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=r||0!=(255&c<<8-a))throw new SyntaxError("Unexpected end of data");return s}(e,n,r,t)})}const mi=gi({prefix:"9",name:"base10",alphabet:"0123456789"}),vi=bi({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ei=bi({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),xi=bi({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Ai=Array.from(""),Si=Ai.reduce(((t,e,r)=>(t[r]=e,t)),[]),Ii=Ai.reduce(((t,e,r)=>(t[e.codePointAt(0)]=r,t)),[]),ki=wi({prefix:"",name:"base256emoji",encode:function(t){return t.reduce(((t,e)=>t+Si[e]),"")},decode:function(t){const e=[];for(const r of t){const t=Ii[r.codePointAt(0)];if(void 0===t)throw new Error(`Non-base256emoji character: ${r}`);e.push(t)}return new Uint8Array(e)}}),Bi=bi({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ti=bi({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_i=bi({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ci=bi({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Li=bi({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ui=bi({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Oi=bi({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ni=bi({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Pi=bi({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Di=gi({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ri=gi({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),ji=gi({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Vi=gi({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Mi=bi({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),zi=bi({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),$i=bi({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ki=bi({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Fi=bi({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),qi=wi({prefix:"\0",name:"identity",encode:t=>{return e=t,(new TextDecoder).decode(e);var e},decode:t=>function(t){return(new TextEncoder).encode(t)}(t)}),Hi=new TextEncoder,Gi=new TextDecoder,Zi="json",Yi=512;function Wi(t){return Hi.encode(JSON.stringify(t))}function Ji(t){return JSON.parse(Gi.decode(t))}const Qi="raw",Xi=85;function to(t){return ui(t)}function eo(t){return ui(t)}var ro=128,no=-128,io=Math.pow(2,31),oo=128,so=127,ao=Math.pow(2,7),co=Math.pow(2,14),uo=Math.pow(2,21),ho=Math.pow(2,28),fo=Math.pow(2,35),lo=Math.pow(2,42),yo=Math.pow(2,49),po=Math.pow(2,56),wo=Math.pow(2,63);const go={encode:function t(e,r,n){r=r||[];for(var i=n=n||0;e>=io;)r[n++]=255&e|ro,e/=128;for(;e&no;)r[n++]=255&e|ro,e>>>=7;return r[n]=0|e,t.bytes=n-i+1,r},decode:function t(e,r){var n,i=0,o=0,s=r=r||0,a=e.length;do{if(s>=a)throw t.bytes=0,new RangeError("Could not decode varint");n=e[s++],i+=o<28?(n&so)<<o:(n&so)*Math.pow(2,o),o+=7}while(n>=oo);return t.bytes=s-r,i},encodingLength:function(t){return t<ao?1:t<co?2:t<uo?3:t<ho?4:t<fo?5:t<lo?6:t<yo?7:t<po?8:t<wo?9:10}};function bo(t,e,r=0){return go.encode(t,e,r),e}function mo(t){return go.encodingLength(t)}function vo(t,e){const r=e.byteLength,n=mo(t),i=n+mo(r),o=new Uint8Array(i+r);return bo(t,o,0),bo(r,o,n),o.set(e,i),new Eo(t,r,e,o)}class Eo{code;size;digest;bytes;constructor(t,e,r,n){this.code=t,this.size=e,this.digest=r,this.bytes=n}}const xo=ui,Ao={code:0,name:"identity",encode:xo,digest:function(t){return vo(0,xo(t))}};function So({name:t,code:e,encode:r}){return new Io(t,e,r)}class Io{name;code;encode;constructor(t,e,r){this.name=t,this.code=e,this.encode=r}digest(t){if(t instanceof Uint8Array){const e=this.encode(t);return e instanceof Uint8Array?vo(this.code,e):e.then((t=>vo(this.code,t)))}throw Error("Unknown type, must be binary type")}}function ko(t){return async e=>new Uint8Array(await crypto.subtle.digest(t,e))}const Bo=So({name:"sha2-256",code:18,encode:ko("SHA-256")}),To=So({name:"sha2-512",code:19,encode:ko("SHA-512")});new WeakMap,Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const _o={...l,...o,...f,...e,...i,...a,...c,...u,...h,...s};function Co(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const Lo=Co("utf8","u",(t=>"u"+new TextDecoder("utf8").decode(t)),(t=>(new TextEncoder).encode(t.substring(1)))),Uo=Co("ascii","a",(t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e}),(t=>{const e=ri((t=t.substring(1)).length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e})),Oo={utf8:Lo,"utf-8":Lo,hex:_o.base16,latin1:Uo,ascii:Uo,binary:Uo,..._o};function No(t,e="utf8"){const r=Oo[e];if(null==r)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}function Po(t,e="utf8"){const r=Oo[e];if(null==r)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}const Do=parseInt("11111",2),Ro=parseInt("10000000",2),jo=parseInt("01111111",2),Vo={0:$o,1:$o,2:function(t,e){const r=zo(t,e),n=e.offset,i=e.offset+r,o=[];for(let e=n;e<i;e++)e===n&&0===t[e]||o.push(t[e]);return e.offset+=r,Uint8Array.from(o)},3:function(t,e){const r=zo(t,e),n=t[e.offset];e.offset++;const i=t.subarray(e.offset,e.offset+r-1);if(e.offset+=r,0!==n)throw new Error("Unused bits in bit string is unimplemented");return i},4:function(t,e){const r=zo(t,e),n=t.subarray(e.offset,e.offset+r);return e.offset+=r,n},5:function(t,e){return e.offset++,null},6:function(t,e){const r=zo(t,e),n=e.offset+r,i=t[e.offset];e.offset++;let o=0,s=0;i<40?(o=0,s=i):i<80?(o=1,s=i-40):(o=2,s=i-80);let a=`${o}.${s}`,c=[];for(;e.offset<n;){const r=t[e.offset];if(e.offset++,c.push(127&r),r<128){c.reverse();let t=0;for(let e=0;e<c.length;e++)t+=c[e]<<7*e;a+=`.${t}`,c=[]}}return a},16:$o,22:$o,48:$o};function Mo(t,e={offset:0}){const r=t[e.offset]&Do;if(e.offset++,null!=Vo[r])return Vo[r](t,e);throw new Error("No decoder for tag "+r)}function zo(t,e){let r=0;if((t[e.offset]&Ro)===Ro){const n=t[e.offset]&jo;let i="0x";e.offset++;for(let r=0;r<n;r++,e.offset++)i+=t[e.offset].toString(16).padStart(2,"0");r=parseInt(i,16)}else r=t[e.offset],e.offset++;return r}function $o(t,e){zo(t,e);const r=[];for(;!(e.offset>=t.byteLength);){const n=Mo(t,e);if(null===n)break;r.push(n)}return r}function Ko(t){if(t.byteLength<128)return Uint8Array.from([t.byteLength]);const e=function(t){let e=t.toString(16);e.length%2==1&&(e="0"+e);const r=new ci;for(let t=0;t<e.length;t+=2)r.append(Uint8Array.from([parseInt(`${e[t]}${e[t+1]}`,16)]));return r}(t.byteLength);return new ci(Uint8Array.from([e.byteLength|Ro]),e)}function Fo(t){const e=new ci;return 128==(128&t.subarray()[0])&&e.append(Uint8Array.from([0])),e.append(t),new ci(Uint8Array.from([2]),Ko(e),e)}function qo(t){const e=Uint8Array.from([0]),r=new ci(e,t);return new ci(Uint8Array.from([3]),Ko(r),r)}function Ho(t,e=48){const r=new ci;for(const e of t)r.append(e);return new ci(Uint8Array.from([e]),Ko(r),r)}function Go(t){if(t instanceof Uint8Array&&"Uint8Array"===t.constructor.name)return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}new Uint8Array(0);const Zo=function(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function f(t){if("string"!=typeof t)throw new TypeError("Expected String");if(0===t.length)return new Uint8Array;var e=0;if(" "!==t[e]){for(var n=0,i=0;t[e]===c;)n++,e++;for(var o=(t.length-e)*u+1>>>0,s=new Uint8Array(o);t[e];){var h=r[t.charCodeAt(e)];if(255===h)return;for(var f=0,l=o-1;(0!==h||f<i)&&-1!==l;l--,f++)h+=a*s[l]>>>0,s[l]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");i=f,e++}if(" "!==t[e]){for(var d=o-i;d!==o&&0===s[d];)d++;for(var y=new Uint8Array(n+(o-d)),p=n;d!==o;)y[p++]=s[d++];return y}}}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,n=0,i=0,o=e.length;i!==o&&0===e[i];)i++,r++;for(var s=(o-i)*h+1>>>0,u=new Uint8Array(s);i!==o;){for(var f=e[i],l=0,d=s-1;(0!==f||l<n)&&-1!==d;d--,l++)f+=256*u[d]>>>0,u[d]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=l,i++}for(var y=s-n;y!==s&&0===u[y];)y++;for(var p=c.repeat(r);y<s;++y)p+=t.charAt(u[y]);return p},decodeUnsafe:f,decode:function(t){var r=f(t);if(r)return r;throw new Error(`Non-${e} character`)}}};class Yo{name;prefix;baseEncode;constructor(t,e,r){this.name=t,this.prefix=e,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Wo{name;prefix;baseDecode;prefixCodePoint;constructor(t,e,r){this.name=t,this.prefix=e;const n=e.codePointAt(0);if(void 0===n)throw new Error("Invalid prefix character");this.prefixCodePoint=n,this.baseDecode=r}decode(t){if("string"==typeof t){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(t){return Qo(this,t)}}class Jo{decoders;constructor(t){this.decoders=t}or(t){return Qo(this,t)}decode(t){const e=t[0],r=this.decoders[e];if(null!=r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function Qo(t,e){return new Jo({...t.decoders??{[t.prefix]:t},...e.decoders??{[e.prefix]:e}})}class Xo{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,e,r,n){this.name=t,this.prefix=e,this.baseEncode=r,this.baseDecode=n,this.encoder=new Yo(t,e,r),this.decoder=new Wo(t,e,n)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}function ts({name:t,prefix:e,encode:r,decode:n}){return new Xo(t,e,r,n)}function es({name:t,prefix:e,alphabet:r}){const{encode:n,decode:i}=Zo(r,t);return ts({prefix:e,name:t,encode:n,decode:t=>Go(i(t))})}function rs({name:t,prefix:e,bitsPerChar:r,alphabet:n}){return ts({prefix:e,name:t,encode:t=>function(t,e,r){const n="="===e[e.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<t.length;++n)for(a=a<<8|t[n],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(0!==s&&(o+=e[i&a<<r-s]),n)for(;0!=(o.length*r&7);)o+="=";return o}(t,n,r),decode:e=>function(t,e,r,n){const i={};for(let t=0;t<e.length;++t)i[e[t]]=t;let o=t.length;for(;"="===t[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,u=0;for(let e=0;e<o;++e){const o=i[t[e]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[u++]=255&c>>a)}if(a>=r||0!=(255&c<<8-a))throw new SyntaxError("Unexpected end of data");return s}(e,n,r,t)})}const ns=es({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),is=(es({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),rs({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),os=(rs({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),rs({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),rs({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),rs({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),rs({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),rs({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),rs({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),rs({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),es({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}));es({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var ss=128,as=-128,cs=Math.pow(2,31),us=128,hs=127,fs=Math.pow(2,7),ls=Math.pow(2,14),ds=Math.pow(2,21),ys=Math.pow(2,28),ps=Math.pow(2,35),ws=Math.pow(2,42),gs=Math.pow(2,49),bs=Math.pow(2,56),ms=Math.pow(2,63);const vs={encode:function t(e,r,n){r=r||[];for(var i=n=n||0;e>=cs;)r[n++]=255&e|ss,e/=128;for(;e&as;)r[n++]=255&e|ss,e>>>=7;return r[n]=0|e,t.bytes=n-i+1,r},decode:function t(e,r){var n,i=0,o=0,s=r=r||0,a=e.length;do{if(s>=a)throw t.bytes=0,new RangeError("Could not decode varint");n=e[s++],i+=o<28?(n&hs)<<o:(n&hs)*Math.pow(2,o),o+=7}while(n>=us);return t.bytes=s-r,i},encodingLength:function(t){return t<fs?1:t<ls?2:t<ds?3:t<ys?4:t<ps?5:t<ws?6:t<gs?7:t<bs?8:t<ms?9:10}};function Es(t,e=0){return[vs.decode(t,e),vs.decode.bytes]}function xs(t,e,r=0){return vs.encode(t,e,r),e}function As(t){return vs.encodingLength(t)}function Ss(t,e){const r=e.byteLength,n=As(t),i=n+As(r),o=new Uint8Array(i+r);return xs(t,o,0),xs(r,o,n),o.set(e,i),new Is(t,r,e,o)}class Is{code;size;digest;bytes;constructor(t,e,r,n){this.code=t,this.size=e,this.digest=r,this.bytes=n}}function ks(t,e){const{bytes:r,version:n}=t;return 0===n?function(t,e,r){const{prefix:n}=r;if(n!==ns.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const i=e.get(n);if(null==i){const i=r.encode(t).slice(1);return e.set(n,i),i}return i}(r,Ts(t),e??ns.encoder):function(t,e,r){const{prefix:n}=r,i=e.get(n);if(null==i){const i=r.encode(t);return e.set(n,i),i}return i}(r,Ts(t),e??is.encoder)}const Bs=new WeakMap;function Ts(t){const e=Bs.get(t);if(null==e){const e=new Map;return Bs.set(t,e),e}return e}class _s{code;version;multihash;bytes;"/";constructor(t,e,r,n){this.code=e,this.version=t,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:e}=this;if(t!==Cs)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==Ls)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return _s.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:e}=this.multihash,r=Ss(t,e);return _s.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return _s.equals(this,t)}static equals(t,e){const r=e;return null!=r&&t.code===r.code&&t.version===r.version&&function(t,e){if(t===e)return!0;{const r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&function(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}(t.bytes,r.bytes)}}(t.multihash,r.multihash)}toString(t){return ks(this,t)}toJSON(){return{"/":ks(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(null==t)return null;const e=t;if(e instanceof _s)return e;if(null!=e["/"]&&e["/"]===e.bytes||e.asCID===e){const{version:t,code:r,multihash:n,bytes:i}=e;return new _s(t,r,n,i??Us(t,r,n.bytes))}if(!0===e[Os]){const{version:t,multihash:r,code:n}=e,i=function(t){const e=Go(t),[r,n]=Es(e),[i,o]=Es(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Is(r,i,s,e)}(r);return _s.create(t,n,i)}return null}static create(t,e,r){if("number"!=typeof e)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:if(e!==Cs)throw new Error(`Version 0 CID must use dag-pb (code: ${Cs}) block encoding`);return new _s(t,e,r,r.bytes);case 1:{const n=Us(t,e,r.bytes);return new _s(t,e,r,n)}default:throw new Error("Invalid version")}}static createV0(t){return _s.create(0,Cs,t)}static createV1(t,e){return _s.create(1,t,e)}static decode(t){const[e,r]=_s.decodeFirst(t);if(0!==r.length)throw new Error("Incorrect length");return e}static decodeFirst(t){const e=_s.inspectBytes(t),r=e.size-e.multihashSize,n=Go(t.subarray(r,r+e.multihashSize));if(n.byteLength!==e.multihashSize)throw new Error("Incorrect length");const i=n.subarray(e.multihashSize-e.digestSize),o=new Is(e.multihashCode,e.digestSize,i,n);return[0===e.version?_s.createV0(o):_s.createV1(e.codec,o),t.subarray(e.size)]}static inspectBytes(t){let e=0;const r=()=>{const[r,n]=Es(t.subarray(e));return e+=n,r};let n=r(),i=Cs;if(18===n?(n=0,e=0):i=r(),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const o=e,s=r(),a=r(),c=e+a;return{version:n,codec:i,multihashCode:s,digestSize:a,multihashSize:c-o,size:c}}static parse(t,e){const[r,n]=function(t,e){switch(t[0]){case"Q":{const r=e??ns;return[ns.prefix,r.decode(`${ns.prefix}${t}`)]}case ns.prefix:{const r=e??ns;return[ns.prefix,r.decode(t)]}case is.prefix:{const r=e??is;return[is.prefix,r.decode(t)]}case os.prefix:{const r=e??os;return[os.prefix,r.decode(t)]}default:if(null==e)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}(t,e),i=_s.decode(n);if(0===i.version&&"Q"!==t[0])throw Error("Version 0 CID string must not include multibase prefix");return Ts(i).set(r,t),i}}const Cs=112,Ls=18;function Us(t,e,r){const n=As(t),i=n+As(e),o=new Uint8Array(i+r.byteLength);return xs(t,o,0),xs(e,o,n),o.set(r,i),o}const Os=Symbol.for("@ipld/js-cid/CID"),Ns=Go,Ps=function(t){return Ss(0,Ns(t))};class Ds{type="ECDSA";jwk;_raw;constructor(t){this.jwk=t}get raw(){var t;return null==this._raw&&(this._raw=(t=this.jwk,Ho([Fo(Uint8Array.from([1])),Ho([Gs(t.crv)],160),Ho([qo(new ci(Uint8Array.from([4]),No(t.x??"","base64url"),No(t.y??"","base64url")))],161)]).subarray())),this._raw}toMultihash(){return Ps(Bh(this))}toCID(){return _s.createV1(114,this.toMultihash())}toString(){return ns.encode(this.toMultihash().bytes).substring(1)}equals(t){return null!=t&&t.raw instanceof Uint8Array&&ii(this.raw,t.raw)}async verify(t,e){return async function(t,e,r){const n=await crypto.subtle.importKey("jwk",t,{name:"ECDSA",namedCurve:t.crv??"P-256"},!1,["verify"]);return crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},n,e,r.subarray())}(this.jwk,e,t)}}class Rs{type="ECDSA";jwk;publicKey;_raw;constructor(t){this.jwk=t,this.publicKey=new Ds({crv:t.crv,ext:t.ext,key_ops:["verify"],kty:"EC",x:t.x,y:t.y})}get raw(){var t,e;return null==this._raw&&(this._raw=(t=this.jwk,Ho([Fo(Uint8Array.from([1])),(e=No(t.d??"","base64url"),new ci(Uint8Array.from([4]),Ko(e),e)),Ho([Gs(t.crv)],160),Ho([qo(new ci(Uint8Array.from([4]),No(t.x??"","base64url"),No(t.y??"","base64url")))],161)]).subarray())),this._raw}equals(t){return null!=t&&t.raw instanceof Uint8Array&&ii(this.raw,t.raw)}async sign(t){return async function(t,e){const r=await crypto.subtle.importKey("jwk",t,{name:"ECDSA",namedCurve:t.crv??"P-256"},!1,["sign"]),n=await crypto.subtle.sign({name:"ECDSA",hash:{name:"SHA-256"}},r,e.subarray());return new Uint8Array(n,0,n.byteLength)}(this.jwk,t)}}const js=Uint8Array.from([6,8,42,134,72,206,61,3,1,7]),Vs=Uint8Array.from([6,5,43,129,4,0,34]),Ms=Uint8Array.from([6,5,43,129,4,0,35]),zs={ext:!0,kty:"EC",crv:"P-256"},$s={ext:!0,kty:"EC",crv:"P-384"},Ks={ext:!0,kty:"EC",crv:"P-521"},Fs=32,qs=48,Hs=66;function Gs(t){if("P-256"===t)return js;if("P-384"===t)return Vs;if("P-521"===t)return Ms;throw new Zn(`Invalid curve ${t}`)}function Zs(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Ys(t,...e){if(!((r=t)instanceof Uint8Array||ArrayBuffer.isView(r)&&"Uint8Array"===r.constructor.name))throw new Error("Uint8Array expected");var r;if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Ws(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}const Js="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function Qs(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Xs(t,e){return t<<32-e|t>>>e}function ta(t){return"string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t)),Ys(t),t}class ea{clone(){return this._cloneInto()}}function ra(t){const e=e=>t().update(ta(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function na(t=32){if(Js&&"function"==typeof Js.getRandomValues)return Js.getRandomValues(new Uint8Array(t));if(Js&&"function"==typeof Js.randomBytes)return Js.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function ia(t,e,r){return t&e^t&r^e&r}class oa extends ea{constructor(t,e,r,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Qs(this.buffer)}update(t){Ws(this);const{view:e,buffer:r,blockLen:n}=this,i=(t=ta(t)).length;for(let o=0;o<i;){const s=Math.min(n-this.pos,i-o);if(s!==n)r.set(t.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(e,0),this.pos=0);else{const e=Qs(t);for(;n<=i-o;o+=n)this.process(e,o)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){Ws(this),function(t,e){Ys(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:n,isLE:i}=this;let{pos:o}=this;e[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(r,0),o=0);for(let t=o;t<n;t++)e[t]=0;!function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);const i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,u=n?0:4;t.setUint32(e+c,s,n),t.setUint32(e+u,a,n)}(r,n-8,BigInt(8*this.length),i),this.process(r,0);const s=Qs(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)s.setUint32(4*t,u[t],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return t.length=n,t.pos=s,t.finished=i,t.destroyed=o,n%e&&t.buffer.set(r),t}}const sa=BigInt(2**32-1),aa=BigInt(32);function ca(t,e=!1){return e?{h:Number(t&sa),l:Number(t>>aa&sa)}:{h:0|Number(t>>aa&sa),l:0|Number(t&sa)}}const ua={fromBig:ca,split:function(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:o,l:s}=ca(t[i],e);[r[i],n[i]]=[o,s]}return[r,n]},toBig:(t,e)=>BigInt(t>>>0)<<aa|BigInt(e>>>0),shrSH:(t,e,r)=>t>>>r,shrSL:(t,e,r)=>t<<32-r|e>>>r,rotrSH:(t,e,r)=>t>>>r|e<<32-r,rotrSL:(t,e,r)=>t<<32-r|e>>>r,rotrBH:(t,e,r)=>t<<64-r|e>>>r-32,rotrBL:(t,e,r)=>t>>>r-32|e<<64-r,rotr32H:(t,e)=>e,rotr32L:(t,e)=>t,rotlSH:(t,e,r)=>t<<r|e>>>32-r,rotlSL:(t,e,r)=>e<<r|t>>>32-r,rotlBH:(t,e,r)=>e<<r-32|t>>>64-r,rotlBL:(t,e,r)=>t<<r-32|e>>>64-r,add:function(t,e,r,n){const i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:0|i}},add3L:(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),add3H:(t,e,r,n)=>e+r+n+(t/2**32|0)|0,add4L:(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),add4H:(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,add5H:(t,e,r,n,i,o)=>e+r+n+i+o+(t/2**32|0)|0,add5L:(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0)},ha=ua,[fa,la]=(()=>ha.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((t=>BigInt(t)))))(),da=new Uint32Array(80),ya=new Uint32Array(80);class pa extends oa{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:r,Bl:n,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:u,Fh:h,Fl:f,Gh:l,Gl:d,Hh:y,Hl:p}=this;return[t,e,r,n,i,o,s,a,c,u,h,f,l,d,y,p]}set(t,e,r,n,i,o,s,a,c,u,h,f,l,d,y,p){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|u,this.Fh=0|h,this.Fl=0|f,this.Gh=0|l,this.Gl=0|d,this.Hh=0|y,this.Hl=0|p}process(t,e){for(let r=0;r<16;r++,e+=4)da[r]=t.getUint32(e),ya[r]=t.getUint32(e+=4);for(let t=16;t<80;t++){const e=0|da[t-15],r=0|ya[t-15],n=ha.rotrSH(e,r,1)^ha.rotrSH(e,r,8)^ha.shrSH(e,r,7),i=ha.rotrSL(e,r,1)^ha.rotrSL(e,r,8)^ha.shrSL(e,r,7),o=0|da[t-2],s=0|ya[t-2],a=ha.rotrSH(o,s,19)^ha.rotrBH(o,s,61)^ha.shrSH(o,s,6),c=ha.rotrSL(o,s,19)^ha.rotrBL(o,s,61)^ha.shrSL(o,s,6),u=ha.add4L(i,c,ya[t-7],ya[t-16]),h=ha.add4H(u,n,a,da[t-7],da[t-16]);da[t]=0|h,ya[t]=0|u}let{Ah:r,Al:n,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:u,Eh:h,El:f,Fh:l,Fl:d,Gh:y,Gl:p,Hh:w,Hl:g}=this;for(let t=0;t<80;t++){const e=ha.rotrSH(h,f,14)^ha.rotrSH(h,f,18)^ha.rotrBH(h,f,41),b=ha.rotrSL(h,f,14)^ha.rotrSL(h,f,18)^ha.rotrBL(h,f,41),m=h&l^~h&y,v=f&d^~f&p,E=ha.add5L(g,b,v,la[t],ya[t]),x=ha.add5H(E,w,e,m,fa[t],da[t]),A=0|E,S=ha.rotrSH(r,n,28)^ha.rotrBH(r,n,34)^ha.rotrBH(r,n,39),I=ha.rotrSL(r,n,28)^ha.rotrBL(r,n,34)^ha.rotrBL(r,n,39),k=r&i^r&s^i&s,B=n&o^n&a^o&a;w=0|y,g=0|p,y=0|l,p=0|d,l=0|h,d=0|f,({h,l:f}=ha.add(0|c,0|u,0|x,0|A)),c=0|s,u=0|a,s=0|i,a=0|o,i=0|r,o=0|n;const T=ha.add3L(A,I,B);r=ha.add3H(T,x,S,k),n=0|T}({h:r,l:n}=ha.add(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:o}=ha.add(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=ha.add(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:u}=ha.add(0|this.Dh,0|this.Dl,0|c,0|u)),({h,l:f}=ha.add(0|this.Eh,0|this.El,0|h,0|f)),({h:l,l:d}=ha.add(0|this.Fh,0|this.Fl,0|l,0|d)),({h:y,l:p}=ha.add(0|this.Gh,0|this.Gl,0|y,0|p)),({h:w,l:g}=ha.add(0|this.Hh,0|this.Hl,0|w,0|g)),this.set(r,n,i,o,s,a,c,u,h,f,l,d,y,p,w,g)}roundClean(){da.fill(0),ya.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const wa=ra((()=>new pa)),ga=BigInt(0),ba=BigInt(1),ma=BigInt(2);function va(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function Ea(t){if(!va(t))throw new Error("Uint8Array expected")}function xa(t,e){if("boolean"!=typeof e)throw new Error(t+" boolean expected, got "+e)}const Aa=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function Sa(t){Ea(t);let e="";for(let r=0;r<t.length;r++)e+=Aa[t[r]];return e}function Ia(t){const e=t.toString(16);return 1&e.length?"0"+e:e}function ka(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return""===t?ga:BigInt("0x"+t)}const Ba={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ta(t){return t>=Ba._0&&t<=Ba._9?t-Ba._0:t>=Ba.A&&t<=Ba.F?t-(Ba.A-10):t>=Ba.a&&t<=Ba.f?t-(Ba.a-10):void 0}function _a(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let e=0,i=0;e<r;e++,i+=2){const r=Ta(t.charCodeAt(i)),o=Ta(t.charCodeAt(i+1));if(void 0===r||void 0===o){const e=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+e+'" at index '+i)}n[e]=16*r+o}return n}function Ca(t){return ka(Sa(t))}function La(t){return Ea(t),ka(Sa(Uint8Array.from(t).reverse()))}function Ua(t,e){return _a(t.toString(16).padStart(2*e,"0"))}function Oa(t,e){return Ua(t,e).reverse()}function Na(t,e,r){let n;if("string"==typeof e)try{n=_a(e)}catch(e){throw new Error(t+" must be hex string or Uint8Array, cause: "+e)}else{if(!va(e))throw new Error(t+" must be hex string or Uint8Array");n=Uint8Array.from(e)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}function Pa(...t){let e=0;for(let r=0;r<t.length;r++){const n=t[r];Ea(n),e+=n.length}const r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){const i=t[e];r.set(i,n),n+=i.length}return r}const Da=t=>"bigint"==typeof t&&ga<=t;function Ra(t,e,r){return Da(t)&&Da(e)&&Da(r)&&e<=t&&t<r}function ja(t,e,r,n){if(!Ra(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function Va(t){let e;for(e=0;t>ga;t>>=ba,e+=1);return e}const Ma=t=>(ma<<BigInt(t-1))-ba,za=t=>new Uint8Array(t),$a=t=>Uint8Array.from(t);function Ka(t,e,r){if("number"!=typeof t||t<2)throw new Error("hashLen must be a number");if("number"!=typeof e||e<2)throw new Error("qByteLen must be a number");if("function"!=typeof r)throw new Error("hmacFn must be a function");let n=za(t),i=za(t),o=0;const s=()=>{n.fill(1),i.fill(0),o=0},a=(...t)=>r(i,n,...t),c=(t=za())=>{i=a($a([0]),t),n=a(),0!==t.length&&(i=a($a([1]),t),n=a())},u=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let t=0;const r=[];for(;t<e;){n=a();const e=n.slice();r.push(e),t+=n.length}return Pa(...r)};return(t,e)=>{let r;for(s(),c(t);!(r=e(u()));)c();return s(),r}}const Fa={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||va(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function qa(t,e,r={}){const n=(e,r,n)=>{const i=Fa[r];if("function"!=typeof i)throw new Error("invalid validator function");const o=t[e];if(!(n&&void 0===o||i(o,t)))throw new Error("param "+String(e)+" is invalid. Expected "+r+", got "+o)};for(const[t,r]of Object.entries(e))n(t,r,!1);for(const[t,e]of Object.entries(r))n(t,e,!0);return t}function Ha(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(void 0!==i)return i;const o=t(r,...n);return e.set(r,o),o}}const Ga=BigInt(0),Za=BigInt(1),Ya=BigInt(2),Wa=BigInt(3),Ja=BigInt(4),Qa=BigInt(5),Xa=BigInt(8);function tc(t,e){const r=t%e;return r>=Ga?r:e+r}function ec(t,e,r){if(e<Ga)throw new Error("invalid exponent, negatives unsupported");if(r<=Ga)throw new Error("invalid modulus");if(r===Za)return Ga;let n=Za;for(;e>Ga;)e&Za&&(n=n*t%r),t=t*t%r,e>>=Za;return n}function rc(t,e,r){let n=t;for(;e-- >Ga;)n*=n,n%=r;return n}function nc(t,e){if(t===Ga)throw new Error("invert: expected non-zero number");if(e<=Ga)throw new Error("invert: expected positive modulus, got "+e);let r=tc(t,e),n=e,i=Ga,o=Za,s=Za,a=Ga;for(;r!==Ga;){const t=n/r,e=n%r,c=i-s*t,u=o-a*t;n=r,r=e,i=s,o=a,s=c,a=u}if(n!==Za)throw new Error("invert: does not exist");return tc(i,e)}const ic=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function oc(t,e){const r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function sc(t,e,r=!1,n={}){if(t<=Ga)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:i,nByteLength:o}=oc(t,e);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let s;const a=Object.freeze({ORDER:t,isLE:r,BITS:i,BYTES:o,MASK:Ma(i),ZERO:Ga,ONE:Za,create:e=>tc(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("invalid field element: expected bigint, got "+typeof e);return Ga<=e&&e<t},is0:t=>t===Ga,isOdd:t=>(t&Za)===Za,neg:e=>tc(-e,t),eql:(t,e)=>t===e,sqr:e=>tc(e*e,t),add:(e,r)=>tc(e+r,t),sub:(e,r)=>tc(e-r,t),mul:(e,r)=>tc(e*r,t),pow:(t,e)=>function(t,e,r){if(r<Ga)throw new Error("invalid exponent, negatives unsupported");if(r===Ga)return t.ONE;if(r===Za)return e;let n=t.ONE,i=e;for(;r>Ga;)r&Za&&(n=t.mul(n,i)),i=t.sqr(i),r>>=Za;return n}(a,t,e),div:(e,r)=>tc(e*nc(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>nc(e,t),sqrt:n.sqrt||(e=>(s||(s=function(t){if(t%Ja===Wa){const e=(t+Za)/Ja;return function(t,r){const n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw new Error("Cannot find square root");return n}}if(t%Xa===Qa){const e=(t-Qa)/Xa;return function(t,r){const n=t.mul(r,Ya),i=t.pow(n,e),o=t.mul(r,i),s=t.mul(t.mul(o,Ya),i),a=t.mul(o,t.sub(s,t.ONE));if(!t.eql(t.sqr(a),r))throw new Error("Cannot find square root");return a}}return function(t){const e=(t-Za)/Ya;let r,n,i;for(r=t-Za,n=0;r%Ya===Ga;r/=Ya,n++);for(i=Ya;i<t&&ec(i,e,t)!==t-Za;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===n){const e=(t+Za)/Ja;return function(t,r){const n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw new Error("Cannot find square root");return n}}const o=(r+Za)/Ya;return function(t,s){if(t.pow(s,e)===t.neg(t.ONE))throw new Error("Cannot find square root");let a=n,c=t.pow(t.mul(t.ONE,i),r),u=t.pow(s,o),h=t.pow(s,r);for(;!t.eql(h,t.ONE);){if(t.eql(h,t.ZERO))return t.ZERO;let e=1;for(let r=t.sqr(h);e<a&&!t.eql(r,t.ONE);e++)r=t.sqr(r);const r=t.pow(c,Za<<BigInt(a-e-1));c=t.sqr(r),u=t.mul(u,r),h=t.mul(h,c),a=e}return u}}(t)}(t)),s(a,e))),invertBatch:t=>function(t,e){const r=new Array(e.length),n=e.reduce(((e,n,i)=>t.is0(n)?e:(r[i]=e,t.mul(e,n))),t.ONE),i=t.inv(n);return e.reduceRight(((e,n,i)=>t.is0(n)?e:(r[i]=t.mul(e,r[i]),t.mul(e,n))),i),r}(a,t),cmov:(t,e,r)=>r?e:t,toBytes:t=>r?Oa(t,o):Ua(t,o),fromBytes:t=>{if(t.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+t.length);return r?La(t):Ca(t)}});return Object.freeze(a)}function ac(t){if("bigint"!=typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function cc(t){const e=ac(t);return e+Math.ceil(e/2)}const uc=BigInt(0),hc=BigInt(1);function fc(t,e){const r=e.negate();return t?r:e}function lc(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function dc(t,e){return lc(t,e),{windows:Math.ceil(e/t)+1,windowSize:2**(t-1)}}const yc=new WeakMap,pc=new WeakMap;function wc(t){return pc.get(t)||1}function gc(t,e){return{constTimeNegate:fc,hasPrecomputes:t=>1!==wc(t),unsafeLadder(e,r,n=t.ZERO){let i=e;for(;r>uc;)r&hc&&(n=n.add(i)),i=i.double(),r>>=hc;return n},precomputeWindow(t,r){const{windows:n,windowSize:i}=dc(r,e),o=[];let s=t,a=s;for(let t=0;t<n;t++){a=s,o.push(a);for(let t=1;t<i;t++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(r,n,i){const{windows:o,windowSize:s}=dc(r,e);let a=t.ZERO,c=t.BASE;const u=BigInt(2**r-1),h=2**r,f=BigInt(r);for(let t=0;t<o;t++){const e=t*s;let r=Number(i&u);i>>=f,r>s&&(r-=h,i+=hc);const o=e,l=e+Math.abs(r)-1,d=t%2!=0,y=r<0;0===r?c=c.add(fc(d,n[o])):a=a.add(fc(y,n[l]))}return{p:a,f:c}},wNAFUnsafe(r,n,i,o=t.ZERO){const{windows:s,windowSize:a}=dc(r,e),c=BigInt(2**r-1),u=2**r,h=BigInt(r);for(let t=0;t<s;t++){const e=t*a;if(i===uc)break;let r=Number(i&c);if(i>>=h,r>a&&(r-=u,i+=hc),0===r)continue;let s=n[e+Math.abs(r)-1];r<0&&(s=s.negate()),o=o.add(s)}return o},getPrecomputes(t,e,r){let n=yc.get(e);return n||(n=this.precomputeWindow(e,t),1!==t&&yc.set(e,r(n))),n},wNAFCached(t,e,r){const n=wc(t);return this.wNAF(n,this.getPrecomputes(n,t,r),e)},wNAFCachedUnsafe(t,e,r,n){const i=wc(t);return 1===i?this.unsafeLadder(t,e,n):this.wNAFUnsafe(i,this.getPrecomputes(i,t,r),e,n)},setWindowSize(t,r){lc(r,e),pc.set(t,r),yc.delete(t)}}}function bc(t,e,r,n){if(function(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach(((t,r)=>{if(!(t instanceof e))throw new Error("invalid point at index "+r)}))}(r,t),function(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach(((t,r)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+r)}))}(n,e),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=t.ZERO,o=Va(BigInt(r.length)),s=o>12?o-3:o>4?o-2:o?2:1,a=(1<<s)-1,c=new Array(a+1).fill(i);let u=i;for(let t=Math.floor((e.BITS-1)/s)*s;t>=0;t-=s){c.fill(i);for(let e=0;e<n.length;e++){const i=n[e],o=Number(i>>BigInt(t)&BigInt(a));c[o]=c[o].add(r[e])}let e=i;for(let t=c.length-1,r=i;t>0;t--)r=r.add(c[t]),e=e.add(r);if(u=u.add(e),0!==t)for(let t=0;t<s;t++)u=u.double()}return u}function mc(t){return qa(t.Fp,ic.reduce(((t,e)=>(t[e]="function",t)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),qa(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...oc(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const vc=BigInt(0),Ec=BigInt(1),xc=BigInt(2),Ac=BigInt(8),Sc={zip215:!0};const Ic=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),kc=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Bc=(BigInt(0),BigInt(1)),Tc=BigInt(2),_c=(BigInt(3),BigInt(5)),Cc=BigInt(8);function Lc(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Uc(t,e){const r=Ic,n=tc(e*e*e,r),i=tc(n*n*e,r);let o=tc(t*n*function(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),o=Ic,s=t*t%o*t%o,a=rc(s,Tc,o)*s%o,c=rc(a,Bc,o)*t%o,u=rc(c,_c,o)*c%o,h=rc(u,e,o)*u%o,f=rc(h,r,o)*h%o,l=rc(f,n,o)*f%o,d=rc(l,i,o)*l%o,y=rc(d,i,o)*l%o,p=rc(y,e,o)*u%o;return{pow_p_5_8:rc(p,Tc,o)*t%o,b2:s}}(t*i).pow_p_5_8,r);const s=tc(e*o*o,r),a=o,c=tc(o*kc,r),u=s===t,h=s===tc(-t,r),f=s===tc(-t*kc,r);return u&&(o=a),(h||f)&&(o=c),(tc(o,r)&Za)===Za&&(o=tc(-o,r)),{isValid:u||h,value:o}}const Oc=(()=>sc(Ic,void 0,!0))(),Nc=(()=>({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Oc,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Cc,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:wa,randomBytes:na,adjustScalarBytes:Lc,uvRatio:Uc}))(),Pc=(()=>function(t){const e=function(t){const e=mc(t);return qa(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}(t),{Fp:r,n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=e,u=xc<<BigInt(8*a)-Ec,h=r.create,f=sc(e.n,e.nBitLength),l=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:r.sqrt(t*r.inv(e))}}catch(t){return{isValid:!1,value:vc}}}),d=e.adjustScalarBytes||(t=>t),y=e.domain||((t,e,r)=>{if(xa("phflag",r),e.length||r)throw new Error("Contexts/pre-hash are not supported");return t});function p(t,e){ja("coordinate "+t,e,vc,u)}function w(t){if(!(t instanceof m))throw new Error("ExtendedPoint expected")}const g=Ha(((t,e)=>{const{ex:n,ey:i,ez:o}=t,s=t.is0();null==e&&(e=s?Ac:r.inv(o));const a=h(n*e),c=h(i*e),u=h(o*e);if(s)return{x:vc,y:Ec};if(u!==Ec)throw new Error("invZ was invalid");return{x:a,y:c}})),b=Ha((t=>{const{a:r,d:n}=e;if(t.is0())throw new Error("bad point: ZERO");const{ex:i,ey:o,ez:s,et:a}=t,c=h(i*i),u=h(o*o),f=h(s*s),l=h(f*f),d=h(c*r);if(h(f*h(d+u))!==h(l+h(n*h(c*u))))throw new Error("bad point: equation left != right (1)");if(h(i*o)!==h(s*a))throw new Error("bad point: equation left != right (2)");return!0}));class m{constructor(t,e,r,n){this.ex=t,this.ey=e,this.ez=r,this.et=n,p("x",t),p("y",e),p("z",r),p("t",n),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(t){if(t instanceof m)throw new Error("extended point not allowed");const{x:e,y:r}=t||{};return p("x",e),p("y",r),new m(e,r,Ec,h(e*r))}static normalizeZ(t){const e=r.invertBatch(t.map((t=>t.ez)));return t.map(((t,r)=>t.toAffine(e[r]))).map(m.fromAffine)}static msm(t,e){return bc(m,f,t,e)}_setWindowSize(t){x.setWindowSize(this,t)}assertValidity(){b(this)}equals(t){w(t);const{ex:e,ey:r,ez:n}=this,{ex:i,ey:o,ez:s}=t,a=h(e*s),c=h(i*n),u=h(r*s),f=h(o*n);return a===c&&u===f}is0(){return this.equals(m.ZERO)}negate(){return new m(h(-this.ex),this.ey,this.ez,h(-this.et))}double(){const{a:t}=e,{ex:r,ey:n,ez:i}=this,o=h(r*r),s=h(n*n),a=h(xc*h(i*i)),c=h(t*o),u=r+n,f=h(h(u*u)-o-s),l=c+s,d=l-a,y=c-s,p=h(f*d),w=h(l*y),g=h(f*y),b=h(d*l);return new m(p,w,b,g)}add(t){w(t);const{a:r,d:n}=e,{ex:i,ey:o,ez:s,et:a}=this,{ex:c,ey:u,ez:f,et:l}=t;if(r===BigInt(-1)){const t=h((o-i)*(u+c)),e=h((o+i)*(u-c)),r=h(e-t);if(r===vc)return this.double();const n=h(s*xc*l),d=h(a*xc*f),y=d+n,p=e+t,w=d-n,g=h(y*r),b=h(p*w),v=h(y*w),E=h(r*p);return new m(g,b,E,v)}const d=h(i*c),y=h(o*u),p=h(a*n*l),g=h(s*f),b=h((i+o)*(c+u)-d-y),v=g-p,E=g+p,x=h(y-r*d),A=h(b*v),S=h(E*x),I=h(b*x),k=h(v*E);return new m(A,S,k,I)}subtract(t){return this.add(t.negate())}wNAF(t){return x.wNAFCached(this,t,m.normalizeZ)}multiply(t){const e=t;ja("scalar",e,Ec,n);const{p:r,f:i}=this.wNAF(e);return m.normalizeZ([r,i])[0]}multiplyUnsafe(t,e=m.ZERO){const r=t;return ja("scalar",r,vc,n),r===vc?E:this.is0()||r===Ec?this:x.wNAFCachedUnsafe(this,r,m.normalizeZ,e)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return x.unsafeLadder(this,n).is0()}toAffine(t){return g(this,t)}clearCofactor(){const{h:t}=e;return t===Ec?this:this.multiplyUnsafe(t)}static fromHex(t,n=!1){const{d:i,a:o}=e,s=r.BYTES;t=Na("pointHex",t,s),xa("zip215",n);const a=t.slice(),c=t[s-1];a[s-1]=-129&c;const f=La(a),d=n?u:r.ORDER;ja("pointHex.y",f,vc,d);const y=h(f*f),p=h(y-Ec),w=h(i*y-o);let{isValid:g,value:b}=l(p,w);if(!g)throw new Error("Point.fromHex: invalid y coordinate");const v=(b&Ec)===Ec,E=0!=(128&c);if(!n&&b===vc&&E)throw new Error("Point.fromHex: x=0 and x_0=1");return E!==v&&(b=h(-b)),m.fromAffine({x:b,y:f})}static fromPrivateKey(t){return I(t).point}toRawBytes(){const{x:t,y:e}=this.toAffine(),n=Oa(e,r.BYTES);return n[n.length-1]|=t&Ec?128:0,n}toHex(){return Sa(this.toRawBytes())}}m.BASE=new m(e.Gx,e.Gy,Ec,h(e.Gx*e.Gy)),m.ZERO=new m(vc,Ec,Ec,vc);const{BASE:v,ZERO:E}=m,x=gc(m,8*a);function A(t){return tc(t,n)}function S(t){return A(La(t))}function I(t){const e=r.BYTES;t=Na("private key",t,e);const n=Na("hashed private key",o(t),2*e),i=d(n.slice(0,e)),s=n.slice(e,2*e),a=S(i),c=v.multiply(a),u=c.toRawBytes();return{head:i,prefix:s,scalar:a,point:c,pointBytes:u}}function k(t=new Uint8Array,...e){const r=Pa(...e);return S(o(y(r,Na("context",t),!!i)))}const B=Sc;return v._setWindowSize(8),{CURVE:e,getPublicKey:function(t){return I(t).pointBytes},sign:function(t,e,o={}){t=Na("message",t),i&&(t=i(t));const{prefix:s,scalar:a,pointBytes:c}=I(e),u=k(o.context,s,t),h=v.multiply(u).toRawBytes(),f=A(u+k(o.context,h,c,t)*a);return ja("signature.s",f,vc,n),Na("result",Pa(h,Oa(f,r.BYTES)),2*r.BYTES)},verify:function(t,e,n,o=B){const{context:s,zip215:a}=o,c=r.BYTES;t=Na("signature",t,2*c),e=Na("message",e),n=Na("publicKey",n,c),void 0!==a&&xa("zip215",a),i&&(e=i(e));const u=La(t.slice(c,2*c));let h,f,l;try{h=m.fromHex(n,a),f=m.fromHex(t.slice(0,c),a),l=v.multiplyUnsafe(u)}catch(t){return!1}if(!a&&h.isSmallOrder())return!1;const d=k(s,f.toRawBytes(),h.toRawBytes(),e);return f.add(h.multiplyUnsafe(d)).subtract(l).clearCofactor().equals(m.ZERO)},ExtendedPoint:m,utils:{getExtendedPublicKey:I,randomPrivateKey:()=>s(r.BYTES),precompute:(t=8,e=m.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}}(Nc))(),Dc=64,Rc=32;function jc(t,e){const r=new Uint8Array(Dc);for(let n=0;n<Rc;n++)r[n]=t[n],r[Rc+n]=e[n];return r}class Vc{type="Ed25519";raw;constructor(t){this.raw=zc(t,32)}toMultihash(){return Ps(Bh(this))}toCID(){return _s.createV1(114,this.toMultihash())}toString(){return ns.encode(this.toMultihash().bytes).substring(1)}equals(t){return null!=t&&t.raw instanceof Uint8Array&&ii(this.raw,t.raw)}verify(t,e){return function(t,e,r){return Pc.verify(e,r instanceof Uint8Array?r:r.subarray(),t)}(this.raw,e,t)}}class Mc{type="Ed25519";raw;publicKey;constructor(t,e){this.raw=zc(t,Dc),this.publicKey=new Vc(e)}equals(t){return null!=t&&t.raw instanceof Uint8Array&&ii(this.raw,t.raw)}sign(t){return function(t,e){const r=t.subarray(0,Rc);return Pc.sign(e instanceof Uint8Array?e:e.subarray(),r)}(this.raw,t)}}function zc(t,e){if((t=Uint8Array.from(t??[])).length!==e)throw new Zn(`Key must be a Uint8Array of length ${e}, got ${t.length}`);return t}const $c=Math.pow(2,7),Kc=Math.pow(2,14),Fc=Math.pow(2,21),qc=Math.pow(2,28),Hc=Math.pow(2,35),Gc=Math.pow(2,42),Zc=Math.pow(2,49),Yc=128,Wc=127;function Jc(t){if(t<$c)return 1;if(t<Kc)return 2;if(t<Fc)return 3;if(t<qc)return 4;if(t<Hc)return 5;if(t<Gc)return 6;if(t<Zc)return 7;if(null!=Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function Qc(t,e,r=0){switch(Jc(t)){case 8:e[r++]=255&t|Yc,t/=128;case 7:e[r++]=255&t|Yc,t/=128;case 6:e[r++]=255&t|Yc,t/=128;case 5:e[r++]=255&t|Yc,t/=128;case 4:e[r++]=255&t|Yc,t>>>=7;case 3:e[r++]=255&t|Yc,t>>>=7;case 2:e[r++]=255&t|Yc,t>>>=7;case 1:e[r++]=255&t,t>>>=7;break;default:throw new Error("unreachable")}return e}const Xc=new Float32Array([-0]),tu=new Uint8Array(Xc.buffer);function eu(t,e,r){Xc[0]=t,e[r]=tu[0],e[r+1]=tu[1],e[r+2]=tu[2],e[r+3]=tu[3]}const ru=new Float64Array([-0]),nu=new Uint8Array(ru.buffer);function iu(t,e,r){ru[0]=t,e[r]=nu[0],e[r+1]=nu[1],e[r+2]=nu[2],e[r+3]=nu[3],e[r+4]=nu[4],e[r+5]=nu[5],e[r+6]=nu[6],e[r+7]=nu[7]}const ou=BigInt(Number.MAX_SAFE_INTEGER),su=BigInt(Number.MIN_SAFE_INTEGER);class au{lo;hi;constructor(t,e){this.lo=0|t,this.hi=0|e}toNumber(t=!1){if(!t&&this.hi>>>31>0){const t=1+~this.lo>>>0;let e=~this.hi>>>0;return 0===t&&(e=e+1>>>0),-(t+4294967296*e)}return this.lo+4294967296*this.hi}toBigInt(t=!1){if(t)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!=0){const t=1+~this.lo>>>0;let e=~this.hi>>>0;return 0===t&&(e=e+1>>>0),-(BigInt(t)+(BigInt(e)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(t=!1){return this.toBigInt(t).toString()}zzEncode(){const t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this}zzDecode(){const t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this}length(){const t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===e?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:r<128?9:10}static fromBigInt(t){if(0n===t)return cu;if(t<ou&&t>su)return this.fromNumber(Number(t));const e=t<0n;e&&(t=-t);let r=t>>32n,n=t-(r<<32n);return e&&(r=0n|~r,n=0n|~n,++n>uu&&(n=0n,++r>uu&&(r=0n))),new au(Number(n),Number(r))}static fromNumber(t){if(0===t)return cu;const e=t<0;e&&(t=-t);let r=t>>>0,n=(t-r)/4294967296>>>0;return e&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new au(r,n)}static from(t){return"number"==typeof t?au.fromNumber(t):"bigint"==typeof t?au.fromBigInt(t):"string"==typeof t?au.fromBigInt(BigInt(t)):null!=t.low||null!=t.high?new au(t.low>>>0,t.high>>>0):cu}}const cu=new au(0,0);cu.toBigInt=function(){return 0n},cu.zzEncode=cu.zzDecode=function(){return this},cu.length=function(){return 1};const uu=4294967296n;function hu(t,e,r){const n=r;let i,o;for(let n=0;n<t.length;++n)i=t.charCodeAt(n),i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=63&i|128):55296==(64512&i)&&56320==(64512&(o=t.charCodeAt(n+1)))?(i=65536+((1023&i)<<10)+(1023&o),++n,e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=63&i|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=63&i|128);return r-n}function fu(t,e){return RangeError(`index out of range: ${t.pos} + ${e??1} > ${t.len}`)}function lu(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}class du{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(t){this.buf=t,this.pos=0,this.len=t.length}uint32(){let t=4294967295;if(t=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return t;if((this.pos+=5)>this.len)throw this.pos=this.len,fu(this,10);return t}int32(){return 0|this.uint32()}sint32(){const t=this.uint32();return t>>>1^-(1&t)|0}bool(){return 0!==this.uint32()}fixed32(){if(this.pos+4>this.len)throw fu(this,4);return lu(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw fu(this,4);return 0|lu(this.buf,this.pos+=4)}float(){if(this.pos+4>this.len)throw fu(this,4);const t=function(t,e){return tu[0]=t[e],tu[1]=t[e+1],tu[2]=t[e+2],tu[3]=t[e+3],Xc[0]}(this.buf,this.pos);return this.pos+=4,t}double(){if(this.pos+8>this.len)throw fu(this,4);const t=function(t,e){return nu[0]=t[e],nu[1]=t[e+1],nu[2]=t[e+2],nu[3]=t[e+3],nu[4]=t[e+4],nu[5]=t[e+5],nu[6]=t[e+6],nu[7]=t[e+7],ru[0]}(this.buf,this.pos);return this.pos+=8,t}bytes(){const t=this.uint32(),e=this.pos,r=this.pos+t;if(r>this.len)throw fu(this,t);return this.pos+=t,e===r?new Uint8Array(0):this.buf.subarray(e,r)}string(){const t=this.bytes();return function(t,e,r){if(r-e<1)return"";let n;const i=[];let o,s=0;for(;e<r;)o=t[e++],o<128?i[s++]=o:o>191&&o<224?i[s++]=(31&o)<<6|63&t[e++]:o>239&&o<365?(o=((7&o)<<18|(63&t[e++])<<12|(63&t[e++])<<6|63&t[e++])-65536,i[s++]=55296+(o>>10),i[s++]=56320+(1023&o)):i[s++]=(15&o)<<12|(63&t[e++])<<6|63&t[e++],s>8191&&((n??(n=[])).push(String.fromCharCode.apply(String,i)),s=0);return null!=n?(s>0&&n.push(String.fromCharCode.apply(String,i.slice(0,s))),n.join("")):String.fromCharCode.apply(String,i.slice(0,s))}(t,0,t.length)}skip(t){if("number"==typeof t){if(this.pos+t>this.len)throw fu(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw fu(this)}while(0!=(128&this.buf[this.pos++]));return this}skipType(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(t=7&this.uint32());)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${t} at offset ${this.pos}`)}return this}readLongVarint(){const t=new au(0,0);let e=0;if(!(this.len-this.pos>4)){for(;e<3;++e){if(this.pos>=this.len)throw fu(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*e)>>>0,t}for(;e<4;++e)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;if(e=0,this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw fu(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw fu(this,8);const t=lu(this.buf,this.pos+=4),e=lu(this.buf,this.pos+=4);return new au(t,e)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){const t=function(t,e){let r=t[e],n=0;if(n+=r&Wc,r<Yc)return n;if(r=t[e+1],n+=(r&Wc)<<7,r<Yc)return n;if(r=t[e+2],n+=(r&Wc)<<14,r<Yc)return n;if(r=t[e+3],n+=(r&Wc)<<21,r<Yc)return n;if(r=t[e+4],n+=(r&Wc)*qc,r<Yc)return n;if(r=t[e+5],n+=(r&Wc)*Hc,r<Yc)return n;if(r=t[e+6],n+=(r&Wc)*Gc,r<Yc)return n;if(r=t[e+7],n+=(r&Wc)*Zc,r<Yc)return n;throw new RangeError("Could not decode varint")}(this.buf,this.pos);return this.pos+=Jc(t),t}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}}function yu(t,e,r){const n=function(t){return new du(t instanceof Uint8Array?t:t.subarray())}(t);return e.decode(n,void 0,r)}class pu{fn;len;next;val;constructor(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}}function wu(){}class gu{head;tail;len;next;constructor(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}}const bu=function(t){const e=8192;let r,n=e;return function(t){if(t<1||t>4096)return ri(t);n+t>e&&(r=ri(e),n=0);const i=r.subarray(n,n+=t);return 0!=(7&n)&&(n=1+(7|n)),i}}();class mu{len;head;tail;states;constructor(){this.len=0,this.head=new pu(wu,0,0),this.tail=this.head,this.states=null}_push(t,e,r){return this.tail=this.tail.next=new pu(t,e,r),this.len+=e,this}uint32(t){return this.len+=(this.tail=this.tail.next=new xu((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this}int32(t){return t<0?this._push(Au,10,au.fromNumber(t)):this.uint32(t)}sint32(t){return this.uint32((t<<1^t>>31)>>>0)}uint64(t){const e=au.fromBigInt(t);return this._push(Au,e.length(),e)}uint64Number(t){return this._push(Qc,Jc(t),t)}uint64String(t){return this.uint64(BigInt(t))}int64(t){return this.uint64(t)}int64Number(t){return this.uint64Number(t)}int64String(t){return this.uint64String(t)}sint64(t){const e=au.fromBigInt(t).zzEncode();return this._push(Au,e.length(),e)}sint64Number(t){const e=au.fromNumber(t).zzEncode();return this._push(Au,e.length(),e)}sint64String(t){return this.sint64(BigInt(t))}bool(t){return this._push(vu,1,t?1:0)}fixed32(t){return this._push(Su,4,t>>>0)}sfixed32(t){return this.fixed32(t)}fixed64(t){const e=au.fromBigInt(t);return this._push(Su,4,e.lo)._push(Su,4,e.hi)}fixed64Number(t){const e=au.fromNumber(t);return this._push(Su,4,e.lo)._push(Su,4,e.hi)}fixed64String(t){return this.fixed64(BigInt(t))}sfixed64(t){return this.fixed64(t)}sfixed64Number(t){return this.fixed64Number(t)}sfixed64String(t){return this.fixed64String(t)}float(t){return this._push(eu,4,t)}double(t){return this._push(iu,8,t)}bytes(t){const e=t.length>>>0;return 0===e?this._push(vu,1,0):this.uint32(e)._push(Iu,e,t)}string(t){const e=function(t){let e=0,r=0;for(let n=0;n<t.length;++n)r=t.charCodeAt(n),r<128?e+=1:r<2048?e+=2:55296==(64512&r)&&56320==(64512&t.charCodeAt(n+1))?(++n,e+=4):e+=3;return e}(t);return 0!==e?this.uint32(e)._push(hu,e,t):this._push(vu,1,0)}fork(){return this.states=new gu(this),this.head=this.tail=new pu(wu,0,0),this.len=0,this}reset(){return null!=this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new pu(wu,0,0),this.len=0),this}ldelim(){const t=this.head,e=this.tail,r=this.len;return this.reset().uint32(r),0!==r&&(this.tail.next=t.next,this.tail=e,this.len+=r),this}finish(){let t=this.head.next;const e=(r=this.len,null!=globalThis.Buffer?ri(r):bu(r));var r;let n=0;for(;null!=t;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e}}function vu(t,e,r){e[r]=255&t}function Eu(t,e,r){for(;t>127;)e[r++]=127&t|128,t>>>=7;e[r]=t}class xu extends pu{next;constructor(t,e){super(Eu,t,e),this.next=void 0}}function Au(t,e,r){for(;0!==t.hi;)e[r++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=127&t.lo|128,t.lo=t.lo>>>7;e[r++]=t.lo}function Su(t,e,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function Iu(t,e,r){e.set(t,r)}function ku(t,e,r){e.set(t,r)}function Bu(t,e,r){t.length<40?hu(t,e,r):null!=e.utf8Write?e.utf8Write(t,r):e.set(No(t),r)}function Tu(t,e){const r=new mu;return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var _u,Cu,Lu,Uu,Ou;function Nu(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function Pu(t,e){return Nu("message",_u.LENGTH_DELIMITED,t,e)}null!=globalThis.Buffer&&(mu.prototype.bytes=function(t){const e=t.length>>>0;return this.uint32(e),e>0&&this._push(ku,e,t),this},mu.prototype.string=function(t){const e=globalThis.Buffer.byteLength(t);return this.uint32(e),e>0&&this._push(Bu,e,t),this}),function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"}(_u||(_u={})),function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.ECDSA="ECDSA"}(Cu||(Cu={})),function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.secp256k1=2]="secp256k1",t[t.ECDSA=3]="ECDSA"}(Lu||(Lu={})),function(t){t.codec=()=>function(t){function e(e){if(null==t[e.toString()])throw new Error("Invalid enum value");return t[e]}return Nu("enum",_u.VARINT,(function(t,r){const n=e(t);r.int32(n)}),(function(t){return e(t.int32())}))}(Lu)}(Cu||(Cu={})),function(t){let e;t.codec=()=>(null==e&&(e=Pu(((t,e,r={})=>{!1!==r.lengthDelimited&&e.fork(),null!=t.Type&&(e.uint32(8),Cu.codec().encode(t.Type,e)),null!=t.Data&&(e.uint32(18),e.bytes(t.Data)),!1!==r.lengthDelimited&&e.ldelim()}),((t,e,r={})=>{const n={},i=null==e?t.len:t.pos+e;for(;t.pos<i;){const e=t.uint32();switch(e>>>3){case 1:n.Type=Cu.codec().decode(t);break;case 2:n.Data=t.bytes();break;default:t.skipType(7&e)}}return n}))),e),t.encode=e=>Tu(e,t.codec()),t.decode=(e,r)=>yu(e,t.codec(),r)}(Uu||(Uu={})),function(t){let e;t.codec=()=>(null==e&&(e=Pu(((t,e,r={})=>{!1!==r.lengthDelimited&&e.fork(),null!=t.Type&&(e.uint32(8),Cu.codec().encode(t.Type,e)),null!=t.Data&&(e.uint32(18),e.bytes(t.Data)),!1!==r.lengthDelimited&&e.ldelim()}),((t,e,r={})=>{const n={},i=null==e?t.len:t.pos+e;for(;t.pos<i;){const e=t.uint32();switch(e>>>3){case 1:n.Type=Cu.codec().decode(t);break;case 2:n.Data=t.bytes();break;default:t.skipType(7&e)}}return n}))),e),t.encode=e=>Tu(e,t.codec()),t.decode=(e,r)=>yu(e,t.codec(),r)}(Ou||(Ou={}));class Du extends Error{constructor(t="An error occurred while signing a message"){super(t),this.name="SigningError"}}class Ru extends Error{constructor(t="An error occurred while verifying a message"){super(t),this.name="VerificationError"}}class ju extends Error{constructor(t="Missing Web Crypto API"){super(t),this.name="WebCryptoMissingError"}}const Vu={get(t=globalThis){const e=t.crypto;if(null==e?.subtle)throw new ju("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api");return e}};const Mu=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),zu=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),$u=new Uint32Array(64);class Ku extends oa{constructor(){super(64,32,8,!1),this.A=0|zu[0],this.B=0|zu[1],this.C=0|zu[2],this.D=0|zu[3],this.E=0|zu[4],this.F=0|zu[5],this.G=0|zu[6],this.H=0|zu[7]}get(){const{A:t,B:e,C:r,D:n,E:i,F:o,G:s,H:a}=this;return[t,e,r,n,i,o,s,a]}set(t,e,r,n,i,o,s,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)$u[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=$u[t-15],r=$u[t-2],n=Xs(e,7)^Xs(e,18)^e>>>3,i=Xs(r,17)^Xs(r,19)^r>>>10;$u[t]=i+$u[t-7]+n+$u[t-16]|0}let{A:r,B:n,C:i,D:o,E:s,F:a,G:c,H:u}=this;for(let t=0;t<64;t++){const e=u+(Xs(s,6)^Xs(s,11)^Xs(s,25))+((h=s)&a^~h&c)+Mu[t]+$u[t]|0,f=(Xs(r,2)^Xs(r,13)^Xs(r,22))+ia(r,n,i)|0;u=c,c=a,a=s,s=o+e|0,o=i,i=n,n=r,r=e+f|0}var h;r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,n,i,o,s,a,c,u)}roundClean(){$u.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Fu=ra((()=>new Ku));class qu{type="RSA";jwk;_raw;_multihash;constructor(t,e){this.jwk=t,this._multihash=e}get raw(){return null==this._raw&&(this._raw=Wu(this.jwk)),this._raw}toMultihash(){return this._multihash}toCID(){return _s.createV1(114,this._multihash)}toString(){return ns.encode(this.toMultihash().bytes).substring(1)}equals(t){return null!=t&&t.raw instanceof Uint8Array&&ii(this.raw,t.raw)}verify(t,e){return async function(t,e,r){const n=await Vu.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Vu.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r instanceof Uint8Array?r:r.subarray())}(this.jwk,e,t)}}class Hu{type="RSA";jwk;_raw;publicKey;constructor(t,e){this.jwk=t,this.publicKey=e}get raw(){return null==this._raw&&(this._raw=function(t){if(null==t.n||null==t.e||null==t.d||null==t.p||null==t.q||null==t.dp||null==t.dq||null==t.qi)throw new Zn("JWK was missing components");return Ho([Fo(Uint8Array.from([0])),Fo(No(t.n,"base64url")),Fo(No(t.e,"base64url")),Fo(No(t.d,"base64url")),Fo(No(t.p,"base64url")),Fo(No(t.q,"base64url")),Fo(No(t.dp,"base64url")),Fo(No(t.dq,"base64url")),Fo(No(t.qi,"base64url"))]).subarray()}(this.jwk)),this._raw}equals(t){return null!=t&&t.raw instanceof Uint8Array&&ii(this.raw,t.raw)}sign(t){return async function(t,e){const r=await Vu.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Vu.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,e instanceof Uint8Array?e:e.subarray());return new Uint8Array(n,0,n.byteLength)}(this.jwk,t)}}const Gu=8192,Zu=18,Yu=Uint8Array.from([48,13,6,9,42,134,72,134,247,13,1,1,1,5,0]);function Wu(t){if(null==t.n||null==t.e)throw new Zn("JWK was missing components");return Ho([Yu,qo(Ho([Fo(No(t.n,"base64url")),Fo(No(t.e,"base64url"))]))]).subarray()}function Ju(t){return function(t){if(function(t){if("RSA"!==t.kty)throw new Zn("invalid key type");if(null==t.n)throw new Zn("invalid key modulus");return 8*No(t.n,"base64url").length}(t)>Gu)throw new Zn("Key size is too large");const e=function(t){if(null==t)throw new Zn("Missing key parameter");return{privateKey:t,publicKey:{kty:t.kty,n:t.n,e:t.e}}}(t),r=Fu(Uu.encode({Type:Cu.RSA,Data:Wu(e.publicKey)})),n=Ss(Zu,r);return new Hu(e.privateKey,new qu(e.publicKey,n))}(function(t){return{n:Po(t[1],"base64url"),e:Po(t[2],"base64url"),d:Po(t[3],"base64url"),p:Po(t[4],"base64url"),q:Po(t[5],"base64url"),dp:Po(t[6],"base64url"),dq:Po(t[7],"base64url"),qi:Po(t[8],"base64url"),kty:"RSA"}}(t))}function Qu(t,e,r){const n=function(t){const e=Mo(t[1],{offset:0});return{kty:"RSA",n:Po(e[0],"base64url"),e:Po(e[1],"base64url")}}(t);if(null==r){const t=Fu(Uu.encode({Type:Cu.RSA,Data:e}));r=Ss(Zu,t)}return new qu(n,r)}class Xu extends ea{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,function(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");Zs(t.outputLen),Zs(t.blockLen)}(t);const r=ta(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?t.create().update(r).digest():r);for(let t=0;t<i.length;t++)i[t]^=54;this.iHash.update(i),this.oHash=t.create();for(let t=0;t<i.length;t++)i[t]^=106;this.oHash.update(i),i.fill(0)}update(t){return Ws(this),this.iHash.update(t),this}digestInto(t){Ws(this),Ys(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:n,destroyed:i,blockLen:o,outputLen:s}=this;return t.finished=n,t.destroyed=i,t.blockLen=o,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const th=(t,e,r)=>new Xu(t,e).update(r).digest();function eh(t){void 0!==t.lowS&&xa("lowS",t.lowS),void 0!==t.prehash&&xa("prehash",t.prehash)}th.create=(t,e)=>new Xu(t,e);const{bytesToNumberBE:rh,hexToBytes:nh}=g;class ih extends Error{constructor(t=""){super(t)}}const oh={Err:ih,_tlv:{encode:(t,e)=>{const{Err:r}=oh;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(1&e.length)throw new r("tlv.encode: unpadded data");const n=e.length/2,i=Ia(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const o=n>127?Ia(i.length/2|128):"";return Ia(t)+o+i+e},decode(t,e){const{Err:r}=oh;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const i=e[n++];let o=0;if(128&i){const t=127&i;if(!t)throw new r("tlv.decode(long): indefinite length not supported");if(t>4)throw new r("tlv.decode(long): byte length is too big");const s=e.subarray(n,n+t);if(s.length!==t)throw new r("tlv.decode: length bytes not complete");if(0===s[0])throw new r("tlv.decode(long): zero leftmost byte");for(const t of s)o=o<<8|t;if(n+=t,o<128)throw new r("tlv.decode(long): not minimal encoding")}else o=i;const s=e.subarray(n,n+o);if(s.length!==o)throw new r("tlv.decode: wrong value length");return{v:s,l:e.subarray(n+o)}}},_int:{encode(t){const{Err:e}=oh;if(t<sh)throw new e("integer: negative integers are not allowed");let r=Ia(t);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=oh;if(128&t[0])throw new e("invalid signature integer: negative");if(0===t[0]&&!(128&t[1]))throw new e("invalid signature integer: unnecessary leading zero");return rh(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=oh,i="string"==typeof t?nh(t):t;Ea(i);const{v:o,l:s}=n.decode(48,i);if(s.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,o),{v:u,l:h}=n.decode(2,c);if(h.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(u)}},hexFromSig(t){const{_tlv:e,_int:r}=oh,n=e.encode(2,r.encode(t.r))+e.encode(2,r.encode(t.s));return e.encode(48,n)}},sh=BigInt(0),ah=BigInt(1),ch=(BigInt(2),BigInt(3));function uh(t){const e=function(t){const e=mc(t);return qa(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:r,n}=e,i=r.BYTES+1,o=2*r.BYTES+1;function s(t){return tc(t,n)}function a(t){return nc(t,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:f}=function(t){const e=function(t){const e=mc(t);qa(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:r}=e,n=sc(e.n,e.nBitLength),i=e.toBytes||((t,e,n)=>{const i=e.toAffine();return Pa(Uint8Array.from([4]),r.toBytes(i.x),r.toBytes(i.y))}),o=e.fromBytes||(t=>{const e=t.subarray(1);return{x:r.fromBytes(e.subarray(0,r.BYTES)),y:r.fromBytes(e.subarray(r.BYTES,2*r.BYTES))}});function s(t){const{a:n,b:i}=e,o=r.sqr(t),s=r.mul(o,t);return r.add(r.add(s,r.mul(t,n)),i)}if(!r.eql(r.sqr(e.Gy),s(e.Gx)))throw new Error("bad generator point: equation left != right");function a(t){const{allowedPrivateKeyLengths:r,nByteLength:n,wrapPrivateKey:i,n:o}=e;if(r&&"bigint"!=typeof t){if(va(t)&&(t=Sa(t)),"string"!=typeof t||!r.includes(t.length))throw new Error("invalid private key");t=t.padStart(2*n,"0")}let s;try{s="bigint"==typeof t?t:Ca(Na("private key",t,n))}catch(e){throw new Error("invalid private key, expected hex or "+n+" bytes, got "+typeof t)}return i&&(s=tc(s,o)),ja("private key",s,ah,o),s}function c(t){if(!(t instanceof f))throw new Error("ProjectivePoint expected")}const u=Ha(((t,e)=>{const{px:n,py:i,pz:o}=t;if(r.eql(o,r.ONE))return{x:n,y:i};const s=t.is0();null==e&&(e=s?r.ONE:r.inv(o));const a=r.mul(n,e),c=r.mul(i,e),u=r.mul(o,e);if(s)return{x:r.ZERO,y:r.ZERO};if(!r.eql(u,r.ONE))throw new Error("invZ was invalid");return{x:a,y:c}})),h=Ha((t=>{if(t.is0()){if(e.allowInfinityPoint&&!r.is0(t.py))return;throw new Error("bad point: ZERO")}const{x:n,y:i}=t.toAffine();if(!r.isValid(n)||!r.isValid(i))throw new Error("bad point: x or y not FE");const o=r.sqr(i),a=s(n);if(!r.eql(o,a))throw new Error("bad point: equation left != right");if(!t.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}));class f{constructor(t,e,n){if(this.px=t,this.py=e,this.pz=n,null==t||!r.isValid(t))throw new Error("x required");if(null==e||!r.isValid(e))throw new Error("y required");if(null==n||!r.isValid(n))throw new Error("z required");Object.freeze(this)}static fromAffine(t){const{x:e,y:n}=t||{};if(!t||!r.isValid(e)||!r.isValid(n))throw new Error("invalid affine point");if(t instanceof f)throw new Error("projective point not allowed");const i=t=>r.eql(t,r.ZERO);return i(e)&&i(n)?f.ZERO:new f(e,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){const e=r.invertBatch(t.map((t=>t.pz)));return t.map(((t,r)=>t.toAffine(e[r]))).map(f.fromAffine)}static fromHex(t){const e=f.fromAffine(o(Na("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return f.BASE.multiply(a(t))}static msm(t,e){return bc(f,n,t,e)}_setWindowSize(t){d.setWindowSize(this,t)}assertValidity(){h(this)}hasEvenY(){const{y:t}=this.toAffine();if(r.isOdd)return!r.isOdd(t);throw new Error("Field doesn't support isOdd")}equals(t){c(t);const{px:e,py:n,pz:i}=this,{px:o,py:s,pz:a}=t,u=r.eql(r.mul(e,a),r.mul(o,i)),h=r.eql(r.mul(n,a),r.mul(s,i));return u&&h}negate(){return new f(this.px,r.neg(this.py),this.pz)}double(){const{a:t,b:n}=e,i=r.mul(n,ch),{px:o,py:s,pz:a}=this;let c=r.ZERO,u=r.ZERO,h=r.ZERO,l=r.mul(o,o),d=r.mul(s,s),y=r.mul(a,a),p=r.mul(o,s);return p=r.add(p,p),h=r.mul(o,a),h=r.add(h,h),c=r.mul(t,h),u=r.mul(i,y),u=r.add(c,u),c=r.sub(d,u),u=r.add(d,u),u=r.mul(c,u),c=r.mul(p,c),h=r.mul(i,h),y=r.mul(t,y),p=r.sub(l,y),p=r.mul(t,p),p=r.add(p,h),h=r.add(l,l),l=r.add(h,l),l=r.add(l,y),l=r.mul(l,p),u=r.add(u,l),y=r.mul(s,a),y=r.add(y,y),l=r.mul(y,p),c=r.sub(c,l),h=r.mul(y,d),h=r.add(h,h),h=r.add(h,h),new f(c,u,h)}add(t){c(t);const{px:n,py:i,pz:o}=this,{px:s,py:a,pz:u}=t;let h=r.ZERO,l=r.ZERO,d=r.ZERO;const y=e.a,p=r.mul(e.b,ch);let w=r.mul(n,s),g=r.mul(i,a),b=r.mul(o,u),m=r.add(n,i),v=r.add(s,a);m=r.mul(m,v),v=r.add(w,g),m=r.sub(m,v),v=r.add(n,o);let E=r.add(s,u);return v=r.mul(v,E),E=r.add(w,b),v=r.sub(v,E),E=r.add(i,o),h=r.add(a,u),E=r.mul(E,h),h=r.add(g,b),E=r.sub(E,h),d=r.mul(y,v),h=r.mul(p,b),d=r.add(h,d),h=r.sub(g,d),d=r.add(g,d),l=r.mul(h,d),g=r.add(w,w),g=r.add(g,w),b=r.mul(y,b),v=r.mul(p,v),g=r.add(g,b),b=r.sub(w,b),b=r.mul(y,b),v=r.add(v,b),w=r.mul(g,v),l=r.add(l,w),w=r.mul(E,v),h=r.mul(m,h),h=r.sub(h,w),w=r.mul(m,g),d=r.mul(E,d),d=r.add(d,w),new f(h,l,d)}subtract(t){return this.add(t.negate())}is0(){return this.equals(f.ZERO)}wNAF(t){return d.wNAFCached(this,t,f.normalizeZ)}multiplyUnsafe(t){const{endo:n,n:i}=e;ja("scalar",t,sh,i);const o=f.ZERO;if(t===sh)return o;if(this.is0()||t===ah)return this;if(!n||d.hasPrecomputes(this))return d.wNAFCachedUnsafe(this,t,f.normalizeZ);let{k1neg:s,k1:a,k2neg:c,k2:u}=n.splitScalar(t),h=o,l=o,y=this;for(;a>sh||u>sh;)a&ah&&(h=h.add(y)),u&ah&&(l=l.add(y)),y=y.double(),a>>=ah,u>>=ah;return s&&(h=h.negate()),c&&(l=l.negate()),l=new f(r.mul(l.px,n.beta),l.py,l.pz),h.add(l)}multiply(t){const{endo:n,n:i}=e;let o,s;if(ja("scalar",t,ah,i),n){const{k1neg:e,k1:i,k2neg:a,k2:c}=n.splitScalar(t);let{p:u,f:h}=this.wNAF(i),{p:l,f:y}=this.wNAF(c);u=d.constTimeNegate(e,u),l=d.constTimeNegate(a,l),l=new f(r.mul(l.px,n.beta),l.py,l.pz),o=u.add(l),s=h.add(y)}else{const{p:e,f:r}=this.wNAF(t);o=e,s=r}return f.normalizeZ([o,s])[0]}multiplyAndAddUnsafe(t,e,r){const n=f.BASE,i=(t,e)=>e!==sh&&e!==ah&&t.equals(n)?t.multiply(e):t.multiplyUnsafe(e),o=i(this,e).add(i(t,r));return o.is0()?void 0:o}toAffine(t){return u(this,t)}isTorsionFree(){const{h:t,isTorsionFree:r}=e;if(t===ah)return!0;if(r)return r(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:t,clearCofactor:r}=e;return t===ah?this:r?r(f,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return xa("isCompressed",t),this.assertValidity(),i(f,this,t)}toHex(t=!0){return xa("isCompressed",t),Sa(this.toRawBytes(t))}}f.BASE=new f(e.Gx,e.Gy,r.ONE),f.ZERO=new f(r.ZERO,r.ONE,r.ZERO);const l=e.nBitLength,d=gc(f,e.endo?Math.ceil(l/2):l);return{CURVE:e,ProjectivePoint:f,normPrivateKeyToScalar:a,weierstrassEquation:s,isWithinCurveOrder:function(t){return Ra(t,ah,e.n)}}}({...e,toBytes(t,e,n){const i=e.toAffine(),o=r.toBytes(i.x),s=Pa;return xa("isCompressed",n),n?s(Uint8Array.from([e.hasEvenY()?2:3]),o):s(Uint8Array.from([4]),o,r.toBytes(i.y))},fromBytes(t){const e=t.length,n=t[0],s=t.subarray(1);if(e!==i||2!==n&&3!==n){if(e===o&&4===n)return{x:r.fromBytes(s.subarray(0,r.BYTES)),y:r.fromBytes(s.subarray(r.BYTES,2*r.BYTES))};throw new Error("invalid Point, expected length of "+i+", or uncompressed "+o+", got "+e)}{const t=Ca(s);if(!Ra(t,ah,r.ORDER))throw new Error("Point is not on curve");const e=h(t);let i;try{i=r.sqrt(e)}catch(t){const e=t instanceof Error?": "+t.message:"";throw new Error("Point is not on curve"+e)}return 1==(1&n)!=((i&ah)===ah)&&(i=r.neg(i)),{x:t,y:i}}}}),l=t=>Sa(Ua(t,e.nByteLength));function d(t){return t>n>>ah}const y=(t,e,r)=>Ca(t.slice(e,r));class p{constructor(t,e,r){this.r=t,this.s=e,this.recovery=r,this.assertValidity()}static fromCompact(t){const r=e.nByteLength;return t=Na("compactSignature",t,2*r),new p(y(t,0,r),y(t,r,2*r))}static fromDER(t){const{r:e,s:r}=oh.toSig(Na("DER",t));return new p(e,r)}assertValidity(){ja("r",this.r,ah,n),ja("s",this.s,ah,n)}addRecoveryBit(t){return new p(this.r,this.s,t)}recoverPublicKey(t){const{r:n,s:i,recovery:o}=this,u=m(Na("msgHash",t));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");const h=2===o||3===o?n+e.n:n;if(h>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const f=0==(1&o)?"02":"03",d=c.fromHex(f+l(h)),y=a(h),p=s(-u*y),w=s(i*y),g=c.BASE.multiplyAndAddUnsafe(d,p,w);if(!g)throw new Error("point at infinify");return g.assertValidity(),g}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new p(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return _a(this.toDERHex())}toDERHex(){return oh.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return _a(this.toCompactHex())}toCompactHex(){return l(this.r)+l(this.s)}}const w={isValidPrivateKey(t){try{return u(t),!0}catch(t){return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const t=cc(e.n);return function(t,e,r=!1){const n=t.length,i=ac(e),o=cc(e);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);const s=tc(r?La(t):Ca(t),e-Za)+Za;return r?Oa(s,i):Ua(s,i)}(e.randomBytes(t),e.n)},precompute:(t=8,e=c.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)};function g(t){const e=va(t),r="string"==typeof t,n=(e||r)&&t.length;return e?n===i||n===o:r?n===2*i||n===2*o:t instanceof c}const b=e.bits2int||function(t){if(t.length>8192)throw new Error("input is too large");const r=Ca(t),n=8*t.length-e.nBitLength;return n>0?r>>BigInt(n):r},m=e.bits2int_modN||function(t){return s(b(t))},v=Ma(e.nBitLength);function E(t){return ja("num < 2^"+e.nBitLength,t,sh,v),Ua(t,e.nByteLength)}const x={lowS:e.lowS,prehash:!1},A={lowS:e.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(t,e=!0){return c.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,r=!0){if(g(t))throw new Error("first arg must be private key");if(!g(e))throw new Error("second arg must be public key");return c.fromHex(e).multiply(u(t)).toRawBytes(r)},sign:function(t,n,i=x){const{seed:o,k2sig:h}=function(t,n,i=x){if(["recovered","canonical"].some((t=>t in i)))throw new Error("sign() legacy options not supported");const{hash:o,randomBytes:h}=e;let{lowS:l,prehash:y,extraEntropy:w}=i;null==l&&(l=!0),t=Na("msgHash",t),eh(i),y&&(t=Na("prehashed msgHash",o(t)));const g=m(t),v=u(n),A=[E(v),E(g)];if(null!=w&&!1!==w){const t=!0===w?h(r.BYTES):w;A.push(Na("extraEntropy",t))}const S=Pa(...A),I=g;return{seed:S,k2sig:function(t){const e=b(t);if(!f(e))return;const r=a(e),n=c.BASE.multiply(e).toAffine(),i=s(n.x);if(i===sh)return;const o=s(r*s(I+i*v));if(o===sh)return;let u=(n.x===i?0:2)|Number(n.y&ah),h=o;return l&&d(o)&&(h=function(t){return d(t)?s(-t):t}(o),u^=1),new p(i,h,u)}}}(t,n,i),l=e;return Ka(l.hash.outputLen,l.nByteLength,l.hmac)(o,h)},verify:function(t,r,n,i=A){const o=t;r=Na("msgHash",r),n=Na("publicKey",n);const{lowS:u,prehash:h,format:f}=i;if(eh(i),"strict"in i)throw new Error("options.strict was renamed to lowS");if(void 0!==f&&"compact"!==f&&"der"!==f)throw new Error("format must be compact or der");const l="string"==typeof o||va(o),d=!l&&!f&&"object"==typeof o&&null!==o&&"bigint"==typeof o.r&&"bigint"==typeof o.s;if(!l&&!d)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let y,w;try{if(d&&(y=new p(o.r,o.s)),l){try{"compact"!==f&&(y=p.fromDER(o))}catch(t){if(!(t instanceof oh.Err))throw t}y||"der"===f||(y=p.fromCompact(o))}w=c.fromHex(n)}catch(t){return!1}if(!y)return!1;if(u&&y.hasHighS())return!1;h&&(r=e.hash(r));const{r:g,s:b}=y,v=m(r),E=a(b),x=s(v*E),S=s(g*E),I=c.BASE.multiplyAndAddUnsafe(w,x,S)?.toAffine();return!!I&&s(I.x)===g},ProjectivePoint:c,Signature:p,utils:w}}function hh(t){return{hash:t,hmac:(e,...r)=>th(t,e,function(...t){let e=0;for(let r=0;r<t.length;r++){const n=t[r];Ys(n),e+=n.length}const r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){const i=t[e];r.set(i,n),n+=i.length}return r}(...r)),randomBytes:na}}BigInt(4);const fh=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),lh=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),dh=BigInt(1),yh=BigInt(2),ph=(t,e)=>(t+e/yh)/e;const wh=sc(fh,void 0,void 0,{sqrt:function(t){const e=fh,r=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),u=t*t*t%e,h=u*u*t%e,f=rc(h,r,e)*h%e,l=rc(f,r,e)*h%e,d=rc(l,yh,e)*u%e,y=rc(d,i,e)*d%e,p=rc(y,o,e)*y%e,w=rc(p,a,e)*p%e,g=rc(w,c,e)*w%e,b=rc(g,a,e)*p%e,m=rc(b,r,e)*h%e,v=rc(m,s,e)*y%e,E=rc(v,n,e)*u%e,x=rc(E,yh,e);if(!wh.eql(wh.sqr(x),t))throw new Error("Cannot find square root");return x}}),gh=function(t,e){const r=e=>uh({...t,...hh(e)});return{...r(e),create:r}}({a:BigInt(0),b:BigInt(7),Fp:wh,n:lh,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=lh,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-dh*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,s=BigInt("0x100000000000000000000000000000000"),a=ph(o*t,e),c=ph(-n*t,e);let u=tc(t-a*r-c*i,e),h=tc(-a*n-c*o,e);const f=u>s,l=h>s;if(f&&(u=e-u),l&&(h=e-h),u>s||h>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:f,k1:u,k2neg:l,k2:h}}}},Fu);function bh({name:t,code:e,encode:r}){return new mh(t,e,r)}BigInt(0),gh.ProjectivePoint;class mh{name;code;encode;constructor(t,e,r){this.name=t,this.code=e,this.encode=r}digest(t){if(t instanceof Uint8Array){const e=this.encode(t);return e instanceof Uint8Array?Ss(this.code,e):e.then((t=>Ss(this.code,t)))}throw Error("Unknown type, must be binary type")}}function vh(t){return async e=>new Uint8Array(await crypto.subtle.digest(t,e))}const Eh=bh({name:"sha2-256",code:18,encode:vh("SHA-256")});function xh(t){return null!=t&&"function"==typeof t.then&&"function"==typeof t.catch&&"function"==typeof t.finally}bh({name:"sha2-512",code:19,encode:vh("SHA-512")});class Ah{type="secp256k1";raw;_key;constructor(t){this._key=function(t){try{return gh.ProjectivePoint.fromHex(t),t}catch(t){throw new Yn(String(t))}}(t),this.raw=function(t){return gh.ProjectivePoint.fromHex(t).toRawBytes(!0)}(this._key)}toMultihash(){return Ps(Bh(this))}toCID(){return _s.createV1(114,this.toMultihash())}toString(){return ns.encode(this.toMultihash().bytes).substring(1)}equals(t){return null!=t&&t.raw instanceof Uint8Array&&ii(this.raw,t.raw)}verify(t,e){return function(t,e,r){const n=Eh.digest(r instanceof Uint8Array?r:r.subarray());if(xh(n))return n.then((({digest:r})=>gh.verify(e,r,t))).catch((t=>{throw new Ru(String(t))}));try{return gh.verify(e,n.digest,t)}catch(t){throw new Ru(String(t))}}(this._key,e,t)}}class Sh{type="secp256k1";raw;publicKey;constructor(t,e){this.raw=function(t){try{return gh.getPublicKey(t,!0),t}catch(t){throw new Wn(String(t))}}(t),this.publicKey=new Ah(e??function(t){try{return gh.getPublicKey(t,!0)}catch(t){throw new Wn(String(t))}}(t))}equals(t){return null!=t&&t.raw instanceof Uint8Array&&ii(this.raw,t.raw)}sign(t){return function(t,e){const r=Eh.digest(e instanceof Uint8Array?e:e.subarray());if(xh(r))return r.then((({digest:e})=>gh.sign(e,t).toDERRawBytes())).catch((t=>{throw new Du(String(t))}));try{return gh.sign(r.digest,t).toDERRawBytes()}catch(t){throw new Du(String(t))}}(this.raw,t)}}async function Ih(t,e){if("Ed25519"===t)return async function(){const{privateKey:t,publicKey:e}=function(){const t=Pc.utils.randomPrivateKey(),e=Pc.getPublicKey(t);return{privateKey:jc(t,e),publicKey:e}}();return new Mc(t,e)}();if("secp256k1"===t)return async function(){const t=gh.utils.randomPrivateKey();return new Sh(t)}();if("RSA"===t)return async function(t){if(t>Gu)throw new Zn("Key size is too large");const e=await async function(t){const e=await Vu.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await async function(t){if(null==t.privateKey||null==t.publicKey)throw new Zn("Private and public key are required");return Promise.all([Vu.get().subtle.exportKey("jwk",t.privateKey),Vu.get().subtle.exportKey("jwk",t.publicKey)])}(e);return{privateKey:r[0],publicKey:r[1]}}(t),r=Fu(Uu.encode({Type:Cu.RSA,Data:Wu(e.publicKey)})),n=Ss(Zu,r);return new Hu(e.privateKey,new qu(e.publicKey,n))}(function(t){return null==t?2048:parseInt(t,10)}(e));if("ECDSA"===t)return async function(t="P-256"){const e=await async function(t="P-256"){const e=await crypto.subtle.generateKey({name:"ECDSA",namedCurve:t},!0,["sign","verify"]);return{publicKey:await crypto.subtle.exportKey("jwk",e.publicKey),privateKey:await crypto.subtle.exportKey("jwk",e.privateKey)}}(t);return new Rs(e.privateKey)}(function(t){if("P-256"===t||null==t)return"P-256";if("P-384"===t)return"P-384";if("P-521"===t)return"P-521";throw new Zn("Unsupported curve, should be P-256, P-384 or P-521")}(e));throw new Jn}function kh(t){if(32===t.byteLength)return e=zc(e=t,32),new Vc(e);if(33===t.byteLength)return function(t){return new Ah(t)}(t);var e;const r=Mo(t),n=r[1]?.[0];if(n===Qn||n===Xn||n===ti)return function(t){const e=t[1][1][0];let r,n;if(e.byteLength===2*Fs+1)return r=Po(e.subarray(1,1+Fs),"base64url"),n=Po(e.subarray(1+Fs),"base64url"),new Ds({...zs,key_ops:["verify"],x:r,y:n});if(e.byteLength===2*qs+1)return r=Po(e.subarray(1,1+qs),"base64url"),n=Po(e.subarray(1+qs),"base64url"),new Ds({...$s,key_ops:["verify"],x:r,y:n});if(e.byteLength===2*Hs+1)return r=Po(e.subarray(1,1+Hs),"base64url"),n=Po(e.subarray(1+Hs),"base64url"),new Ds({...Ks,key_ops:["verify"],x:r,y:n});throw new Zn(`coordinates were wrong length, got ${e.byteLength}, expected 65, 97 or 133`)}(r);if("1.2.840.113549.1.1.1"===r[0]?.[0])return Qu(r,t);throw new Zn("Could not extract public key from raw bytes")}function Bh(t){return Uu.encode({Type:Cu[t.type],Data:t.raw})}function Th(t){if(t.byteLength===Dc)return function(t){if(t.length>Dc){const e=(t=zc(t,Dc+32)).subarray(0,Dc),r=t.subarray(Dc,t.length);return new Mc(e,r)}const e=(t=zc(t,Dc)).subarray(0,Dc),r=t.subarray(32);return new Mc(e,r)}(t);if(32===t.byteLength)return new Sh(t);const e=Mo(t),r=e[2]?.[0];if(r===Qn||r===Xn||r===ti)return function(t){const e=t[1],r=Po(e,"base64url"),n=t[2][1][0];let i,o;if(e.byteLength===Fs)return i=Po(n.subarray(1,1+Fs),"base64url"),o=Po(n.subarray(1+Fs),"base64url"),new Rs({...zs,key_ops:["sign"],d:r,x:i,y:o});if(e.byteLength===qs)return i=Po(n.subarray(1,1+qs),"base64url"),o=Po(n.subarray(1+qs),"base64url"),new Rs({...$s,key_ops:["sign"],d:r,x:i,y:o});if(e.byteLength===Hs)return i=Po(n.subarray(1,1+Hs),"base64url"),o=Po(n.subarray(1+Hs),"base64url"),new Rs({...Ks,key_ops:["sign"],d:r,x:i,y:o});throw new Zn(`Private key length was wrong length, got ${e.byteLength}, expected 32, 48 or 66`)}(e);if(e.length>8)return Ju(e);throw new Zn("Could not extract private key from raw bytes")}const _h=async(t,e)=>{if(!t)throw new Error("No signing key given");if(!e)throw new Error("Given input data was undefined");return e instanceof Uint8Array||(e="string"==typeof e?No(e):new Uint8Array(e)),Po(await t.sign(e),"base16")},Ch=Cn({size:1e3}),Lh=async(t,e,r)=>{const n=await Ch,i=await n.get(t);let o=!1;if(i){const t=(t,e)=>e instanceof Uint8Array?0===function(t,e){for(let r=0;r<t.byteLength;r++){if(t[r]<e[r])return-1;if(t[r]>e[r])return 1}return t.byteLength>e.byteLength?1:t.byteLength<e.byteLength?-1:0}(t,e):t.toString()===e.toString();o=i.publicKey===e&&t(i.data,r)}else{const i=await(async(t,e,r)=>{if(!t)throw new Error("No signature given");if(!e)throw new Error("Given publicKey was undefined");if(!r)throw new Error("Given input data was undefined");r instanceof Uint8Array||(r="string"==typeof r?No(r):new Uint8Array(r));let n=!1;try{const a=kh(No(e,"base16"));n=await(i=a,o=r,s=No(t,"base16"),i.verify(o,s))}catch(t){}var i,o,s;return Promise.resolve(n)})(t,e,r);o=i,i&&await n.put(t,{publicKey:e,data:r})}return o},Uh=async({storage:t,path:e}={})=>{t=t||await In(await Cn({size:1e3}),await Tn({path:e||"./keystore"}));const r=await Cn({size:1e3}),n=async(e,n)=>{const{privateKey:i}=n;await t.put("private_"+e,i);const o=Th(i);await r.put(e,o)};return{clear:async()=>{await t.clear(),await r.clear()},close:async()=>{await t.close(),await r.close()},hasKey:async e=>{if(!e)throw new Error("id needed to check a key");let n=!1,i=await r.get(e);if(i)n=!0;else try{i=await t.get("private_"+e),n=null!=i}catch(t){console.error("Error: ENOENT: no such file or directory")}return n},addKey:n,createKey:async t=>{if(!t)throw new Error("id needed to create a key");const e=await Ih("secp256k1"),r={publicKey:e.publicKey.raw,privateKey:e.raw};return await n(t,r),e},getKey:async e=>{if(!e)throw new Error("id needed to get a key");let n=await r.get(e);if(!n){let i;try{i=await t.get("private_"+e)}catch(t){}if(!i)return;n=Th(i),await r.put(e,n)}return n},getPublic:(t,e={})=>{const r=e.format||"hex";if(-1===["hex","buffer"].indexOf(r))throw new Error("Supported formats are `hex` and `buffer`");const n=t.publicKey.raw;return"buffer"===r?n:Po(n,"base16")}}},Oh=t,Nh=sn,Ph=X,Dh=async({id:t,publicKey:e,signatures:r,type:n,sign:i,verify:o}={})=>{if(!t)throw new Error("Identity id is required");if(!e)throw new Error("Invalid public key");if(!r)throw new Error("Signatures object is required");if(!r.id)throw new Error("Signature of id is required");if(!r.publicKey)throw new Error("Signature of publicKey+id is required");if(!n)throw new Error("Identity type is required");const s={id:t,publicKey:e,signatures:r=Object.assign({},r),type:n,sign:i,verify:o},{hash:a,bytes:c}=await Rh(s);return s.hash=a,s.bytes=c,s},Rh=async t=>{const{id:e,publicKey:r,signatures:n,type:i}=t,o={id:e,publicKey:r,signatures:n,type:i},{cid:s,bytes:a}=await Vt({value:o,codec:Oh,hasher:Nh});return{hash:s.toString(Ph),bytes:Uint8Array.from(a)}},jh=t=>Boolean(t.id&&t.hash&&t.bytes&&t.publicKey&&t.signatures&&t.signatures.id&&t.signatures.publicKey&&t.type),Vh="publickey",Mh=({keystore:t})=>async()=>{if(!t)throw new Error("PublicKeyIdentityProvider requires a keystore parameter");return{type:Vh,getId:async({id:e}={})=>{if(!e)throw new Error("id is required");return Po((await t.getKey(e)||await t.createKey(e)).publicKey.raw,"base16")},signIdentity:async(e,{id:r}={})=>{if(!r)throw new Error("id is required");const n=await t.getKey(r);if(!n)throw new Error(`Signing key for '${r}' not found`);return _h(n,e)}}};Mh.verifyIdentity=async t=>{const{id:e,publicKey:r,signatures:n}=t;return Lh(n.publicKey,e,r+n.id)},Mh.type=Vh;const zh=Mh,$h={},Kh=t=>{if(!(t=>Object.keys($h).includes(t))(t))throw new Error(`IdentityProvider type '${t}' is not supported`);return $h[t]},Fh=t=>{if(!t.type||"string"!=typeof t.type)throw new Error("Given IdentityProvider doesn't have a field 'type'.");if(!t.verifyIdentity)throw new Error("Given IdentityProvider doesn't have a function 'verifyIdentity'.");$h[t.type]=t};Fh(zh);const qh=V("./orbitdb","identities"),Hh=async({keystore:t,path:e,storage:r,ipfs:n}={})=>{t=t||await Uh({path:e||qh}),r||(r=n?await In(await Cn({size:1e3}),await kn({ipfs:n,pin:!0})):await pn());const i=await Cn({size:1e3}),o=async(e,r)=>{const n=await t.getKey(e.id);if(!n)throw new Error("Private signing key not found from KeyStore");return await _h(n,r)},s=async(t,e,r)=>await Lh(t,e,r);return{createIdentity:async(e={})=>{e.keystore=t;const n=Kh("publickey"),i=e.provider||n({keystore:t}),a=await i();if(!Kh(a.type))throw new Error("Identity provider is unknown. Use useIdentityProvider(provider) to register the identity provider");const c=await a.getId(e),u=await t.getKey(c)||await t.createKey(c),h=t.getPublic(u),f=await _h(u,c),l={id:f,publicKey:await a.signIdentity(h+f,e)},d=await Dh({id:c,publicKey:h,signatures:l,type:a.type,sign:o,verify:s});return await r.put(d.hash,d.bytes),d},verifyIdentity:async t=>{if(!jh(t))return!1;const{id:e,publicKey:r,signatures:n}=t;if(!await s(n.id,r,e))return!1;const o=await i.get(n.id);if(o)return c=o,(a=t).id===c.id&&a.hash===c.hash&&a.type===c.type&&a.publicKey===c.publicKey&&a.signatures.id===c.signatures.id&&a.signatures.publicKey===c.signatures.publicKey;var a,c;const u=Kh(t.type),h=await u.verifyIdentity(t);return h&&await i.put(n.id,t),h},getIdentity:async t=>{const e=await r.get(t);if(e)return(async t=>{const{value:e}=await Mt({bytes:t,codec:Oh,hasher:Nh});return Dh({...e})})(e)},sign:o,verify:s,keystore:t}},Gh=t=>{if(!(t=t.toString()).startsWith("/orbitdb")&&!t.startsWith("\\orbitdb"))return!1;let e;t=(t=(t=(t=t.replaceAll("/orbitdb/","")).replaceAll("\\orbitdb\\","")).replaceAll("/","")).replaceAll("\\","");try{e=At.parse(t,X)}catch(t){return!1}return void 0!==e},Zh=t=>{if(!t)throw new Error(`Not a valid OrbitDB address: ${t}`);if(!Gh(t))throw new Error(`Not a valid OrbitDB address: ${t}`);return Yh(t)},Yh=t=>{if(t&&"orbitdb"===t.protocol&&t.hash)return t;const e="orbitdb",r=t.replace("/orbitdb/","").replace("\\orbitdb\\","");return{protocol:e,hash:r,address:t,toString:()=>j("/",e,r)}},Wh=t,Jh=sn,Qh=X,Xh=async(t=32)=>{let e="",r=0;for(;r<t;)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random())),r+=1;return e},tf=t,ef=sn,rf=X,nf="ipfs",of=({write:t,storage:e}={})=>async({orbitdb:r,identities:n,address:i})=>{if(e=e||await In(await Cn({size:1e3}),await kn({ipfs:r.ipfs,pin:!0})),t=t||[r.identity.id],i){const r=await e.get(i.replaceAll("/ipfs/","")),{value:n}=await Mt({bytes:r,codec:tf,hasher:ef});t=n.write}else i=await(async({storage:t,type:e,params:r})=>{const n={type:e,...r},{cid:i,bytes:o}=await Vt({value:n,codec:tf,hasher:ef}),s=i.toString(rf);return await t.put(s,o),s})({storage:e,type:nf,params:{write:t}}),i=V("/",nf,i);return{type:nf,address:i,write:t,canAppend:async e=>{const r=await n.getIdentity(e.identity);if(!r)return!1;const{id:i}=r;return!(!t.includes(i)&&!t.includes("*"))&&await n.verifyIdentity(r)}}};of.type=nf;const sf=of,af="orbitdb",cf=({write:t}={})=>async({orbitdb:e,identities:r,address:n,name:i})=>{n=n||i||await Xh(64),t=t||[e.identity.id];const o=await e.open(n,{type:"keyvalue",AccessController:sf({write:t})});n=o.address;const s=async()=>{const t=[];for await(const e of o.iterator())t[e.key]=e.value;return Object.entries({...t,admin:new Set([...t.admin||[],...o.access.write])}).forEach((e=>{const r=e[0];t[r]=new Set([...t[r]||[],...e[1]])})),t},a=async t=>(await s())[t]||new Set([]),c=async(t,e)=>{const r=new Set(await a(t));return r.has(e)||r.has("*")};return{type:af,address:n,write:t,canAppend:async t=>{const e=await r.getIdentity(t.identity);if(!e)return!1;const{id:n}=e;return!(!await c("write",n)&&!await c("admin",n))&&await r.verifyIdentity(e)},capabilities:s,get:a,grant:async(t,e)=>{const r=new Set([...await o.get(t)||[],e]);await o.put(t,Array.from(r.values()))},revoke:async(t,e)=>{const r=new Set(await o.get(t)||[]);r.delete(e),r.size>0?await o.put(t,Array.from(r.values())):await o.del(t)},close:async()=>{await o.close()},drop:async()=>{await o.drop()},events:o.events}};cf.type=af;const uf=cf,hf={},ff=t=>{if(!t.type)throw new Error("AccessController does not contain required field 'type'.");hf[t.type]=t};ff(sf),ff(uf);const lf=sf,df=async({ipfs:t,id:e,identity:r,identities:n,directory:i}={})=>{if(null==t)throw new Error("IPFS instance is a required argument.");e=e||await Xh();const o=t.libp2p.peerId;let s;i=i||"./orbitdb",n?s=n.keystore:(s=await Uh({path:V(i,"./keystore")}),n=await Hh({ipfs:t,keystore:s})),r?r.provider&&(r=await n.createIdentity({...r})):r=await n.createIdentity({id:e});const a=await(async({ipfs:t,storage:e}={})=>(e=e||await In(await Cn({size:1e5}),await kn({ipfs:t,pin:!0})),{get:async t=>{const r=await e.get(t),{value:n}=await Mt({bytes:r,codec:Wh,hasher:Jh});return n&&await e.put(t,r),n},create:async({name:t,type:r,accessController:n,meta:i})=>{if(!t)throw new Error("name is required");if(!r)throw new Error("type is required");if(!n)throw new Error("accessController is required");const o=Object.assign({name:t,type:r,accessController:n},void 0!==i?{meta:i}:{}),{cid:s,bytes:a}=await Vt({value:o,codec:Wh,hasher:Jh}),c=s.toString(Qh);return await e.put(c,a),{hash:c,manifest:o}},close:async()=>{await e.close()}}))({ipfs:t});let c={};const u=async(e,{type:o,meta:s,sync:f,Database:l,AccessController:d,headsStorage:y,entryStorage:p,indexStorage:w,referencesCount:g,encryption:b}={})=>{let m,v,E;if(c[e])return c[e];if(Gh(e)){const i=Yh(e);v=await a.get(i.hash),d=(t=>{if(!hf[t])throw new Error(`AccessController type '${t}' is not supported`);return hf[t]})(v.accessController.split("/",2).pop())(),E=await d({orbitdb:{open:u,identity:r,ipfs:t},identities:n,address:v.accessController}),m=v.name,o=o||v.type,s=v.meta}else{o=o||"events",d=d||lf(),E=await d({orbitdb:{open:u,identity:r,ipfs:t},identities:n,name:e});const i=await a.create({name:e,type:o,accessController:E.address,meta:s});if(v=i.manifest,e=Yh(i.hash),m=v.name,s=v.meta,c[e])return c[e]}if(l=l||(t=>{if(!t)throw new Error("Type not specified");if(!Hn[t])throw new Error(`Unsupported database type: '${t}'`);return Hn[t]})(o)(),!l)throw new Error(`Unsupported database type: '${o}'`);e=e.toString();const x=await l({ipfs:t,identity:r,address:e,name:m,access:E,directory:i,meta:s,syncAutomatically:f,headsStorage:y,entryStorage:p,indexStorage:w,referencesCount:g,encryption:b});return x.events.on("close",h(e)),c[e]=x,x},h=t=>()=>{delete c[t]};return{id:e,open:u,stop:async()=>{for(const t of Object.values(c))await t.close();s&&await s.close(),a&&await a.close(),c={}},ipfs:t,directory:i,keystore:s,identities:n,identity:r,peerId:o}}})(),OrbitDB=n})();
